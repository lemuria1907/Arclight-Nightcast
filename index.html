<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>弧光镇晚间新闻</title>
    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect x='5' y='20' width='90' height='70' rx='7' fill='%23ff9900' stroke='%23ffcc00' stroke-width='3'/%3E%3Ccircle cx='28' cy='55' r='12' fill='none' stroke='%23ffcc00' stroke-width='3'/%3E%3Ccircle cx='28' cy='55' r='6' fill='%23ffcc00'/%3E%3Cline x1='18' y1='55' x2='5' y2='55' stroke='%23ffcc00' stroke-width='5' stroke-linecap='round'/%3E%3Cline x1='5' y1='55' x2='0' y2='47' stroke='%23ffcc00' stroke-width='3' stroke-linecap='round'/%3E%3Cline x1='5' y1='55' x2='0' y2='63' stroke='%23ffcc00' stroke-width='3' stroke-linecap='round'/%3E%3Crect x='50' y='30' width='40' height='30' rx='4' fill='%23000000'/%3E%3Cline x1='55' y1='45' x2='85' y2='45' stroke='%23ff9900' stroke-width='2'/%3E%3Cline x1='55' y1='48' x2='80' y2='48' stroke='%23ff9900' stroke-width='2'/%3E%3Cline x1='55' y1='51' x2='85' y2='51' stroke='%23ff9900' stroke-width='2'/%3E%3C/svg%3E">
    <style>
        /* CSS变量定义：用于统一管理颜色，方便主题切换和维护 */
        :root {
            --bg-outer: #050505;
            /* 外部背景色（深黑） */
            --bg-screen: #000000;
            /* 游戏屏幕内部背景色（纯黑） */
            --term-main: #ff9900;
            /* 终端主色调（橘色/琥珀色），用于主要文本、边框 */
            --term-bright: #ffcc00;
            /* 终端亮色（亮黄色），用于高亮元素 */
            --term-dim: #553300;
            /* 终端暗部色（暗棕），用于次要边框、背景 */
            --term-dark: #0f0a00;
            /* 终端极暗背景（极深棕），用于右侧边栏等 */
            --term-alert: #ff2a00;
            /* 终端警告色（红色），用于错误、危险提示 */
            --term-cyan: #00ffff;
            /* 终端青色（青色），用于时钟、特殊高亮 */
            --term-blue: #00ccff;
            /* 档案/事件主色（蓝色），用于档案库相关元素 */
        }

        /* 全局重置样式，确保盒模型一致性 */
        * {
            box-sizing: border-box;
        }

        /* Body 样式：设置全局背景、字体、颜色，并使内容居中显示 */
        body {
            background-color: var(--bg-outer);
            /* 使用定义的外部背景色 */
            /* 背景网格线效果，模拟老式终端背景 */
            background-image:
                linear-gradient(#111 1px, transparent 1px),
                linear-gradient(90deg, #111 1px, transparent 1px);
            background-size: 20px 20px;
            /* 网格大小 */
            color: var(--term-main);
            /* 默认字体颜色 */
            font-family: 'Courier New', Courier, monospace;
            /* 模拟终端字体 */
            margin: 0;
            padding: 0;
            height: 100vh;
            /* 撑满视口高度 */
            width: 100vw;
            /* 撑满视口宽度 */
            overflow: hidden;
            /* 防止滚动条出现 */
            display: flex;
            /* Flex布局，使内容居中 */
            justify-content: center;
            align-items: center;
        }

        /* CRT 扫描线叠加层：模拟老式阴极射线管显示器的视觉效果 */
        .crt-overlay {
            position: fixed;
            /* 固定在视口 */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            /* 线性渐变创建水平扫描线效果 */
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%);
            background-size: 100% 4px;
            /* 控制扫描线密度 */
            pointer-events: none;
            /* 允许鼠标事件穿透，不影响下方交互 */
            z-index: 999;
            /* 确保在大多数内容之上 */
        }

        /* 自定义滚动条样式 (仅限 WebKit 浏览器) */
        ::-webkit-scrollbar {
            width: 6px;
            /* 滚动条宽度 */
        }

        ::-webkit-scrollbar-track {
            background: #000;
            /* 滚动条轨道背景 */
        }

        ::-webkit-scrollbar-thumb {
            background: var(--term-dim);
            /* 滚动条滑块颜色 */
            border-radius: 2px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--term-main);
            /* 鼠标悬停时滑块颜色 */
        }

        /* 游戏主容器：模拟老式显示器边框效果，并包含所有游戏内容 */
        #game-container {
            display: flex;
            /* Flex布局，内部元素水平排列 */
            width: 98vw;
            /* 占据视口宽度 */
            height: 95vh;
            /* 占据视口高度 */
            max-width: 1600px;
            /* 最大宽度限制 */
            max-height: 1000px;
            /* 最大高度限制 */
            border: 7px solid var(--term-main);
            /* 粗边框，主色调 */
            border-radius: 20px;
            /* 显著圆角 */
            /* 复杂的box-shadow模拟屏幕外框和发光效果 */
            box-shadow: 0 0 0 2px #321, 0 0 60px rgba(255, 153, 0, 0.5), inset 0 0 30px rgba(255, 153, 0, 0.2);
            background: radial-gradient(circle, #1a1a1a 0%, #000000 80%);
            /* 径向渐变背景，中心略亮，模拟显像管 */
            position: relative;
            overflow: hidden;
            /* 隐藏超出内容 */
            z-index: 1000;
            /* 确保在最顶层 */
            /* animation: crtWobble 0.15s infinite; */
            /* 快速微弱抖动 */
        }

        /* 屏幕反光与暗角效果 */
        #game-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            /* 玻璃反光 + 强烈暗角 */
            background: radial-gradient(ellipse 60% 100% at 50% 50%, rgba(255, 255, 255, 0.02) 0%, rgba(0, 0, 0, 0) 60%),
                radial-gradient(ellipse 60% 100% at 50% 50%, rgba(0, 0, 0, 0) 40%, rgba(0, 0, 0, 0.2) 100%);
            /* 调整为水平更宽的椭圆，缩小两侧暗角范围，并微调透明度 */
            border-radius: 16px;
            /* 匹配容器的圆角 */
            z-index: 1001;
            /* 确保在内容之上，但低于扫描线 */
            box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.3);
            /* 缩小暗角范围和强度 */
        }

        /* CRT 垂直抖动动画 */
        @keyframes crtWobble {
            0% {
                transform: translate(0.1px, 0.1px);
            }

            25% {
                transform: translate(-0.1px, -0.1px);
            }

            50% {
                transform: translate(-0.1px, 0.1px);
            }

            75% {
                transform: translate(0.1px, -0.1px);
            }

            100% {
                transform: translate(0.1px, 0.1px);
            }
        }

        #game-footer {
            position: relative;
            top: 21px;
            left: 50%;
            transform: translateX(-50%);
            line-height: 1;
            text-align: center;
        }

        /* --- 左侧栏 --- */
        #sidebar {
            width: 280px;
            /* 固定宽度 */
            background: #080500;
            /* 深色背景 */
            border-right: 4px solid var(--term-main);
            /* 右侧边框 */
            padding: 20px;
            display: flex;
            /* Flex布局，内部元素垂直排列 */
            flex-direction: column;
            flex-shrink: 0;
            /* 不允许缩小 */
            overflow-y: auto;
            /* 垂直滚动 */
            position: relative;
            z-index: 10;
        }

        /* 时钟显示区域容器 */
        #clock-wrapper {
            margin-bottom: 20px;
            text-align: center;
        }

        /* 日期显示样式 */
        #day-display {
            font-size: 1.5em;
            font-weight: bold;
            color: var(--term-cyan);
            /* 青色 */
            margin-bottom: 8px;
            text-shadow: 0 0 10px var(--term-cyan);
            /* 青色发光 */
            letter-spacing: 2px;
        }

        /* 时钟数字显示样式：大字、粗体、发光效果 */
        #clock-display {
            font-size: 3.5rem;
            font-weight: 900;
            color: var(--term-bright);
            /* 亮黄色 */
            text-align: center;
            border: 3px solid var(--term-main);
            /* 主色边框 */
            background: linear-gradient(135deg, #221100 0%, #000000 100%);
            /* 渐变背景 */
            box-shadow: 0 0 20px rgba(255, 153, 0, 0.4), inset 0 0 10px rgba(0, 0, 0, 0.8);
            /* 外部和内部阴影 */
            padding: 10px 0;
            margin: 0;
            text-shadow: 0 0 15px var(--term-main);
            /* 文本发光 */
            border-radius: 4px;
        }

        /* 菜单按钮通用样式 */
        .btn-menu {
            background: #000;
            color: var(--term-main);
            border: 2px solid var(--term-dim);
            /* 暗部边框 */
            padding: 12px 15px;
            cursor: pointer;
            font-family: inherit;
            width: 100%;
            font-weight: 800;
            font-size: 1.1em;
            text-transform: uppercase;
            transition: all 0.2s;
            /* 平滑过渡动画 */
            position: relative;
            overflow: hidden;
            margin-bottom: 5px;
            flex-shrink: 0;
            display: block;
        }

        /* 发光按钮效果 (hover) */
        .btn-glow:hover {
            border-color: var(--term-bright);
            color: #fff;
            background: linear-gradient(90deg, transparent, rgba(255, 153, 0, 0.4), transparent);
            box-shadow: 0 0 20px var(--term-main);
            text-shadow: 0 0 8px #fff;
        }

        /* 红色警告按钮 */
        .btn-red {
            color: var(--term-alert);
            border-color: #511;
            margin-bottom: 5px;
        }

        .btn-red:hover {
            border-color: var(--term-alert);
            background: var(--term-alert);
            color: #fff;
        }

        /* 灰色次要按钮 */
        .btn-gray {
            color: #888;
            border-color: #444;
            font-size: 0.9em;
            padding: 10px;
        }

        .btn-gray:hover {
            background: #333;
            color: #fff;
            border-color: #666;
        }

        /* 夜间播报按钮（特殊高亮） */
        .btn-night {
            margin-top: auto;
            /* 自动推到底部 */
            border: 2px solid var(--term-bright);
            color: #000;
            background: var(--term-main);
            padding: 15px 10px;
            font-size: 1.1em;
        }

        .btn-night:hover {
            background: #fff;
            color: #000;
            box-shadow: 0 0 40px var(--term-bright);
        }

        /* 提示文本样式 */
        .hint-text {
            font-size: 0.8em;
            color: #666;
            margin-bottom: 15px;
            display: block;
            text-align: right;
            font-style: italic;
        }

        /* 禁用按钮样式 */
        .btn-disabled {
            opacity: 0.5;
            cursor: not-allowed;
            border-color: #333;
            color: #555;
            pointer-events: none;
            /* 禁用所有事件 */
        }

        /* 作弊区域：隐藏在左下角，低透明度，hover时显示 */
        .cheat-area {
            position: fixed;
            bottom: 10px;
            left: 10px;
            z-index: 8000;
            display: flex;
            gap: 5px;
            opacity: 0.3;
            transition: opacity 0.3s;
        }

        .cheat-area:hover {
            opacity: 1;
        }

        /* 作弊小按钮样式 */
        .btn-cheat-sm {
            width: 30px;
            height: 30px;
            border: 1px solid #444;
            background: #000;
            color: #666;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0;
        }

        .btn-cheat-sm:hover {
            color: #fff;
            border-color: #fff;
        }

        /* --- 中间地图 --- */
        #center-view {
            flex: 1;
            display: flex;
            flex-direction: column;
            border-right: 4px solid var(--term-main);
            overflow: hidden;
            position: relative;
            z-index: 20;
        }

        #map-section {
            flex: 3;
            background: #0a0600;
            position: relative;
            overflow: hidden;
            border-bottom: 4px solid var(--term-dim);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #map-lines {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 25;
            /* Higher than map-node (z-index: 10, 20 on hover) */
            pointer-events: none;
        }

        #radar-scan {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 200vmax;
            height: 200vmax;
            /* 扫描线渐变：大部分透明，尾部淡绿 */
            background: conic-gradient(from 0deg, transparent 0%, transparent 80%, rgba(50, 255, 100, 0.15) 100%);
            border-radius: 50%;
            animation: radarSpin 8s linear infinite;
            pointer-events: none;
            z-index: 5;
            mix-blend-mode: screen;
        }

        @keyframes radarSpin {
            0% {
                transform: translate(-50%, -50%) rotate(0deg);
            }

            100% {
                transform: translate(-50%, -50%) rotate(360deg);
            }
        }

        #ascii-map {
            white-space: pre;
            color: var(--term-dim);
            font-size: 14px;
            line-height: 1.4;
            transform: scale(1.25);
            opacity: 0.4;
            pointer-events: none;
            font-weight: bold;
        }

        .map-node {
            position: absolute;
            background: #000;
            border: 2px solid var(--term-main);
            color: var(--term-bright);
            padding: 8px 12px;
            cursor: pointer;
            font-weight: 900;
            font-size: 15px;
            box-shadow: 0 0 10px #000;
            transform: translate(-50%, -50%);
            z-index: 10;
            transition: 0.2s;
            text-align: center;
        }

        .map-node:hover {
            background: var(--term-main);
            color: #000;
            z-index: 20;
            transform: translate(-50%, -50%) scale(1.15);
            box-shadow: 0 0 25px var(--term-bright);
        }

        #switch-group {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 30;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 10px;
            justify-content: flex-start;
        }

        /* 快脚模式开关 */
        #fast-walk-switch {
            display: flex;
            align-items: center;
            gap: 10px;
            font-family: inherit;
        }

        #fast-walk-switch-label {
            color: var(--term-main);
            font-weight: 800;
            font-size: 0.9em;
            text-transform: uppercase;
            text-shadow: 0 0 5px var(--term-main);
        }

        /* 音乐模式开关 */
        #music-switch {
            display: flex;
            align-items: center;
            gap: 10px;
            font-family: inherit;
        }

        #music-switch-label {
            color: var(--term-main);
            font-weight: 800;
            font-size: 0.9em;
            text-transform: uppercase;
            text-shadow: 0 0 5px var(--term-main);
        }

        .switch-container {
            position: relative;
            width: 50px;
            height: 24px;
            background: #000;
            border: 2px solid var(--term-dim);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 0 10px #000;
        }

        .switch-container:hover {
            border-color: var(--term-main);
            box-shadow: 0 0 15px var(--term-main);
        }

        .switch-container.active {
            background: rgba(255, 153, 0, 0.3);
            border-color: var(--term-bright);
            box-shadow: 0 0 20px var(--term-main);
        }

        .switch-slider {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 18px;
            height: 18px;
            background: var(--term-dim);
            border-radius: 50%;
            transition: all 0.3s;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
        }

        .switch-container.active .switch-slider {
            left: 26px;
            background: var(--term-bright);
            box-shadow: 0 0 15px var(--term-bright);
        }

        .map-node.current-location {
            border-color: var(--term-bright) !important;
            background: #000 !important;
            color: #fff !important;
            /* Force white text for readability */
            box-shadow: 0 0 15px var(--term-main), inset 0 0 10px rgba(255, 204, 0, 0.3);
            transform: translate(-50%, -50%) scale(1.15);
            z-index: 20;
        }

        .map-node.current-location::after {
            content: "\f3c5";
            /* Font Awesome map-marker-alt icon */
            font-family: 'Font Awesome 5 Free';
            font-weight: 900;
            position: absolute;
            top: -15px;
            /* Adjust top position for map marker icon */
            right: -10px;
            font-size: 1.2em;
            color: var(--term-alert);
            text-shadow: 0 0 5px var(--term-alert);
            animation: pinDrop 0.3s ease-out forwards, pulsePin 1.5s infinite alternate;
        }

        @keyframes pinDrop {
            0% {
                transform: translate(0, -30px) scale(0.5);
                opacity: 0;
            }

            70% {
                transform: translate(0, 5px) scale(1.2);
                opacity: 1;
            }

            100% {
                transform: translate(0, 0) scale(1);
                opacity: 1;
            }
        }

        @keyframes pulsePin {
            0% {
                transform: scale(1);
                opacity: 1;
            }

            50% {
                transform: scale(1.1);
                opacity: 0.8;
            }

            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .map-node.locked-node {
            border-color: #333 !important;
            color: #444 !important;
            background: #050505 !important;
            cursor: not-allowed !important;
            pointer-events: none;
            box-shadow: none !important;
            transform: translate(-50%, -50%) scale(1) !important;
            z-index: 5 !important;
        }

        .map-node.locked-node::after {
            content: " [X]";
            font-size: 0.8em;
            color: #333;
        }

        .top-bar-btns {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 100;
            display: flex;
            gap: 20px;
        }

        .btn-system {
            background: #000;
            border: 3px solid;
            padding: 12px 20px;
            font-weight: 900;
            font-size: 1.2rem;
            cursor: pointer;
            font-family: inherit;
            position: relative;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: transform 0.2s;
        }

        .btn-archive {
            border-color: var(--term-blue);
            color: var(--term-blue);
        }

        .btn-event {
            border-color: var(--term-main);
            color: var(--term-main);
        }

        .btn-system:hover {
            transform: scale(1.1);
            filter: brightness(1.2);
        }

        .notification-dot {
            position: absolute;
            top: -8px;
            right: -8px;
            width: 14px;
            height: 14px;
            background: #ff0000;
            border-radius: 50%;
            box-shadow: 0 0 10px #ff0000;
            animation: blinkRed 1s infinite;
            display: none;
            border: 2px solid #fff;
        }

        @keyframes blinkRed {
            50% {
                opacity: 0.4;
            }
        }

        #notepad-container {
            flex: 1.5;
            display: flex;
            flex-direction: column;
            background: #050300;
        }

        #notepad-area {
            flex: 1;
            width: 100%;
            background: transparent;
            border: none;
            color: #bfa588;
            font-family: inherit;
            font-size: 1.2em;
            padding: 20px;
            resize: none;
            outline: none;
            overflow-y: auto;
            line-height: 1.5;
        }

        /* --- 右侧栏 --- */
        #right-sidebar {
            width: 380px;
            background: var(--term-dark);
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
            border-left: 4px solid #000;
            justify-content: space-between;
            position: relative;
            z-index: 10;
        }

        .panel-header {
            background: #110800;
            color: var(--term-bright);
            padding: 15px 20px;
            font-size: 1.3em;
            text-transform: uppercase;
            border-bottom: 2px solid var(--term-dim);
            font-weight: 900;
        }

        #status-message-area {
            padding: 15px 20px;
            min-height: 100px;
            border-top: 2px solid var(--term-main);
            background: #080500;
            color: var(--term-bright);
            font-size: 1.1em;
            line-height: 1.4;
            font-weight: bold;
            order: 99;
        }

        .cursor-blink {
            display: inline-block;
            width: 8px;
            height: 1em;
            background: var(--term-main);
            animation: blink 0.8s infinite;
            vertical-align: text-bottom;
        }

        @keyframes blink {
            50% {
                opacity: 0;
            }
        }

        .clock-glow {
            text-shadow: 0 0 20px var(--term-bright), 0 0 30px var(--term-main);
            animation: pulseGlow 0.8s infinite alternate;
            box-shadow: 0 0 20px rgba(255, 153, 0, 0.6), inset 0 0 10px rgba(255, 153, 0, 0.4);
        }

        @keyframes pulseGlow {
            0% {
                text-shadow: 0 0 10px var(--term-main), 0 0 20px rgba(255, 204, 0, 0.5);
                box-shadow: 0 0 10px rgba(255, 153, 0, 0.3), inset 0 0 5px rgba(255, 153, 0, 0.1);
            }

            50% {
                text-shadow: 0 0 30px var(--term-bright), 0 0 50px rgba(255, 204, 0, 1);
                box-shadow: 0 0 40px rgba(255, 153, 0, 1), inset 0 0 20px rgba(255, 153, 0, 0.8);
            }

            100% {
                text-shadow: 0 0 10px var(--term-main), 0 0 20px rgba(255, 204, 0, 0.5);
                box-shadow: 0 0 10px rgba(255, 153, 0, 0.3), inset 0 0 5px rgba(255, 153, 0, 0.1);
            }
        }

        .sidebar-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            min-height: 0;
        }

        #collected-news-container {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            justify-content: flex-start;
            overflow-x: hidden;
        }

        .collected-news-card {
            background: #111;
            border: 1px solid #444;
            padding: 15px;
            cursor: pointer;
            transition: 0.3s;
            position: relative;
            overflow: hidden;
            min-height: 80px;
        }

        .collected-news-card:hover {
            border-color: var(--term-main);
            box-shadow: 0 0 15px rgba(255, 153, 0, 0.3);
            background: #1a1510;
        }

        .news-card-title {
            font-weight: 900;
            font-size: 1.1em;
            color: #ddd;
            margin-bottom: 5px;
        }

        .news-card-tag {
            font-size: 0.8em;
            padding: 2px 6px;
            background: #333;
            color: #aaa;
            border-radius: 2px;
        }

        #collected-events-container {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            justify-content: flex-start;
            overflow-x: hidden;
            padding-bottom: 80px;
        }

        .collected-event-card {
            background: #111;
            border: 1px solid #444;
            padding: 15px;
            cursor: pointer;
            transition: 0.3s;
            position: relative;
            overflow: hidden;
            min-height: 60px;
        }

        .collected-event-card:hover {
            border-color: var(--term-main);
            box-shadow: 0 0 15px rgba(255, 153, 0, 0.3);
            background: #1a1510;
        }

        .event-card-title {
            font-weight: 900;
            font-size: 1.1em;
            color: #ddd;
            margin-bottom: 5px;
        }

        .event-card-tag {
            font-size: 0.8em;
            padding: 2px 6px;
            background: #333;
            color: #aaa;
            border-radius: 2px;
        }

        .tag-big {
            background: #b00;
            color: #fff;
        }

        .highlight {
            color: var(--term-blue);
            font-weight: bold;
            cursor: pointer;
            padding: 0 2px;
        }

        .highlight:hover {
            background: var(--term-blue);
            color: #000;
        }

        .hl-time {
            color: var(--term-bright);
            font-weight: 900;
            border-bottom: 1px dashed var(--term-main);
        }

        /* --- 模态框通用 --- */
        .modal {
            display: none;
            /* 默认隐藏 */
            position: fixed;
            /* 固定定位 */
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            /* 居中显示 */
            width: auto;
            background: #080500;
            border: 2px solid var(--term-main);
            z-index: 6000;
            box-shadow: 0 0 100px rgba(0, 0, 0, 1);
            /* 大范围阴影 */
            flex-direction: column;
        }

        /* 模态框抖动动画 */
        .shake-anim {
            animation: shake 0.5s cubic-bezier(.36, .07, .19, .97) both;
        }

        /* 模态框抖动动画关键帧 */
        @keyframes shake {

            10%,
            90% {
                transform: translate(-51%, -50%);
            }

            20%,
            80% {
                transform: translate(-49%, -50%);
            }

            30%,
            50%,
            70% {
                transform: translate(-51%, -50%);
            }

            40%,
            60% {
                transform: translate(-49%, -50%);
            }
        }

        /* 按钮水平抖动动画 */
        .shake-btn {
            animation: shakeHorizontal 0.5s cubic-bezier(.36, .07, .19, .97) both;
        }

        /* 按钮水平抖动动画关键帧 */
        @keyframes shakeHorizontal {

            10%,
            90% {
                transform: translateX(-4px);
            }

            20%,
            80% {
                transform: translateX(4px);
            }

            30%,
            50%,
            70% {
                transform: translateX(-4px);
            }

            40%,
            60% {
                transform: translateX(4px);
            }
        }

        /* 模态框头部通用样式 */
        .modal-header {
            background: var(--term-main);
            color: #000;
            padding: 10px 18px;
            font-weight: 900;
            font-size: 1.4em;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }

        /* 模态框关闭按钮 */
        .btn-close {
            background: #000;
            border: 1px solid #000;
            color: #fff;
            font-weight: bold;
            cursor: pointer;
            font-size: 1.2em;
            padding: 5px 10px;
        }

        .btn-close:hover {
            color: #fff;
        }

        /* 档案库模态框特定样式 */
        #archive-modal {
            width: 70vw;
            max-width: 900px;
            height: 80vh;
            border-color: var(--term-blue);
            /* 蓝色边框 */
        }

        /* 档案库标签页容器 */
        .archive-tabs {
            display: flex;
            border-bottom: 2px solid var(--term-blue);
            background: #000;
        }

        /* 档案库标签页按钮 */
        .archive-tab {
            flex: 1;
            text-align: center;
            padding: 15px;
            cursor: pointer;
            color: var(--term-blue);
            opacity: 0.6;
            font-weight: bold;
            font-size: 1.2em;
        }

        /* 档案库激活标签页 */
        .archive-tab.active {
            background: var(--term-blue);
            color: #000;
            opacity: 1;
        }

        /* 档案内容区域 */
        .archive-content {
            padding: 20px;
            overflow-y: auto;
            flex: 1;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            /* 响应式网格布局 */
            grid-auto-rows: min-content;
            gap: 15px;
        }

        /* 文本内容通用样式 (用于模态框内的长文本) */
        .text-content {
            padding: 30px;
            overflow-y: auto;
            max-height: 70vh;
            display: block;
            font-size: 1.2em;
            line-height: 1.6;
            color: #ddd;
        }

        /* 档案条目卡片样式 */
        .archive-item {
            border-bottom: 2px solid #333;
            padding-bottom: 15px;
            margin-bottom: 10px;
            padding: 15px;
            background: rgba(0, 50, 60, 0.1);
            /* 半透明背景 */
            display: flex;
            flex-direction: column;
        }

        .archive-item h4 {
            margin: 0 0 10px 0;
            color: var(--term-blue);
            border-bottom: 1px dashed #356;
            font-size: 1.2em;
            padding-bottom: 5px;
        }

        .archive-item p {
            font-size: 1em;
            color: #aaa;
            margin: 0;
            line-height: 1.5;
            flex: 1;
        }

        /* --- 事件复盘模块 --- */

        #event-sys-modal {

            width: 85vw;

            height: 85vh;

            max-width: 1300px;

            border-color: var(--term-main);

        }



        /* 事件复盘内部布局 */

        .event-sys-layout {

            display: flex;

            height: 100%;

            overflow: hidden;

        }



        /* 事件复盘左侧列 (列表) */

        .es-col-left {

            flex: 1;

            border-right: 2px solid var(--term-dim);

            background: #050300;

            display: flex;

            flex-direction: column;

            min-width: 280px;

            height: 100%;

        }



        /* 事件复盘列表头部 */

        .es-list-header {

            padding: 12px;

            background: #111;

            color: #888;

            font-size: 0.9em;

            text-align: center;

            font-weight: bold;

            flex-shrink: 0;

        }



        /* 事件复盘列表主体 */

        .es-list-body {

            flex: 1;

            overflow-y: auto;

            padding: 15px;

            min-height: 0;

        }



        /* 事件复盘按天分组 */

        .es-day-group {

            margin-bottom: 20px;

        }



        /* 事件复盘日期标题 */

        .es-day-title {

            color: var(--term-blue);

            font-weight: bold;

            border-bottom: 1px solid #333;

            padding-bottom: 5px;

            margin-bottom: 10px;

            font-size: 0.85em;

            text-transform: uppercase;

            letter-spacing: 2px;

        }



        /* 事件复盘卡片通用样式 */

        .es-card {

            padding: 10px 12px;

            border: 1px solid #333;

            margin-bottom: 8px;

            cursor: pointer;

            background: #0a0a0a;

            transition: 0.2s;

            position: relative;

        }



        .es-card:hover {

            border-color: var(--term-main);

            transform: translateX(5px);

        }



        /* 选中状态的事件复盘卡片 */
        .es-card.selected {
            background: var(--term-main);
            color: #000;
            border-color: var(--term-bright);
            box-shadow: 0 0 15px var(--term-main);
            /* 增加发光强调 */
            transform: scale(1.02) translateX(5px);
            z-index: 5;
        }

        /* 事件复盘卡片标题 */
        .es-card-title {
            font-weight: bold;
            font-size: 0.95em;
            line-height: 1.3;
        }

        /* 锁定状态的事件复盘卡片 */
        .es-card.locked {
            opacity: 0.5;
            pointer-events: none;
            border-style: dashed;
        }

        /* 已完成状态的事件复盘卡片 */
        .es-card.completed {
            border-color: var(--term-blue);
            color: var(--term-blue);
        }

        .es-card.completed::after {
            content: " [完成]";
            font-size: 0.8em;
            position: absolute;
            right: 12px;
            /* 保持与右边缘的内边距 */
            top: 50%;
            transform: translateY(-50%);
        }

        @keyframes blinkMarker {

            0%,
            100% {
                opacity: 1;
                transform: translateY(-50%) scale(1);
            }

            50% {
                opacity: 0.8;
                transform: translateY(-50%) scale(0.95);
            }
        }



        /* 右侧面板 (事件复盘的问答区) */

        .es-col-right {

            flex: 2;

            display: flex;

            flex-direction: column;

            background: #000;

            overflow: hidden;

            height: 100%;

            position: relative;

        }



        /* 问答容器 */

        .quiz-container {

            padding: 25px;

            height: 100%;

            display: flex;

            flex-direction: column;

            overflow: hidden;

        }



        /* 问答头部 */

        .quiz-header {

            font-size: 1.3em;

            color: var(--term-main);

            margin-bottom: 10px;

            border-bottom: 1px dashed #333;

            padding-bottom: 10px;

            font-weight: 900;

            flex-shrink: 0;

        }



        /* 问答介绍文本 */

        .quiz-intro {

            color: #888;

            margin-bottom: 15px;

            font-size: 0.95em;

            line-height: 1.4;

            flex-shrink: 0;

        }



        /* 问答列表 */

        .quiz-list {

            flex: 1;

            overflow-y: auto;

            padding-right: 10px;

            min-height: 0;

            margin-bottom: 10px;

            border-bottom: 1px solid #222;

        }



        /* 问答条目 */

        .quiz-item {

            display: flex;

            align-items: center;

            margin-bottom: 15px;

            background: #0a0a0a;

            padding: 12px;

            border: 1px solid #333;

        }



        /* 问答文本 */

        .quiz-text {

            flex: 1;

            color: #ccc;

            font-size: 1.05em;

            margin-left: 15px;

            line-height: 1.4;

        }



        /* 问答底部区域 */

        .quiz-footer {

            flex-shrink: 0;

            padding-top: 10px;

            display: flex;

            flex-direction: column;

            gap: 10px;

        }



        /* 问答切换按钮 */

        .btn-quiz-toggle {

            width: 38px;

            height: 38px;

            flex-shrink: 0;

            background: #000;

            border: 2px solid var(--term-dim);

            color: var(--term-bright);

            font-weight: 900;

            font-size: 1.2em;

            cursor: pointer;

            display: flex;

            justify-content: center;

            align-items: center;

            transition: 0.2s;

        }



        .btn-quiz-toggle:hover {

            border-color: var(--term-main);

            box-shadow: 0 0 10px rgba(255, 153, 0, 0.2);

        }



        /* 问答切换按钮选中状态 */

        .btn-quiz-toggle.checked {

            border-color: var(--term-main);

            color: var(--term-main);

            background: #1a1000;

        }



        /* 问答切换按钮错误状态 */

        .btn-quiz-toggle.wrong {

            border-color: var(--term-alert);

            color: var(--term-alert);

            background: #1a0000;

        }



        /* 验证推论按钮 */

        .btn-verify {

            padding: 12px;

            font-size: 1.2em;

            font-weight: 900;

            background: var(--term-dim);

            color: #000;

            border: none;

            cursor: pointer;

            text-transform: uppercase;

            letter-spacing: 4px;

            border: 2px solid var(--term-main);

            width: 100%;

        }



        .btn-verify:hover {

            background: var(--term-main);

            box-shadow: 0 0 20px var(--term-main);

            color: #000;

        }



        /* 验证按钮禁用状态 */

        .btn-verify:disabled {

            background: #222;

            border-color: #444;

            color: #666;

            cursor: not-allowed;

            box-shadow: none;

        }



        /* 验证消息显示区域 */

        #verify-msg {

            height: 24px;

            line-height: 24px;

            text-align: center;

            font-weight: bold;

        }



        /* 新闻详情模态框内容 */

        #news-detail-content {

            padding: 30px;

            font-size: 1.2em;

            line-height: 1.8;

            color: #ddd;

            overflow-y: auto;

            max-height: 70vh;

        }



        /* 事件详情模态框内容 */

        #event-detail-content {

            padding: 30px;

            font-size: 1.2em;

            line-height: 1.8;

            color: #ddd;

            overflow-y: auto;

            max-height: 70vh;

        }



        /* 黄色高亮文本 */

        .hl-yellow {

            color: #ffff00;

            font-weight: bold;

        }

        /* --- 播报 & 转场 --- */
        #broadcast-screen {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #050200;
            z-index: 5000;
            padding: 30px;
        }

        #transition-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 7000;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        #transition-text {
            font-size: 2em;
            color: var(--term-main);
            border-right: 10px solid var(--term-main);
        }

        .broadcast-layout {
            display: flex;
            flex-direction: column;
            gap: 20px;
            height: 100%;
            max-width: 1200px;
            margin: 0 auto;
        }

        .broadcast-pool {
            border: 2px solid var(--term-main);
            box-shadow: 0 0 15px rgba(255, 153, 0, 0.2), inset 0 0 10px rgba(255, 153, 0, 0.1);
            background: rgba(20, 10, 0, 0.5);
            padding: 15px;
            height: 90px;
            overflow-y: auto;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .broadcast-slot-row {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 10px 0;
        }

        .b-slot {
            width: 23%;
            height: 55px;
            border: 2px dashed #444;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: #666;
            font-weight: bold;
            background: #111;
            font-size: 0.9em;
        }

        .b-slot.filled {
            border-style: solid;
            color: #000;
            font-weight: 900;
            background: var(--term-main);
            border-color: var(--term-bright);
        }

        .b-chip {
            padding: 6px 12px;
            background: #222;
            border: 1px solid #444;
            cursor: pointer;
            color: #eee;
            font-size: 1em;
            transition: 0.2s;
            white-space: nowrap;
        }

        .b-chip:hover {
            border-color: var(--term-main);
            color: var(--term-main);
            background: #111;
            box-shadow: 0 0 10px var(--term-main);
        }

        .b-chip.real {
            border-left: 3px solid var(--term-main);
        }

        .btn-start-b {
            width: 250px;
            display: inline-block;
            background: #aa0000;
            color: #fff;
            border-color: #ff0000;
            animation: pulseStart 1s infinite;
        }

        @keyframes pulseStart {
            0% {
                opacity: 1;
            }

            50% {
                opacity: 0.7;
            }

            100% {
                opacity: 1;
            }
        }

        .teleprompter {
            flex: 1;
            background: #000;
            border: 4px solid var(--term-main);
            padding: 20px;
            color: var(--term-main);
            font-size: 1.2rem;
            overflow-y: auto;
            text-shadow: 0 0 5px var(--term-dim);
            white-space: pre-wrap;
            line-height: 1.6;
            cursor: pointer;
        }

        #intro-modal {
            display: none;
            flex-direction: column;
        }

        #tutorial-modal {
            display: none;
            flex-direction: column;
        }

        .disabled-broadcast-ui {
            pointer-events: none;
            opacity: 0.5;
            cursor: default !important;
        }

        /* --- Rating Report (Optimized) --- */
        #rating-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            z-index: 6000;
            justify-content: center;
            align-items: center;
            font-family: 'Courier New', monospace;
            backdrop-filter: blur(4px);
        }

        .rating-scene {
            position: relative;
            width: 100%;
            height: 600px;
            display: flex;
            justify-content: center;
            align-items: center;
            /* border: 1px dashed #333; Debugging area */
        }

        .report-paper {
            background: #eebb99;
            /* Old paper color */
            width: 420px;
            padding: 40px 30px 60px 30px;
            box-shadow: 10px 10px 50px rgba(0, 0, 0, 0.8);
            color: #331100;
            /* Dark ink */
            position: relative;
            transform: rotate(-2deg);
            z-index: 10;
            border: 1px solid #c98;
        }

        .report-header {
            text-align: center;
            font-weight: 900;
            font-size: 1.6em;
            border-bottom: 4px double #331100;
            padding-bottom: 12px;
            margin-bottom: 25px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .report-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-size: 1.1em;
            font-weight: bold;
            border-bottom: 1px dashed rgba(51, 17, 0, 0.2);
            padding-bottom: 4px;
        }

        .score-big {
            font-size: 5em;
            font-weight: 900;
            text-align: center;
            margin: 25px 0;
            font-family: 'Courier New', monospace;
            color: #220b00;
            text-shadow: 2px 2px 0px rgba(0, 0, 0, 0.1);
        }

        .stamp {
            position: absolute;
            bottom: 40px;
            right: 40px;
            font-size: 3.5em;
            font-weight: 900;
            border: 6px solid;
            padding: 5px 15px;
            transform: rotate(-15deg) scale(2);
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            text-transform: uppercase;
            pointer-events: none;
            mix-blend-mode: multiply;
        }

        .stamp.show {
            transform: rotate(-15deg) scale(1);
            opacity: 0.9;
        }

        .stamp-safe {
            color: #2e4a2e;
            border-color: #2e4a2e;
        }

        .stamp-danger {
            color: #c00;
            border-color: #c00;
        }

        #tally-light {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 20px;
            height: 20px;
            background-color: var(--term-alert);
            border-radius: 50%;
            box-shadow: 0 0 15px var(--term-alert);
            animation: tallyBlink 1s infinite alternate, tallyGlow 1.5s infinite ease-in-out;
            z-index: 5001;
            /* Above broadcast screen */
            display: none;
            /* Hidden by default, shown when broadcasting */
        }

        @keyframes tallyBlink {
            0% {
                opacity: 0.8;
            }

            100% {
                opacity: 0.4;
            }
        }

        @keyframes tallyGlow {
            0% {
                box-shadow: 0 0 5px var(--term-alert), 0 0 10px rgba(255, 42, 0, 0.5);
            }

            50% {
                box-shadow: 0 0 15px var(--term-alert), 0 0 25px rgba(255, 42, 0, 0.8);
            }

            100% {
                box-shadow: 0 0 5px var(--term-alert), 0 0 10px rgba(255, 42, 0, 0.5);
            }
        }

        #audio-visualizer {
            width: 100%;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: flex-end;
            gap: 2px;
            background: #000;
            border-top: 1px solid var(--term-dim);
            padding: 5px 0;
            overflow: hidden;
            display: none;
            /* Hidden by default, shown when broadcasting */
        }

        .bar {
            width: 3px;
            background-color: var(--term-main);
            height: 5px;
            /* Base height */
            transition: height 0.1s ease-out;
            box-shadow: 0 0 5px var(--term-main);
        }

        /* Danger Phone Alert */
        .phone-alert {
            display: none;
            position: absolute;
            top: 10%;
            right: 25%;
            /* Relative to rating-scene */
            flex-direction: column;
            align-items: center;
            z-index: 30;
            pointer-events: none;
        }

        .phone-icon {
            font-size: 8rem;
            color: var(--term-alert);
            animation: violentShake 0.1s infinite;
            text-shadow: 5px 5px 0px #300;
            line-height: 1;
        }

        .phone-msg {
            font-size: 1.5rem;
            font-weight: 900;
            background: var(--term-alert);
            color: #fff;
            padding: 5px 15px;
            transform: rotate(-5deg);
            animation: pulseText 0.2s infinite alternate;
            border: 2px solid #fff;
            margin-top: -20px;
            white-space: nowrap;
            box-shadow: 5px 5px 0 #000;
        }

        @keyframes violentShake {
            0% {
                transform: translate(0, 0) rotate(0deg);
            }

            25% {
                transform: translate(-10px, 10px) rotate(-15deg);
            }

            50% {
                transform: translate(10px, -10px) rotate(15deg);
            }

            75% {
                transform: translate(-10px, -10px) rotate(-5deg);
            }

            100% {
                transform: translate(5px, 5px) rotate(5deg);
            }
        }

        @keyframes pulseText {
            from {
                transform: scale(1) rotate(-5deg);
            }

            to {
                transform: scale(1.1) rotate(-3deg);
            }
        }

        #auto-event-overlay {
            display: block;
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            z-index: -100;
            pointer-events: auto;
            overflow-y: auto;
            opacity: 0;
            transition: opacity 0.6s ease-out;
        }

        #auto-event-drawer {
            position: absolute;
            left: 0;
            bottom: 0;
            width: 100%;
            max-height: 100%;
            padding: 20px;
            background: #000;
            box-sizing: border-box;
            transform: translateY(200%);
            transition: transform 0.8s ease-out;
            pointer-events: auto;
            display: flex;
            flex-direction: column;
        }

        #auto-event-drawer-close {
            border: 2px solid var(--term-bright);
            margin-left: 10px;
        }

        #auto-event-drawer-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        #auto-event-drawer-content {
            border-left: 3px solid var(--term-bright);
            padding-left: 15px;
            overflow-y: auto;
            flex: 1;
            min-height: 0;
        }

        #auto-event-content {
            color: #fff;
            line-height: 1.8;
        }

        #auto-event-progress {
            flex: 1;
            height: 4px;
            background: #333;
            border-radius: 2px;
            overflow: hidden;
        }

        #auto-event-progress-bar {
            height: 100%;
            background: var(--term-bright);
            width: 0%;
            transition: width 0.8s ease;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>

<body>
    <audio id="background-music" src="comment_background.mp3" loop preload="auto"></audio>

    <div class="crt-overlay"></div>
    <div id="transition-overlay">
        <div id="transition-text"></div>
    </div>

    <div class="cheat-area">
        <button class="btn-cheat-sm" onclick="clearSave()" title="清除存档">x</button>
    </div>

    <div id="game-container-wrapper">
        <div id="game-container">
            <div id="sidebar">
                <div id="clock-wrapper">
                    <div id="day-display">第1天</div>
                    <div id="clock-display">08:00</div>
                </div>

                <div id="action-buttons">
                    <button class="btn-menu btn-glow" onclick="openModal('info-modal')">≡ 今日晨报</button>
                    <button class="btn-menu btn-glow" onclick="openHotlineModal()">☎ 居民热线</button>
                    <div style="margin-bottom:15px;">
                        <button id="btn-mimi" class="btn-menu btn-glow" onclick="callMimi()">? 呼叫米米 (-2H)</button>
                        <span class="hint-text">*派米米调查错过的新闻</span>
                    </div>

                    <button class="btn-menu btn-night" onclick="triggerNight()">
                        ⚡ 进入夜间播报
                        <small style="display:block; font-size:0.6em; margin-top:5px; color:#444;">*需已收集到足够的新闻</small>
                    </button>
                    <div style="margin-top:20px;">
                        <button class="btn-menu btn-red" onclick="restartDay()"><i class="fas fa-sync-alt"></i>
                            重置本日</button>
                        <button class="btn-menu btn-gray" onclick="prevDay()"><i class="fas fa-arrow-left"></i>
                            回到前一天</button>
                    </div>
                </div>
            </div>

            <div id="center-view">
                <div class="top-bar-btns">
                    <button class="btn-system btn-archive" onclick="openArchiveModal()">
                        档案库 <span class="notification-dot" id="dot-archive"></span>
                    </button>
                    <button class="btn-system btn-event" onclick="openEventSystem()">
                        事件复盘 <span class="notification-dot" id="dot-event"></span>
                    </button>
                </div>

                <div id="map-section">
                    <div id="switch-group">
                        <div id="fast-walk-switch">
                            <span id="fast-walk-switch-label">快脚</span>
                            <div class="switch-container" id="fast-walk-toggle" onclick="toggleFastWalk()">
                                <div class="switch-slider"></div>
                            </div>
                        </div>
                        <div id="music-switch">
                            <span id="music-switch-label">音乐</span>
                            <div class="switch-container" id="music-toggle" onclick="toggleMusic()">
                                <div class="switch-slider"></div>
                            </div>
                        </div>
                    </div>
                    <div id="radar-scan"></div>
                    <svg id="map-lines"></svg>
                    <pre id="ascii-map">        .       .         .      +       .
            +        .        .     _      .
            .    _     /~~~~\  .      (_)
                (_)   |  镜  |      .     .
        .     |    |  湖  |    .
        _________|_____\____/__________
    /         |          \          \
    |  黑星    |  深空     |  黑森林  |
    |  医院    |  观景台   |          |
    |_________|__________|__________|
        |           |           |
    [回声公寓]--[中心广场]--[阿卡姆集市]
        |           |           |
    [日光商厦]--[议会大楼]--[松鼠旅社]
        |           |
    [环球影院]--[帷幕图书馆]--[夜间广播站]</pre>

                    <div class="map-node" style="top: 52%; left: 45%;" onclick="travel('中心广场')">中心广场</div>
                    <div class="map-node" style="top: 67%; left: 45%;" onclick="travel('议会大楼')">议会大楼</div>
                    <div class="map-node" style="top: 67%; left: 20%;" onclick="travel('日光商厦')">日光商厦</div>
                    <div class="map-node" style="top: 36%; left: 45%;" onclick="travel('深空观景台')">深空观景台</div>
                    <div class="map-node" style="top: 52%; left: 70%;" onclick="travel('阿卡姆集市')">阿卡姆集市</div>
                    <div class="map-node" style="top: 36%; left: 20%;" onclick="travel('黑星医院')">黑星医院</div>
                    <div class="map-node" style="top: 82%; left: 20%;" onclick="travel('环球电影院')">环球电影院</div>
                    <div class="map-node" style="top: 52%; left: 20%;" onclick="travel('回声公寓楼')">回声公寓楼</div>
                    <div class="map-node" style="top: 82%; left: 45%;" onclick="travel('帷幕图书馆')">帷幕图书馆</div>
                    <div class="map-node" style="top: 67%; left: 70%;" onclick="travel('松鼠旅社')">松鼠旅社</div>
                    <div class="map-node" style="top: 20%; left: 45%;" onclick="travel('湖区')">湖区/镜湖</div>
                    <div class="map-node" style="top: 82%; left: 70%;" onclick="travel('夜间广播站')">夜间广播站</div>

                    <!-- 事件目击遮罩层 - 覆盖 map-section，与地图对齐 -->
                    <div id="auto-event-overlay">
                        <div id="auto-event-drawer">
                            <div id="auto-event-drawer-header">
                                <span style="color: var(--term-bright); margin-right: 10px; white-space: nowrap;">>>>
                                    正在目击事件...</span>
                                <div id="auto-event-progress">
                                    <div id="auto-event-progress-bar"></div>
                                </div>
                                <button id="auto-event-drawer-close" class="btn-close"
                                    onclick="closeAutoEventModal()">X</button>
                            </div>
                            <div id="auto-event-drawer-content">
                                <div id="auto-event-content"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="notepad-container">
                    <div class="panel-header">>>> 记事本</div>
                    <textarea id="notepad-area"></textarea>
                </div>
            </div>

            <div id="right-sidebar">
                <div class="sidebar-section">
                    <div class="panel-header">== 今日已收集的新闻 ==</div>
                    <div id="collected-news-container"></div>
                </div>
                <div class="sidebar-section">
                    <div class="panel-header">== 今日已收集的事件 ==</div>
                    <div id="collected-events-container"></div>
                </div>
                <div id="status-message-area">
                    <span id="status-text">>>> 等待行动指令...</span><span class="cursor-blink">|</span>
                </div>
            </div>
        </div>
        <div id="game-footer">
            版权所有©2025灰烬马戏团
        </div>
    </div>

    <div id="archive-modal" class="modal">
        <div class="modal-header" style="background:var(--term-blue);">
            <span>ARCHIVES (档案库)</span>
            <button class="btn-close" onclick="closeModal('archive-modal')">X</button>
        </div>
        <div class="archive-tabs">
            <div class="archive-tab active" onclick="renderArchive('loc')">地点</div>
            <div class="archive-tab" onclick="renderArchive('char')">人物</div>
        </div>
        <div id="archive-list" class="archive-content"></div>
    </div>

    <div id="event-sys-modal" class="modal">
        <div class="modal-header">
            <span>事件复盘</span>
            <button class="btn-close" onclick="closeModal('event-sys-modal')">X</button>
        </div>
        <div class="event-sys-layout">
            <div class="es-col-left">
                <div class="es-list-header">待复盘事件列表</div>
                <div id="es-list-container" class="es-list-body"></div>
            </div>
            <div class="es-col-right">
                <div id="quiz-area" class="quiz-container">
                    <div style="color:#666; text-align:center; margin-top:100px;">
                        &lt; 请在左侧选择一个复盘任务 &gt;<br><br>
                        <small>注意：只有收集齐相关线索后，复盘任务才会开启。</small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="auto-event-modal" class="modal" style="width: 500px; border-color: var(--term-bright);">
        <div class="modal-header" style="background: var(--term-bright);">
            <span>发现事件！</span>
            <button class="btn-close" onclick="closeModal('auto-event-modal')">X</button>
        </div>
        <div class="text-content" id="auto-event-content" style="color: #fff;"></div>
    </div>

    <div id="hotline-popup-modal" class="modal" style="width: 500px; border-color: var(--term-alert);">
        <div class="modal-header" style="background: var(--term-alert); color:#fff;">
            <span>居民热线</span>
            <button class="btn-close" onclick="closeModal('hotline-popup-modal')">X</button>
        </div>
        <div class="text-content" id="hotline-popup-content" style="color: #fff;"></div>
    </div>

    <div id="news-detail-modal" class="modal" style="width: 600px;">
        <div class="modal-header">
            <span>今日新闻</span>
            <button class="btn-close" onclick="closeModal('news-detail-modal')">X</button>
        </div>
        <div id="news-detail-content"></div>
    </div>

    <div id="event-detail-modal" class="modal" style="width: 600px;">
        <div class="modal-header">
            <span>今日事件</span>
            <button class="btn-close" onclick="closeModal('event-detail-modal')">X</button>
        </div>
        <div id="event-detail-content"></div>
    </div>

    <div id="info-modal" class="modal" style="width:600px; max-height:600px;">
        <div class="modal-header"><span>今日晨报</span> <button class="btn-close"
                onclick="closeModal('info-modal')">X</button></div>
        <div class="text-content" id="info-content"></div>
    </div>

    <div id="hotline-modal" class="modal" style="width:600px;">
        <div class="modal-header"><span>居民热线</span> <button class="btn-close"
                onclick="closeModal('hotline-modal')">X</button></div>
        <div class="text-content" id="hotline-content" style="max-height: 500px; overflow-y: auto;"></div>
    </div>

    <div id="intro-modal" class="modal" style="width:700px; border-color:var(--term-alert);">
        <div class="modal-header" style="background:var(--term-alert); color:#fff;">
            <span>信息</span>
            <button class="btn-close" onclick="closeIntro1()">X</button>
        </div>
        <div class="text-content" style="color:#ddd;">
            <p>老哈里把一只马克杯重重砸在桌上。</p>
            <p>“菜鸟，听好了。我好不容易才保住了这个频段，也好不容易把你从失业大军里捞出来。”</p>
            <p>“每天，就四条新闻。这一点都不难，看看晨报，听听居民热线留言，实在不行，打电话给米米，那家伙像条黄鳝一样到处钻，消息灵通得很。如果你做不到，你就卷铺盖走人。现在，滚去工作吧。”</p>
        </div>
    </div>

    <div id="tutorial-modal" class="modal" style="width:700px; border-color:var(--term-blue);">
        <div class="modal-header" style="background:var(--term-blue); color:#000;">
            <span>教程</span>
            <button class="btn-close" onclick="closeModal('tutorial-modal')">X</button>
        </div>
        <div class="text-content" style="color:#ddd; line-height:1.8;">
            <p><strong>时间</strong> - 你的朋友和敌人。点击任何地点都会消耗30分钟的时间</p>
            <p><strong>地点</strong> - 在<span class="hl-yellow">正确的时间</span>点击<span class="hl-yellow">正确的地点</span>，则出现事件
            </p>
            <p><strong>事件</strong> - 搜集足够的事件，可在“事件复盘”中进行推理<br>
                <small><span class="hl-yellow">(事件只会发生一次，需要注意观察；新闻可点击查看)</span></small>
            </p>
            <p><strong>档案库</strong> - 一些词条，点击蓝色词汇可收集解锁</p>
            <p><strong>备忘录</strong> - 你的私人记事本，可以随时删改记录</p>

            <hr style="border-color:#333; margin:15px 0;">

            <p><strong>玩法:</strong></p>
            <ul style="list-style:none; padding-left:0; color:#aaa; line-height:1.6;">
                <li>// 每天的冒险从早上8点开始</li>
                <li>// 先点开‘今日晨报’，看看有什么新鲜事</li>
                <li>// 随时接听“居民热线”，可能有意想不到的线索</li>
                <li>// 沿着这些线索在“<span class="hl-yellow">正确的时间</span>”去往“<span class="hl-yellow">正确的地点</span>”</li>
                <li style="margin-top:8px;">// 当搜集到足够的线索，可在“事件复盘”中进行推理</li>
                <li>// 推理成功，得出可供晚间播报的新闻</li>
                <li style="margin-top:8px;">// 错过的事件可点击“呼叫米米”</li>
                <li>// 花费2小时可获得一条错过的事件</li>
            </ul>
        </div>
    </div>

    <div id="broadcast-screen">
        <div id="tally-light"></div> <!-- Tally Light added here -->
        <div class="broadcast-layout">
            <div
                style="display:flex; justify-content:space-between; border-bottom:2px solid #333; padding-bottom:10px;">
                <h2 style="margin:0; color:var(--term-main);">ON AIR // 直播中</h2>
                <div style="color:#666;">MANUAL SELECT MODE</div>
            </div>
            <div>
                <h3 style="color:var(--term-main); font-size:1em; margin-bottom: 5px;">≡ 今日可用素材</h3>
                <div id="broadcast-pool" class="broadcast-pool"></div>
            </div>
            <div>
                <h3 style="text-align:center; color:var(--term-bright);">播放列表 (点击移除)</h3>
                <div class="broadcast-slot-row">
                    <div id="bslot-0" class="b-slot" onclick="clearSlot(0)">[ 空 ]</div>
                    <div id="bslot-1" class="b-slot" onclick="clearSlot(1)">[ 空 ]</div>
                    <div id="bslot-2" class="b-slot" onclick="clearSlot(2)">[ 空 ]</div>
                    <div id="bslot-3" class="b-slot" onclick="clearSlot(3)">[ 空 ]</div>
                </div>
                <div style="text-align:center;">
                    <button id="btn-start-broadcast" class="btn-menu btn-start-b" onclick="startBroadcast()">● REC
                        开始直播</button>
                </div>
            </div>
            <div id="teleprompter" class="teleprompter" onclick="fastForwardType()"><span class="cursor-blink">|</span>
            </div>
            <div id="audio-visualizer"></div> <!-- Audio Visualizer added here -->
            <div id="result-panel"
                style="display:none; text-align:center; border-top:2px dashed #333; padding-top:20px;">
                <h2 id="end-msg">>>> 播报结束</h2>
                <div id="end-btn-container" style="display:flex; gap:20px; justify-content:center; margin-top:20px;">
                    <button class="btn-menu" style="flex:1;" onclick="restartDay()">重玩今日</button>
                    <button class="btn-menu" style="flex:1;" onclick="nextDay()">前往下一天 >></button>
                </div>
            </div>
        </div>
    </div>

    <!-- Rating Report Modal -->
    <div id="rating-modal">
        <div class="report-paper">
            <div class="report-header">收听率报告</div>
            <div class="report-row">
                <span>今日收听率:</span>
                <span id="rating-percent" style="font-family: 'Courier New', monospace;">0%</span>
            </div>
            <div class="score-big">
                <span id="rating-big-num">0</span>%
            </div>
            <div class="report-row">
                <span>综合评价:</span>
            </div>
            <div id="rating-stamp" class="stamp">SAFE</div>
        </div>
        <div id="danger-phone" class="phone-alert">
            <div class="phone-icon">☎</div>
            <div class="phone-msg">听众活跃度UP</div>
        </div>
    </div>

    <script>
        // --- Data Definition (Conspiracy & Corporate Horror Version) ---

        const fillerNewsDB = [
            { title: "邻居家小狗学会后空翻", text: "居民汤姆称他的黄色小狗能够连续后空翻三次，但他拒绝展示。" },
            { title: "录像带租赁店重新开业", text: "店内全部是没有标签的录像带，里面可能是电影、古早电视剧或者家庭影像。" },
            { title: "理发店镜中的理想自我", text: "为了让客人感觉良好，理发店特质了一面变美镜，导致很多顾客盯着镜子太久，拒绝离开。" },
            { title: "你的手表可能在撒谎", text: "你有没有发现，你的手表每天随机偷走你10分钟。这就是为什么你明明起得很早，却依然迟到的原因。" },
            { title: "市民拍到保护动物凤尾鸡", text: "凤尾鸡是一种眉清目秀的鸡，非常稀有。" },
            { title: "路灯学会按时下班", text: "晚上十二点整，所有路灯同时熄灭。第二天傍晚准时全体开工。" },
            { title: "图书馆出现剧透小偷", text: "有人把图书馆悬疑侦探类的书借了个遍，并且在每个开头都用笔圈出凶手的名字。" },
            { title: "市中心心形积雨云", text: "这朵云悬在空中一整天，没有变形，也没有飘动。它或许在向镇民们展示爱意……和雨水。" },
            { title: "镇广播间歇性播放摇篮曲", text: "每天下午三点左右，无论正在播放什么节目，信号都会插入一段2分钟的无歌词摇篮曲，部分成年听众反映听后产生强烈的午睡冲动。" },
            { title: "邮件机器人学会读心术", text: "多位居民报告称，收到了一些他们正在想要但从未说出口的商品广告目录。" },
            { title: "便利店热狗机自主创新口味", text: "便利店热狗机开始生产夹有蓝莓酱和黄芥末的梦幻热狗，尝试者评价两极分化，但销量稳定。" },
            { title: "垃圾车播放分类教学儿歌", text: "垃圾清运车在作业时会循环播放一首关于垃圾分类的洗脑儿歌，全镇儿童已熟练掌握复杂分类标准。" },
        ];

        const TRAVEL_DURATION = 1500; // Adjustable travel animation duration (ms)

        const coldJokes = [
            "我爱上班，我爱工作，我爱上班，我爱工作。",
            "优惠券……优惠券。",
            "你有没有觉得，今天的云长得像一只笑眯眯的狗？",
            "晒得太多的一侧脸颊会长老年斑吗？",
            "今天这条裤子穿着痒痒的。",
            "时间永远不够用……",
            "肚子饿，想吃拉面。",
            "一定不能在下午五点之后喝咖啡……",
            "绝对不能因为工作耽误吃饭，绝对不能！",
            "好像忘记了什么重要的事儿？是什么呢？",
            "阿卡姆集市的肉馅饼，听说原料来源非常……神秘。",
            "好想去跳广场舞。",
            "不管是活人还是死人，都要遵守交通规则，尤其是死人。",
            "别忘记回家之后给花浇水。",
            "生活要一直如此奔波吗？",
            "时间就像面条，有时长，有时短。",
            "便利店关东煮的汤，第几轮开始算老汤？",
            "现在立刻马上，必须吃掉一块小蛋糕，这是宇宙的旨意。",
            "如果你在森林里迷路了，记得大喊‘我爱工作’，也许上司会把你抓回去。",
            "刚才，有个念头闪过去了……算了，它应该会自己回来。",
            "在路上唱歌，被人看到会不会尴尬？",
            "天气像我的心情一样阴雨连绵。",
            "柠檬汁和啤酒，加在一起就是柠檬啤酒。",
            "腹式呼吸有助于缓解焦虑……",
            "饥饿……永恒的饥饿……",
            "只要我闭上眼，那些糟糕的事情就不会发生。",
            "只要活着，就能见证一件又一件的怪事……",
            "可口可乐还是雪碧？这是个难题。",
            "突然肚子疼……",
            "洗手间，洗手间在哪儿……",
            "抖抖鞋里的沙子，磨刀不误砍柴工……"
        ];

        // 档案库数据 - (保持 v42 版本原样，未修改)
        const archiveDB = {
            loc: {
                '夜间广播站': "一座生锈铁塔的附属品，好在它还能为你提供一个小小的容身之所。和电波相伴的每个夜晚，那些过时的模拟信号设备发热、嗡嗡作响，而你像垃圾场的国王一样安坐于此。",
                '中心广场': "广场上有几片多边形花圃，中央立着一座音乐喷泉，白色长椅沿着廊道摆放，角落里还立着几尊石膏像。节假日时，喷泉的彩光灯和音乐才会被打开。偶尔，也会有集会和促销活动在这里举办。",
                '议会大楼': "镇议会工作的地方，很神秘，基本没办法进去。在这里工作的人也不会住在公寓、旅社这样的地方。或许这栋大楼内部也藏着一个小小的公寓，那些上班的人换个楼层就可以回家睡大觉了。",
                '日光商厦': "这栋现代主义建筑有十二层，下面五层是商铺，上面七层都是办公室。电梯经常出故障，动不动就罢工。人们抱怨它为什么要垂直向上生长，而不是像横躺的身体一样向两侧延展——至少能让他们少爬几级楼梯。",
                '深空观景台': "旅游鼎盛期建造的一座指向天空混凝土建筑，如今没什么游客，也几近荒废。栏杆锈迹斑斑，望远镜的透镜上蒙着擦不掉的油污。从这里俯瞰，视野几乎能够覆盖整座小镇，包括小镇边缘的湖区和森林。它们在穹顶之下呈现出一种神秘的宗教意味。",
                '湖区': "包含镜湖与森林。镜湖是有着“月亮女神梳妆镜”之称的湖泊，据说满月的夜晚，水面会呈现液态水银般的光泽，镜湖旁的林区处于小镇边缘，孩子们常为这片区域编造鬼故事，而大人们默许了这样的行为，意在让孩子生出畏惧之心，远离可能发生的危险。",
                '黑星医院': "镇上只有这一家医院，所以没有人知道这是否就是一个医院该有的样子。医院附近有一所学校，6~18岁的孩子们在这里以极低的学费接受教育，他们中最优秀的孩子可以在毕业后直接去黑星医院工作。",
                '阿卡姆集市': "如果你想寻找廉价的罐头、塑料玩具、过时的绣花夹克等等，这里是最好的选择。虽然弥漫着旧货市场的那种特有的馊味，但好在镇上的人大多不在乎这个。",
                '环球电影院': "镇上唯一一个真正意义上的娱乐场所，年轻男女约会的地方。但由于镇上适龄青年太少了，电影放映的次数也屈指可数，导致他们经常在这边碰上自己的前任。影院屏幕后有个暗门，底下有间秘密酒吧，只有8个座椅。",
                '回声公寓楼': "一栋涂着红黄蓝饰边的现代主义建筑，也是镇上唯一的公寓楼，分为十八个单元，每个单元之间都有草坪和微型公园，导致串门也没有想象的那般容易。每天清晨，居民们的生活都以这里为原点展开。",
                '帷幕图书馆': "一栋外墙由棕绿色块拼成的老建筑，藏书不少，很多书的封皮，都糊满了过去几十年孩子们留下的油腻指印。这里偶尔会举办一些活动，那间光线不足的咖啡厅则成为约会和交换秘密的地方。",
                '松鼠旅社': "旅游鼎盛期建造的典型的乡镇旅社，墙绘已经剥落得难以辨认，内部空间很大，名义上的管理者叫文森特。外来游客、过路商人、以及因各种原因失去住所的居民都会暂时被安置在这里。"
            },
            char: {
                '莫里斯镇长': "一个容易紧张的老好人。从年轻时就在镇议会工作了。虽然大家对他做过什么造福居民的好事都毫无印象，但好在也没做过什么让人生气的坏事。相比于管理者，他更像一个过时的、无人问津的吉祥物。",
                '贝格女士': "烫着大波浪的红头发女士，她戴着一个巨大的黑框眼镜，空洞的眼神被镜片放大后像某种冷血动物，总是直勾勾地盯着你。她原本是镇图书馆的图书管理员，创立读书会后，要求大家以“会长”称呼她。",
                '米米': "全镇最靠谱的私家侦探。你从没见过她的模样，她总是藏在阴影里，贪婪地捕捉那些肮脏的秘密。每天晚8点，她准时“下班”，直到12小时之后才能联系上。没有人知道她这段时间在做什么。",
                '文森特': "松鼠旅社名义上的管理者，一头稻草黄的枯发，总是穿着有一大堆口袋的马甲和裤子，随时都能从某个口袋里顺出来钥匙、打火机、口香糖、折叠刀、指甲锉等小玩意。",
                '老哈里': "你的远房亲戚，暂时是你名义上的领导，实际上他早就想甩手不干了。把你捞来夜间广播站之后，他就拍拍屁股一走了之。有时你播完新闻之后，他还要阴魂不散地出来点评两句。",
                '希斯女士': "小镇的创始人，或者说，第一波来此地的移民领袖。这些都是在你出生前发生的事情了。据说希斯女士建立小镇并把大家的生活都安置规整之后，很快就离开了，以至于每次居民们提到这位伟大的人物，都没人能想得起来关于她的任何事。",
                '梅尔维尔': "小镇极其少见的旅客，他看上去七十多岁，是个身形佝偻，有点耳背的老人，暂住在松鼠旅馆。他似乎在寻找着什么——是童年记忆中失落的风景，还是一段迟迟未能散去的执念？或许他自己也说不清。",
                '艾伦': "年纪不大，看起来总是鬼鬼祟祟的，据说他曾在自家阁楼搭了一套简陋的无线电设备，用的是从旧货市场收来的一堆破烂——锈迹斑斑的金属天线、报废机房拆下来的调谐器等等。在他妈妈一次歇斯底里的发火之后，他默默地把这些东西送回了垃圾场。",
                '丽莎': "电台奇怪频道联系上的。我和艾伦管她叫幽灵丽莎。或许和艾伦一样，她也是一位狂热的电波爱好者，并且执着于寻找某个谜题的答案。她的声音带着一种冷静的疲惫，让人不禁好奇，这声音背后的主人到底长什么样子。",
                '娜娜': "一头帅气的银灰色短发，个人风格十足、很有活力的年轻人。日光商厦每一个办公室格子间里的人都喜欢她。作为日光商厦211便利店的收银员，她喜欢在柜台放些维持血糖的小零食，以便那些来不及结账、面色惨白的白领栽倒在地时能够快速补充能量。",
                '加里先生': "知名企业家，头发总是精心打理、泛着油亮的光泽，西装也笔挺得无可挑剔。他的办公室占据了日光商厦整整两层楼。或许是因为繁忙的商务事务，他并不常在镇上露面，只有在开幕式、剪彩等正式场合才会出现。",
                '塞恩': "广告公司设计师，相貌平平，个头中等，走在人群中很容易被忽略。同事们说他“天真得不像个成年人”，但他从不反驳。他的桌面上放满了各种塑胶小玩具和在咖啡店免费获赠的冰箱贴。有时候他会对着它们自言自语。",
                '杰弗里': "黑星医院院长，黑星学校名誉教授，看起来有些严肃的职业女性。她的衣橱里似乎永远只有一种颜色。无论天气冷暖，她都穿着那身略显旧的白色职业装，连皱褶处都一模一样。",
                '达文虎克': "热心的天文爱好者。他坚信这座小镇正处于某种“异常的轨迹线上”，并长期向议会提交观测报告，但大多数都因为缺乏科学依据被退回。"
            }
        };

        const eventCards = {
            // DAY 1
            'd1_a': { day: 1, title: "D1-A 中心广场剪彩", text: "巨大的围挡像遮羞布一样落下。\n莫里斯镇长正在鼓掌，但掌声稀稀拉拉，很快被尴尬的沉默吞没。\n你看向那座翻新后的雕像。不对劲。非常不对劲。那是创始人的雕塑，穿着那件标志性的风衣。但那个头……它的比例显然太大了，面部就像一幅抽象画，根本看不出是谁。" },
            'd1_b': { day: 1, title: "D1-B 中心广场耳语", text: "活动结束后，大家似乎不急于收拾，于是现场看上去有些混乱。写着“弧光镇庆典”的条幅被扔到了一边。有建筑工人模样的人在角落低声说话，你凑上前偷听。\n“听说雕塑的头在搬运时摔碎了，只能临时买这个二手的。”\n“我就说像之前废弃游乐园里的那个……”\n“嗨。要我说，没什么区别。反正也没人知道创始人希斯女士的样子。”\n“也是，她老人家估计已经退休了吧。几十年没出现过了。”" },
            'd1_c': { day: 1, title: "D1-C 空气中的柠檬味", text: "空气里飘着一股淡淡的柠檬味，你站在远处观望。\n几个路过的居民正贪婪地吸着气，眼神显然有些涣散。\n街角一辆运输车上，几名戴口罩的工人正在用塑料薄膜一圈圈地裹住一个金属罐，车尾和地面上都有些黏糊的油渍。\n你的大脑空白了一会儿。这是在哪里来着？\n等你回过神来，你心情莫名好了起来，连脚步都轻快了不少。" },
            'd1_d': { day: 1, title: "D1-D 贝格女士神秘读书会", text: "旧图书馆的木地板发出咯吱咯吱的声音。 二楼中央围坐着一圈虔诚的书友。贝格女士站在中间发表着演讲。\n桌上摆着一堆印着招募字样的传单。书架上摆了一排排奇怪的药瓶和全息投影仪。“白天的世界属于资本和机器，”贝格女士说，“夜晚才是安放疲惫心灵的时间，所以我们的特别活动将在夜晚举行。”" },
            'd1_e': { day: 1, title: "D1-E UFO光团再次出现", text: "几位年轻人手舞足蹈地指着天空，样子有些滑稽。\n“看见了吗？就在路灯后面！“他们指着天空。”什么东西？“其他人伸着脖子看了一会儿。那里除了墨水一样的黑夜，什么都没有。\n有人已经举起了手机，但小小的四方屏幕里，只有那盏路灯发出暖黄色的光，“这东西无法被拍摄！”他说，“绝对是UFO！”\n“哦，当小镇还年轻时，经常有人慕名而来寻找UFO。那时候，太多游客了，”一位年长的女士说道，“很多人就是因为UFO，嗯，当然还有免费医疗，选择定居这里的。”" },

            // DAY 2
            'd2_a': { day: 2, title: "D2-A 丢失的邮件", text: "大爷手里攥着身份证，愤怒地咆哮：\n“我在这栋楼住了十年！现在那个该死的邮政机器人告诉我，我的邮箱地址对不上，让我直接联系拿错邮件的人。我要是能联系上，我还要它干嘛？”\n一旁的邮政机器人眨巴着大眼睛，显得无辜且无用。" },
            'd2_b': { day: 2, title: "D2-B 错收的邮件", text: "“哇，没想到你还真来了！“\n“这是我收到的邮件，字都给印重影了，邮戳也有两个。”\n“这种情况，应该是中转时被错投了。也就是说……投递系统可能以为中转站就是终点，结果又被中转站再投递了一遍。这大概也是难以避免的事情，毕竟我们这里习惯于把地址都写成缩写，像什么摩尔斯代码似的。”" },
            'd2_c': { day: 2, title: "D2-C 好睡片新品促销", text: "几个套着廉价绒毛玩偶服的促销员，拿着大喇叭喊：\n“好睡片Plus，给您带来比好睡片更强劲的安神体验！”\n“睡前含一片，安详似神仙！\"\n说完，一个玩偶掏出药片，费劲地塞进大头套里，随手把喇叭一扔，直接躺倒在地。" },
            'd2_d': { day: 2, title: "D2-D 喷气式自行车追尾", text: "四辆喷气式自行车纠缠在一起，金属扭曲，碎屑散落一地。\n这儿并没有血腥的惨叫。你走近看，发现这起追尾事故的当事人们，正以生平最扭曲的姿势躺在地上，甚至还有人挂在路灯上。\n他们闭着眼，嘴角流着口水，发出一阵阵安详的呼噜声。其中一个人的手里还紧紧攥着个彩色药瓶。“那是今天刚刚上市的好睡片Plus，”旁边的黑市医生说，“能在1秒内强制入睡。这几个飞车党，在撞车前一秒吞药，避开了疼痛。”" },
            'd2_e': { day: 2, title: "D2-E 当流星划过", text: "你端坐在冰冷的观景台长椅上，风像冰刀一样割着你的脸。\n这里是城市最黑暗的地方。\n一天还没过完，你却已经累得筋疲力尽，像被抽干了所有力气。就在你快要彻底睡去时，一颗巨大的、闪烁着红光的流星划过城市边缘，悄无声息地坠落。" },
            'd2_f': { day: 2, title: "D2-F 死者回到镇上", text: "老杰米，你把这名字在脑子里搜索了一番。哦，是镇上那个沉默寡言的锁匠。\n此刻他坐在广场喷泉边，穿着一套过于正式的黑色西装，布料在阳光下显得崭新得不合时宜。“那就是老杰米！已经死了的老杰米！”有人惊叫道。\n恐惧像瘟疫一样蔓延。有人转身就跑，有人僵在原地，死死盯着他，试图找到那张脸上的破绽。" },

            // DAY 3
            'd3_a': { day: 3, title: "D3-A 街上游荡的怪老头", text: "穿格子衫、戴宽沿遮阳帽的老人在冲着商铺打量。\n“大爷，您好。您打算上哪儿去呀？”\n“没有瀑布的瀑布谷，”大爷讲，“就像不养鸡的养鸡场。”\n“不下蛋的老母鸡，没有老婆的老婆饼。”\n“……”大爷头也不回地走了。" },
            'd3_b': { day: 3, title: "D3-B 文森特的口信", text: "“是这样的，”文森特挠了挠头。“我这儿来了个让人头疼的客人。”\n“他叫梅尔维尔，年纪挺大的，穿格子衫，耳背。他想来咱们这找一个叫什么瀑布谷的地方。说他小时候和爸妈来过。可是咱这儿根本没有这么个地方呀?我问他，是不是记错了。\n他说肯定没错。说瀑布谷没有瀑布，这让小时候的他觉得被骗了，所以印象深刻。你见过他吗？要不要打听打听这事？”" },
            'd3_c': { day: 3, title: "D3-C 《灾变21天》今日上映", text: "小小的影院被人围得水泄不通。\n看起来影院在宣传上下了功夫，几张巨大的宣传海报几乎贴满了墙壁。\n内容是：“灾变倒计时，当红影星演绎极限求生！”\n“丧尸狂潮来袭！等待奇迹还是绝地反击？”\n“全实景拍摄打造毁灭级视听冲击！”\n“爆米花特价活动，买一赠一！”" },
            'd3_d': { day: 3, title: "D3-D 贝格女士的拥抱", text: "“一个温暖的拥抱，能胜过千言万语。”贝格女士发表着她的演讲，“我小时候……我那位了不起的母亲，就常常拉着我和其他孩子，围成一圈拥抱彼此，”贝格女士说。她今天特意穿了件触感极佳的羊绒开衫。她将一位哭泣的男性圈在怀里，自己精心挑选的香水——也许是“邂逅”或“五月玫瑰”——从羊毛衫上弥漫开来，强势地包裹住对方身上传来的、微弱的汗与颓唐的气味。男人在她的怀抱里逐渐平静下来。" },
            'd3_e': { day: 3, title: "D3-E 电梯夹人事件", text: "最后一批加班的职员疲惫地涌向轿厢。当一名面色苍白的男性试图挤进去时，电梯发出了“嘀嘀——嘀嘀——”的警报。空气凝固了两秒，那名男性无奈地撤退出来，然后，那扇本该敞开的金属门，突然像捕兽夹般凶狠地咬合。“哎呦！”他把歪掉的眼镜摘下来，从口袋掏出纸巾擦拭，“晚上，它总会这样。就像因为我们加班导致它也在加班一样发脾气。”\n“电梯没有任何问题，”一旁的技术人员说，”一定是你们迈入迈出得太慢了，多加练习，才能适应这个电梯系统。”" },

            // DAY 4
            'd4_a': { day: 4, title: "D4-A 死者归返声明", text: "“亲爱的居民们，”莫里斯的声音通过扩音器传出，在空旷的广场上回荡，“关于近期……一些不同寻常的目击报告，镇议会高度重视。”他继续说道：“生命是神圣且唯一的，如果这些逝去的人，选择回到我们身边，那必然是出于最深切的爱与牵挂。从今天起，让我们放下无谓的恐惧，迎接他们再度走进我们的生活。”" },
            'd4_b': { day: 4, title: "D4-B 软巧冰淇淋白天场", text: "一辆漆成粉色的卡车停在集市门口，车喇叭循环播放着一段童谣。\n人们排起了长队。脸色苍白的小贩从机器里挤出一坨粉红色的膏体，递给一个跑得小脸通红的孩子。“请问，这冰淇淋是用什么做的呀？”你上前搭话。小贩瞥了你一眼，没有说话。" },
            'd4_c': { day: 4, title: "D4-C 软巧冰淇淋晚间场", text: "白天集市的那辆粉色卡车，此刻正悄无声息地出现在公寓楼下。粉色的霓虹灯管滋滋作响，将周围排队的人群脸颊打上一层迷幻的颜色。除了嬉笑打闹的孩子之外，很多大人也在等待着吃一口最新口味的冰淇淋。" },
            'd4_d': { day: 4, title: "D4-D 艾伦遭遇神秘电波", text: "你回到广播站时，艾伦像受惊的老鼠一样缩在控制台旁。“你好！”\n“就是这个！听到了吗？”他神经质地指着那个正在疯狂跳动的示波器，”这个频段！找不到任何源头！这是幽灵电波！”\n此刻，喇叭里传出断断续续的女声。“你……好……我是……丽莎……有人……吗？”\n艾伦推过来一个麦克风，示意你对她说话。\n“丽莎，你好，我是弧光镇晚间新闻的主播，请问你是怎么联系到这里的呢？”\n“嗨……我……实验事故……调查……封锁……”\n“丽莎，信号好像不太好。我们听不清你的声音。”\n“封锁……电台……居民……帮助调查……“很快，这些词汇也变得难以辨认。\n艾伦烦躁地拨弄着旋钮，然而无济于事。" },
            'd4_e': { day: 4, title: "D4-E 二手店收购噩梦", text: "集市角落一个不起眼的小店，五颜六色的低俗漫画招牌因日晒变得褪色。\n“《墙后的咀嚼声》，只要十块钱。这里面讲的是，你搬进新公寓的第一晚，听到隔壁传来持续、湿漉漉的咀嚼声。敲墙，声音就停，你躺回床上五分钟，那声音又开始了……就从贴着你枕头的这面墙传来！不错吧？当然了，再加上五到十块钱，我还有更带劲的……”\n“这是什么？”你问。\n“这位顾客，你想来点刺激的吗？这些，全部是我收购来的噩梦！内容之惊悚……超乎你的想象！多多购买，还有其他好处……每天读上一篇，或许很快你也可以来我这里出售噩梦了！”" },

            // DAY 5
            'd5_a': { day: 5, title: "D5-A 怪狗的脚印", text: "图书馆后巷的垃圾桶被暴力地翻倒在地。你在散落的书页和腐烂果皮之间，看到了一串奇怪的脚印——前爪和后爪挨得过于近了。" },
            'd5_b': { day: 5, title: "D5-B 目击怪狗", text: "你循着脚印和空气中湿狗毛的味道，偷偷转过两个墙角。你看到了！一只狗躲藏在阴影里，它的头和臀部之间几乎直接衔接在了一起——一只没有身体的狗！" },
            'd5_c': { day: 5, title: "D5-C 归返者走进便利店（上）", text: "一阵令人尴尬的掌声之后，老杰米走了出来——依然是那套黑色西装，动作却比昨天流畅了许多。在他身后，陆续走出另外三人，莫里斯镇长分别介绍了他们：五年前去世的露丝奶奶、半年前因肺病离世的卢卡斯先生、还有三个月前突发心梗的前图书管理员苏珊女士。\n他们站成一排，面向零散的围观人群。阳光照在他们脸上，皮肤像涂了蜡的水果一样亮津津的。\n加里先生宣布，这四位回归的居民，已通过完整行为校准，正式重返社区生活，“今天中午十二点之后，大家就可以在日光商厦见到他们。”\n“他们保有生前的技能与记忆，将继续为我们的小镇贡献力量。”莫里斯镇长张开双臂，“死亡不再是永别。欢迎回家，各位。”" },
            'd5_d': { day: 5, title: "D5-D 归返者走进便利店（下）", text: "211便利店收银台——售货员娜娜曾经站立的位置，现在站着归返者老杰米。\n他穿着便利店统一的蓝色围裙，双手平放在台面上，手指微微分开。你拿了一瓶水走向收银台。老杰米抬起头，眼球向上翻动了一下。\n“杰米叔，”你试探着问，“你还记得我吗？大概五年前，我家的门锁坏了，是你来修的。”\n“记得，通用型C12锁，”老杰米回答。他的目光越过你的脸、越过你的后脑勺、越过便利店被促销广告贴得凌乱无比的墙壁。你确信，老杰米的眼睛没有看向任何人。" },
            'd5_e': { day: 5, title: "D5-E 幽灵丽莎的邀请", text: "艾伦的声音像受潮的磁带一样紧张得发皱。“喂，你好。丽莎吗？”\n“你好……是的……我调了一下我的收发机……是不是清楚一些了？”\n“清楚了很多。丽莎，你为什么要联系我们？”\n“我在调查月湖镇……试验事故的真相……他们宣称是化学品泄露，封锁了小镇……我前男友不知所踪……他是个UFO狂热爱好者，在镇上待了一阵子……后来联络不上了。我觉得很可疑……就想试试能不能联系上这里的居民……”\n“我们这里叫弧光镇，不是月湖镇。而且这里没有化学品泄露、也没有封锁，前几天还有个老人从外地过来旅游呢。”\n“啊？旅游？可是按理说应该没错……我再去校准一下位置，我会尽快再联系你们的。”" },
            'd5_f': { day: 5, title: "D5-F 诺玛的日记", text: "你从公寓楼的邮箱里，拿到了热心居民提供的日记，你小心翼翼的翻动。日记的主人诺玛在其中描写了许多日常的场景。\n部分日记：\n1958年9月12日，父亲最近时常流露出一种恐惧的神情。他说，街上晃荡的人太多了，这让他感到不安。然后有一天，他突然问我，我们一起离开怎么样？但我不想，这里有我的好朋友珍妮、安，还有我喜欢的男孩……我跟父亲顶嘴了。\n1958年10月26日，天气冷下来了，父亲之前还在观望。他嘴里念叨着“这比那场大洪水更可怕。”他说我们必须要在圣诞节之前彻底离开。我哭了。该怎么和珍妮和安说？我们上周才对着月湖发誓，要做一辈子的“好姐妹三人组”。\n1958年11月18日，我决定，和珍妮、安一起，把我的这本日记，和所有我喜欢的玩具放在盒子里埋到广场的花坛里。我们约定，当我们活得很老很老了，可以一起挖出这个盒子。希望那时候，我们会是镇上最漂亮的老太太。" },

            // DAY 6
            'd6_a': { day: 6, title: "D6-A 免费更换电子锁活动（上）", text: "商厦门口蹲着几个穿着灰扑扑制服的人。伴随着刺耳的电钻声，老式黄铜锁芯一颗颗被拧出来，哐当哐当，掉进铁皮桶里，像掉了一地的乳牙，取而代之的是一个个覆盖着PVC盖板的长条型金属盒子。\n“可以按指纹、可以用密码，还有磁卡可以做备用，”有人解释道，“还挺方便，至少各公司负责开门的那个人可以把重担卸下了。”" },
            'd6_b': { day: 6, title: "D6-B 免费更换电子锁活动（下）", text: "走廊里回荡叮叮咣咣的声音。邻居们拿着新发的磁卡，脸上浮现出一种对高科技的迷茫。很快，你手里也被塞了一张同意书签字表。\n“我能不签吗？”一位邻居说出了你的疑问，“哦，当然可以，您是不打算安装吗？可以的，只是日后万一遭遇入室盗窃，您的这种情况可能不会被受理。”\n你感到一种微妙的窒息。" },
            'd6_c': { day: 6, title: "D6-C 梅尔维尔的家庭照", text: "旅馆昏暗的大堂里，梅尔维尔蜷在一张吱呀作响的老藤椅里。见你走近，他用枯瘦的手指拨开一个木盒上的铜扣，抽出一张老照片。那是一张一家三口在草地上的合影，帐篷支在一旁，折叠椅、野餐垫散在草地上——典型的家庭露营照。“我记得很清楚！”老人喘着粗气说，“每周发一次的补给罐头，煮糊的燕麦味……妈妈会把‘综合蔬菜’里的胡萝卜挑出来，那东西咬下去一股土腥味，像在吃雨水泡过的烂木头……”\n“你看这里，”文森特的手指移向了背景深处，越过树梢，点在画面中央一座高耸的建筑尖顶上。\n那是深空观景台的天线塔。塔尖那截独特的、安装着球状避雷针的金属结构，像一枚生锈的钉子，楔进灰蒙蒙的天空里。这个视角，分明是从如今立着禁止牌子的那片碎石坡上，朝镇中心望过来的。\n“秃山——就是没有瀑布的瀑布谷，”文森特说。" },
            'd6_d': { day: 6, title: "D6-D 黑星医院全体医护人员出动", text: "急诊大厅就像一个沸腾的高压锅，满是消毒水、呕吐物和汗的酸臭味。孩子们躺在临时的担架上，皮肤上泛起奇异的红疹。“你就是冰淇淋吃多了才得的病！”一位母亲训斥自己的孩子，孩子瘪着嘴辩解：”你每次都这么说！你还说我爸头疼都是因为抽烟呢！“\n“你这孩子！还学会和大人犟嘴了！皮痒了是吗？”" },
            'd6_e': { day: 6, title: "D6-E 杰弗里院长夜间密会", text: "夜幕中，两个身影躲藏在树木的阴影里。杰弗里院长刻意压低的声音里难掩愤怒。\n“我就想问你是不是知情？这个问题很难回答吗？”\n“我也没有办法。但这事也提前通知你了，不是吗？还有那些药品……”\n“我女儿也病了！我怎么知道是那个东西有问题！”\n“她不会有事的……我保证……咱俩是一条绳上的蚂蚱……”\n“去你妈的！我受够了，你再这么干一次，我把一桶那玩意都灌你嘴里。”" },
            'd6_f': { day: 6, title: "D6-F 林中盛宴", text: "一条小径从湖区延伸到森林深处，你踩着咯吱作响的落叶往里走去。空气逐渐变得湿润，松脂与腐殖土的气息越发浓烈起来。穿过一片倾斜的矮灌木，你发现林间空地上支着几顶帆布帐篷，一口铁锅悬在临时垒起的石灶上，一个裹着头巾的男人用长柄勺搅动着，汤里翻滚着野洋葱、不知名的块茎，和一副小小的、带肉的骨架——可能是兔子，也可能是别的什么忘记了回家的动物。但这里还有其他味道，人造的气味，玫瑰、柠檬和肉豆蔻……像是贝格女士的香水味被放大了十倍的效果。很快，你在这氛围下变得晕乎起来。\n一位正在缝补衣服的年轻女性看见你，放下手里的活计微笑地向你走来：“欢迎！你想了解我们的文化和生活方式吗？或者，如果你想搬来，我们所有成员都无条件接纳！”\n“收什么？”你问，舌头有点不太听使唤。\n“任何一颗受伤的心，”她郑重地回答道。" },

            // DAY 7
            'd7_a': { day: 7, title: "D7-A 调查镇志", text: "你偷偷潜入图书馆，B09阅览室遍布灰尘，你一本本地摸索，试图寻找有用的信息。你发现，这里所有的资料都来自1960年代之后，口径也全都一致：\n小镇原本为大洪水后的灾民迁移与集中安置营地，人口大量迁出后，又因一系列“UFO目击事件”意外获得关注，吸引了好奇的游客与投资者。嗅觉灵敏的地产开发商随后介入，将此地包装、改造，最终把它打造为一个宜居的现代社区。并且，因为诊所扩建和免费医疗计划，想来的人一度多到需要排队。\n唯一引人注目的是一张手绘地图，图上清晰地勾勒出几片毗邻的土地轮廓。图纸的下方，一片区域被用力地画上了一个巨大的黑色“╳”，图纸上方，在所有地图标注“镜湖”的位置，赫然写着“月湖”二字。" },
            'd7_b': { day: 7, title: "D7-B 与生活家娜娜见面", text: "娜娜坐在咖啡厅最明亮的窗边，她展示着自己搭配的服装，语速飞快地谈论着色彩心理学和不同面料带给人的感受。\n“他们给我拍了很多照片，”娜娜说，”竞选生活家这件事，需要拍很多照片。我没想到自己会这么喜欢对着镜头的感觉……他们把我的照片贴在墙上，大家路过时会发出由衷的赞叹，这让我非常快乐，就好像生活里的其他糟心事被稀释了一样。”\n“我知道我在便利店只是个可替代的零件，”她停下来，喝了一口已经凉透的咖啡，眼神暗淡了一瞬，“但对着镜头……我会感觉我就是主角。哪怕只有十五分钟，我也想活得像杂志上的人一样。”" },
            'd7_c': { day: 7, title: "D7-C 与生活家塞恩见面", text: "塞恩坐在广场干涸的喷泉池边，手里捧着一个贴满贴纸的弹珠盒子。“小时候，就在这儿。我和汤米，还有鲍勃，放学后玩弹玻璃珠。弹珠总掉进下水道里，我们猜想下面肯定有个闪闪发亮的秘密王国，”他说，“那时候我根本想不到，我会成为一个无聊的、一事无成的中年人，日子像弹珠一样，一颗、一颗，从指头缝里漏下去，掉进下水道里。而那里根本没有什么闪闪发亮的王国。”\n他看看你，又看看天空。“我曾经很想要离开这里，”他说，“但所有人都说，能够在弧光镇生活是一种幸运。没有人会走——甚至死人也不会。我没有勇气放弃这种‘幸运’，但我至少可以换一种方式生活——所以我想试试竞选那个生活家。听起来有点傻，是吧？但这给了我一个机会，让我有勇气向我想做的事情迈出一步。”" },
            'd7_d': { day: 7, title: "D7-D 艾伦的新发现", text: "“嘿，今天我们有很多收获！”艾伦看到你，开心地扑了上来，你也把自己的发现告诉了丽莎和艾伦。“天呐，这就对了！”电波那头，丽莎的声音颤了一下，然后猛地拔高：“对了……这就全对上了！弧光镇，月湖镇——本来就是一回事！”\n艾伦用力点头：“镜湖……月亮女神的镜子！镜子照见的当然是月亮……”\n“但如果是这样的话，丽莎为什么无法过来找到我们？”你疑惑地说。\n“月湖镇……的确是被封死了。有很多人把守，根本不可能出入，”丽莎说，“至于弧光镇，我从来没有听说过……”\n“但我们这儿有路！”艾伦抓过一张纸，手指在上面飞快地移动，勾勒出小镇边缘的形状，然后勾出一条笔直的线，“你看，从镇南公路出去，一直开……告诉我你在哪儿，丽莎！我明天就去找你！”\n“太好了！我的位置，大约在靠南侧的镇公路延长线外120公里。这里是离月湖镇最近的大型加油站，非常好辨认，”丽莎说，“见面之后，或许很多谜题就能够解开了！”" },
            'd7_e': { day: 7, title: "D7-E 贝格女士的湖区神秘仪式", text: "镜湖的水面平静得如同一块巨大的铅灰色玻璃。岸边聚集了二十几人，湖面反射着他们的影子，看上去像是来自另一个世界的居民在和他们打着招呼。\n你看见他们纷纷伸出右手，对着天空祈祷。“那些星星，正在向我们飞来。它们接纳着所有人……接纳所有的孤独、悲伤、愤怒、不甘……”贝格女士一袭红衣，站在他们之中非常显眼。当你观察她时，她的视线穿透微微带着芳香气味的空气，锁定了你藏身的那块石头。\n一阵寒意顺着脊椎爬上来。" },

            // DAY 8
            'd8_a': { day: 8, title: "D8-A 莫里斯与加里", text: "“亲爱的居民们，”莫里斯镇长旁边和加里先生像两尊笑容完美的雕像。“我们小镇的荣誉历史，由每一位居民们构成，今天，我们隆重向大家宣布，我们将启动‘纪念碑计划’，复制下您独一无二的记忆。就像我们正在推进的归返者计划一样——让熟悉的面孔和温暖的记忆，能够一直留在它们深爱的社区，以另一种形态发光发热，”\n 莫里斯脸上洋溢着一种混合了牧师与推销员的神情，“这项服务完全免费，完全自愿。而我们弧光镇，将成为人类历史上，第一个真正战胜了遗忘与别离的美丽家园。”" },
            'd8_b': { day: 8, title: "D8-B 黑星医院建造生物研究中心", text: "医院附近，原本是墓地的地方被围挡圈起来，仅仅露一个小口子。莫里斯就站在那口子前面继续他的发言：\n“一个好消息！我们不再需要墓地了，从此以后，迈入死亡这一中转站的居民，身体将暂存在这里。我们将使用最先进的技术保存好您的生物组织。与思维进行连接和适配之后，您就可以以归返者的身份回到社区当中。”\n他拉开幕布——这种时刻，总会有一个欲盖弥彰的幕布——然后他说：“公墓，将被改建为黑星医院附属建筑，它也迎来了一个新的名字：生物延续与社区记忆研究中心。”\n“但是，”一位居民不安地绞着手指，“公墓里埋着的人去哪儿了？”\n“哦，或许你会在今后的日子里不断看见他们。”另外一位居民说。" },
            'd8_c': { day: 8, title: "D8-C 《幸福回环》观影现场", text: "你到达电影院的时候，电影正在放映高潮片段：主角为了不再痛苦，自愿躺上手术台，切除了所有关于“离别”的记忆。\n影院里鸦雀无声。灯光亮起时，周围的观众脸上挂着泪痕。" },
            'd8_d': { day: 8, title: "D8-D 归返者护士", text: "日光商厦一楼中庭，临时搭建的讲台上铺着暗红色绒布，背景板印着“黑星医疗——关爱社区，科技先行”的标语，下方是镇长莫里斯与加里先生的烫金签名。现场聚集了不到五十人，多是商厦顾客和工作人员。台侧的归返者们戴着护士帽、抬着担架，样子滑稽的很。\n“我的老查理！”一位老太太惊叫起来。\n“嗯，是的，这次我们请到的归返者是去年去世的查理先生，前年去世的艾琳女士，还有大前年去世的劳伦斯先生，”加里先生心不在焉地介绍道。老太太疑惑地走上前抚摸查理先生的脸颊。\n很快，仪式在又一轮稀稀拉拉的掌声中结束。技术人员开始让归返者模拟喷洒消毒液、测量体温等工作，老太太自告奋勇地配合着，她脸上的表情开始从疑惑转变为欣喜。围观人群逐渐散去，只有几个孩子好奇地围着归返者打转，父母们则像触电一样，迅速且坚决地将孩子们伸出的手指拨开。" },
            'd8_e': { day: 8, title: "D8-E 病人采访", text: "不像前几日的混乱，黑星医院现在恢复了往日的秩序，并且，安静得有些诡异。\n你放慢脚步，目光扫过几间病房。瞥见的景象几乎相同：无论病患是骨折卧床、感冒发烧，还是面色苍白地呆坐，穿着浅蓝色制服的归返者——查理、艾琳和劳伦斯，都会在完成基础检查后，托着一个标准托盘靠近——上面是一杯水，和一颗独立包装的淡蓝色药片。\n你很快认出，那是新发售的“好睡片Plus”。" },
            'd8_f': { day: 8, title: "D8-F 药物试验及其他报告", text: "你把最下层那一排被灰尘和蜘蛛网罩着《军事月刊》杂志全都翻了出来。很快，你辨认出了电话中所说的那几页特别的文件。\n《月湖镇瀑布谷区域补强报告（节选）》\n1959年3月，第四工程队\n瀑布谷区域严格执行修整工程，以旅游景观优化名义进行填埋、地表提升、坡面重塑与结构稳固。\n做好保密工作并在████后立即执行。\n《代号M药物评估摘要》\n主要成分为改良的LSD-25衍生物及定向幻觉诱导剂，副作用为引发具象的“不明飞行物”或“异常光团”视觉报告。\n《遣散令（机密）》\n月湖镇封存前的最后一批命令\n（1958 年12月12日）\n自本命令下达之时起，相关工作人员须在 30 日内彻底搬离。\n过程不得公开宣布。不得以任何形式告知居民。\n离开后，不得以个人名义返回，不得组织重聚。\n自封存日起，该区域的后续重建将以“弧光镇”申报规划，\n任何文件、档案，不得再次出现“月湖镇”字样。" },

            // DAY 9
            'd9_a': { day: 9, title: "D9-A 归返者滥用止痛剂", text: "医院又一次陷入混乱。一个女人，正试图冲向老年归返者查理。归返者身前，挡着一位老太太，她把拐杖横在胸前。“谁也不许动他！”老太太的声音尖利，“他是我老伴！是医院……是医院还给我的！”\n“这就是个凶手！”女人的声音撕扯着空气，“我妈！就换了块膝盖骨！她昨晚睡得好好的！那东西，”她愤怒地指着归返者，“大晚上溜进来，对着她胳膊就一针！现在呢？我妈……我妈根本叫不醒了！”\n“监控录像显示，她傍晚私自吃过一颗好睡片，”一名医生满脸愧疚地说道，”按理说，这老先生没做错什么……“ \n“听见没？！”老太太的拐杖敲打着光滑的地砖，“他是按规矩做事！就像他活着的时候一样，做得比谁都仔细！”\n女人再也忍不住了，她像一根被拉得过长的橡皮筋，猛地弹射出去，扑向沉默的“查理”，手指狠狠抠向那张脸。\n嗤啦——破损的脸颊下，一小块暗绿色的电路板露了出来。\n老太太举着拐杖的手，顿时僵在半空。" },
            'd9_b': { day: 9, title: "D9-B 梅尔维尔遭窃", text: "当你到达松鼠旅社时，几个穿制服的人站在那里，问话的声音拖得很长，阴阳怪气的，“就一盒照片是吧？嗯。我们会留意的，”说罢，问话者打了个哈欠。\n“只是一盒照片！只是一盒照片！天杀的……”梅尔维尔气得拍着大腿站了起来，他踉跄一步走上前去，几乎贴着那位警员的鼻尖吼着：“那是我妈留给我的最后一沓照片！”\n警员往后缩了缩，脖子埋进衣领，无奈又敷衍地说道：“行，行，您别激动，我们找，一定找。不过，是不是您自己放哪儿给忘记了？您看您这岁数……”\n“我这岁数？！”梅尔维尔的眼睛瞪得溜圆，“我的脑袋灵光得很！不像你肩上那个，就是个摆设！”文森特赶紧拍拍他的背。\n不一会儿，警员们都走了。文森特凑过来和你说：“我看这事，绝对和你最近的报道有关系，有些人不想让我们查下去。“" },
            'd9_c': { day: 9, title: "D9-C 森林派对的邀请", text: "西比尔递给我的木杯里，盛着某种用野果发酵的、色泽浑浊的酒。篝火把每个人的脸映得明暗不定，影子在身后拖得老长，随着火焰的节奏狂舞。“为每一位到来的家人！”贝格女士站起身，她的红裙子比火光更亮。她高举木杯，声音洪亮、热情，周围的“家人”们立刻爆发出应和的欢呼。\n“噢，我们这位小道消息专家也来了，”贝格女士意识到了你的存在，“据我们这位专家所说，UFO的存在是药物的副作用。多么荒唐！伟大的希斯女士——我的母亲，作为火炬生物研究所的所长，她研制出的对抗负面情绪的稳定剂，绝没有任何副作用！这一伟大创举已经成为世界抗抑郁特效药的第一专利。”\n“所以，我们这位小小阴谋家，找找图书馆的报纸来读吧，”贝格女士的嘴角挂着嘲讽的笑容，“虽然母亲已经退休多年，但如果你稍微做一点功课，就不会把那些陈词滥调的谣言当作新闻了。”" },
            'd9_d': { day: 9, title: "D9-D 杰弗里院长曝光药物实验", text: "医院门口被看热闹的人堵得水泄不通，人们脸上尽是不知所措的表情。\n杰弗里院长在混乱的候诊室，拿起喇叭广播。\n“居民们！听我说！立刻——马上——停止服用‘好睡片’和所有医院提供你们的、标签不明的药片！”她的声音因激动而颤抖，“还免费医疗……你们知道这钱是怎么来的吗？莫里斯和加里……他们拿你们当小白鼠，测试病毒、测试新药，然后呢？现在连死人都要回收再利用啦。”\n几名便衣挤过人潮，将她按倒在地，杰弗里挣扎着，抬起头继续说着：“没人记得40年前大街上流着口水、见人就咬的丧尸吗？噢对！当然不会有人记得！因为所有知情的人都埋在秃山底下了！”" },
            'd9_e': { day: 9, title: "D9-E 杰弗里院长被逮捕", text: "杰弗里院长被架离现场时，身后留下一片狼藉——翻倒的座椅、扯断的布条、以及地板上几处清晰的拖拽痕迹。归返者们队列整齐地进入现场。他们高效地归位物品、擦拭地面。人群尚未从这场突如其来的风波中回过神来，他们呆立在逐渐恢复秩序的大厅里，彼此交换的眼神中，除了震惊，更充斥着一种深切的迷茫。" },

            // DAY 10 (NEW)
            'd10_a': { day: 10, title: "D10-A 中心广场抗议活动", text: "人群聚集得比你预想的还要多，像是一场悄然发酵了数月的怨气终于找到了出口。\n“说什么战胜遗忘与别离……全都是胡扯！那些死人，就是一群套着人皮的机器，”一名年轻男性挥舞着拳头，“不吃饭、不睡觉、不生病，更妙的是，不要求休假和涨薪！你们是不是觉得，我们这些活人，不如插上电就能干活的死人好用？！”\n“还有，凭什么我们活着给你们干活，连死了都得被你们从土里拽出来，安排去便利店、去扫大街？！我们欠你们的吗？”" },
            'd10_b': { day: 10, title: "D10-B 镇长记者会", text: "莫里斯镇长站在发言台后，双手紧紧按在讲稿两侧，指节因用力而微微发白。\n“关于……近期的一些声音。”他停了一下，眼珠子从左转到右，扫过台下愤怒的脸庞，“我，代表镇议会，现在要说几句。”\n“第一，”他竖起一根手指，“杰弗里院长说的所有事，都和我们没有关系。至于丧尸的谣言，四十年前，不知道大家怎样，反正我是不在场。谁相信这些，我怀疑是电影看得太多了。”\n“第二，”他竖起第二根手指，和第一根并在一起，像两根苍白的小蜡烛，“关于归返者。我知道大家有看法，但技术是中立的。有争议，是的。可我们也看到，很多家属不愿意亲人再次被埋进土里。”\n“居民的福祉是我们唯一关心的问题。所以，从这一刻起，归返者的管理权，我们会移交到社区。归返者是回自己家，还是留在公共岗位帮忙，都由家属和邻居们……你们自行决定 。”" },
            'd10_c': { day: 10, title: "D10-C 达文虎克的发现", text: "“你想先听好消息还是坏消息？”达文虎克神情严肃地说。\n“好消息是，观景台那台老古董发射器，功率比我想的还高。稍微调一调，甚至能把咱们这儿的事当广播剧，送到其他州的业余无线电爱好者耳朵里——只要不被发现的话。”\n“那坏消息呢？”你问。\n“坏消息是，我还追踪到了……有一个加密方式很复杂的数据流，一直在朝天空发送信息……更邪门的是，”他把印着波形图的本子递给你看，“它和‘流星’的波形，在时间轴上，严丝合缝地对上了。”\n他深吸一口气，继续说道：“我们看到的‘流星’，是专门为了和观景台对接数据才划过小镇上空的。”" },
            'd10_d': { day: 10, title: "D10-D 梅尔维尔的地图", text: "你到达旅社，文森特示意你坐在他旁边。随后，梅尔维尔掏出一份地图，他指了指上面一处勾画的痕迹：“这里，妈妈画的。1937年那次大洪水，我们跟着政府迁到了这里。仅仅待了不到一年，我们就去哈利姆投奔我姑妈去了。姑妈家非常富有，不介意资助我们一家三口在那里重新开始。”\n“爸爸生病的时候，妈妈一度想回来，因为她听说，得病的人能够在这儿受到很好的照料——只要签署一些文件就行，”梅尔维尔说，“但是爸不愿意回来，他说，宁愿得病死掉，也不愿意相信那些大公司的走狗，”他顿了顿，“再后来，这个地方，就从地图上彻底消失了。”\n“但是梅尔维尔的母亲还记得，”文森特说，”他也是因为这份地图上的标记，才找到咱们这里的。“\n“地图、邮件，”你转向他，“你还记得之前错收信件的事情吗？”\n“对啊……如果小镇不在地图上，那么邮件是怎么被寄过来的呢？你想说的是这个吧？”文森特很快明白了你的意思，“四点以后，咱们一起到中心广场旁的邮政总局看看。”" },
            'd10_e': { day: 10, title: "D10-E 邮件中转站真相", text: "邮政机器人有条不紊地将邮件分门归类，屋里安静得只能听到纸张摩擦的声音。\n你和文森特溜进了邮政中心的后台，在一排标着滞留件的金属柜前翻找。那些广告传单和过期账单，无一例外，弧光镇的名字全都用缩写表示。这是从很久之前就沿袭下来的不成文的规定。但你们还是发现了一些端倪。\n“有了，”文森特说，“这个名字，月光溪谷，我之前也见过。”\n“是的，月光溪谷，它就是弧光镇的影子社区。所有进出的邮件，都要先被发送到月光溪谷这个不存在的地点，经历一次查无此人的官方判定，然后才被秘密转运进来，所以邮件普遍会迟到，不了解这件事的邮递员会搞错邮戳。\n“的确，”文森特说，“我们生活在一个不存在的小镇上。”" },
            'd10_f': { day: 10, title: "D10-F 幽灵丽莎的新消息", text: "艾伦见到你，像抓住救命稻草一样扑过来，“这几天……太可怕了，病毒、回归者、杰弗里院长……我现在都不知道该相信谁了。”\n他语无伦次，但很快强迫自己转向那台改装过的、连着麦克风的无线电设备，深吸一口气，按下了通话键。“丽莎？丽莎，你能听到吗？是我们！我和……我们都在这里！”\n短暂的电流杂音后，丽莎的声音传了出来：“是的……我能听到。艾伦……我前两天……被他们逮捕了。因为你说你已经到了我的位置附近，但我这边什么都没看到……我太着急，就想直接去找你们……”\n她的声音低了下去：“但我发现，路依然是封死的。我想从旁边的山坡爬过去……然后……就被人按住了……今天早上……把我扔在路边，警告我再靠近就‘后果自负’。但我偷听到他们用对讲机说话的片段……”\n她深吸一口气，传来的声音带着令人毛骨悚然的寒意：“他们……将要填埋所有月湖镇的活口。”\n“等等，丽莎，现在是哪一年？”你声音发抖。\n“1959年，怎么了？”丽莎不解地问。紧接着，艾伦发出了一声短促的尖叫。\n“我们这里是1995年，”你回答。" },

            // DAY 11 (FINAL)
            'd11_a': { day: 11, title: "D11-A 议员的自白", text: "一位年长的女士在等你。她坐在小花园的长椅上，膝上放着一本合着的皮面笔记。“以下我说的这些话，只是为了和你解释前因后果，如果你将播报这些信息，希望你隐去我的身份，”她用力抠着笔记的封皮，指甲里镶进几片小小的碎屑，“我是镇议会的成员，曾经和希斯女士一起参与小镇的重建。我知道一些……秘密，”她沉默了一会儿，“萨曼莎·贝格，不是希斯的亲生女儿。她是月湖镇清理行动中被留下来的婴儿之一。”\n“作为萨曼莎的监护者之一，我对这孩子产生了感情。我看着希斯收养她为女儿，让她经历刻意设计的分离和恐惧情境，用来测试二代安慰剂……这一切都让我很煎熬。1968年前后，希斯女士因为晋升和调任离开弧光镇，”她顿了顿，继续说，“走之前，她对萨曼莎说，只要她做个好孩子，帮助其他小伙伴们过上幸福和充实的生活，总有一天会回到她身边。当然，这是不可能兑现的承诺。”\n“现在说出来这件事，是因为我觉得，加里先生——我名义上的上司、现在小镇实际的掌权人，正在把最近从废弃实验室里发现的剩余初代安慰剂提供给萨曼莎。”\n她沉默了两秒，继续说道：“你还记得，镇上发生一起运输车泄露事件吗？那是我出的纰漏，本来应该悄无声息地运出去的。这些安慰剂远不如萨曼莎小时候用的那些温和，轻度使用者会看见不明光晕，重度使用，会彻底破坏中枢神经，变成他们口中的‘丧尸’。”\n“这就是1959年发生的事故真相，”她说，”不管怎样，我不想萨曼莎和那些无辜的居民重演那段悲剧了。”" },
            'd11_b': { day: 11, title: "D11-B 杰弗里的手迹", text: "几张揉皱的纸递到了你的手上。\n实验阶段演进与现状：\n第一阶段（至1950年代末）：精神化学干预探索\n项目简介：基于希斯博士早期引入的LSD衍生物，进行群体性意识影响测试。\n项目结果：药物引发的精神反应呈现高度不可预测性与极端行为风险。于1959年正式终止。原始化合物封存。\n第二阶段（1960年代至今）：精神药物市场化与公共卫生压力测试\n项目简介：一期项目数据已被用于开发副作用更小的化合物。最终成果即目前通过合规渠道上市的“好睡片”初代产品。本镇居民为首批长期服用的群体，提供上市后的真实数据。\n并行启动项目a：代号T22计划。在本镇封闭环境内，模拟并研究特定病原体的传播模式、社区免疫反应及药物干预效果。\n风险：T22计划存在低概率但不可忽视的失控可能。已出现数起非预期交叉感染及症状加剧的案例。\n并行启动项目b（杰瑞米·加里主导）：利用生物电机强行启动塑化的人体组织。实现体/脑再利用。\n\n底下有一行颜色淡得几乎看不清的小字：\n本镇的基础设施、公共服务薪酬等，皆来自火炬生物科技和关联的空壳公司的捐赠，黑星医院和镇议会都是其直接下属机构。医院对所有登记居民提供低于市场价格的医疗服务，确保全体居民健康数据强制入库。\n\n我曾自欺欺人地认为，这一切都是等价交换，居民们付出一些，再得到更多，这无可厚非。但加里先生主导的“归返者”项目，彻底颠覆了我的认知。\n这种荒唐的事情，我没法忍受下去了！" },
            'd11_c': { day: 11, title: "D11-C 截获加里先生的通讯", text: "艾伦用一种绝望地眼神看着你，“我们都要死了！”他尖叫道，“我们都要死了！你、我！我爸我妈！达文虎克！我们都要死了！”\n他按下录音机的播放键。\n录音记录片段：\n“莫里斯。第一阶段数据回收已完成。你我都清楚，这代表什么。”\n“我们一定还有其他办法……求您……”\n“我理解。你的整个职业生涯都绑在这里。现在这种情况，你肯定不好受。”\n（短暂的静默）\n“但时代变了。互联网，莫里斯。这个词你该多念几遍。它意味着信息会像霉菌一样，在我们看不见的角落疯长。这里的居民，哪怕只有一个，把归返者、好睡片这些词儿捅到一个该死的论坛上去……希斯时代那些烂账，瀑布谷填埋层里横七竖八的尸体……我们做的每一件事，都会在二十四小时内，变成全球性新闻头条。”\n“我们可以不去接入什么互联网……我们可以颁布法令禁止大家谈论这些东西……”\n“噢，越禁止，越吸引人。你还不懂这个道理吗？”\n“可是……”\n“没有可是。你唯一能保全他们的办法，就是让他们尽快参与纪念碑计划。这一部分居民，因为有研究价值，公司会保下他们。至于其他人……“\n（停顿）\n“我们只能遗憾地放弃。资源是有限的，莫里斯。”\n“可是我……”\n“要怪就怪杰弗里吧。如果不是她非要玩鱼死网破的游戏，总部或许还会让这里再多维持个一两年。”\n（录音结束）" },
            'd11_d': { day: 11, title: "D11-D 最后一次广播", text: "你和艾伦匆匆赶到深空观景台，你们看到达文虎克正在调试那台生锈的发射器，“嘿，你们来了，正好！”达文虎克问，“刚才电话里你说要把什么播出去？”\n“我们都要死了！米米失踪了！”艾伦尖叫道。你花了一分钟时间，迅速把今天发生的事情一股脑告诉达文虎克。来不及等他消化这些噩耗了，你继续说：“我不知道他们会什么时候动手，但我想拼一把。”\n“这里的事情，一定要传出去！”达文虎克焦急地说着，“我们可以利用这台机器把你的信号放大，通过他们的卫星转发出去。”" }
        };

        const recipes = [
            // DAY 1
            { day: 1, inputs: ['d1_a', 'd1_b'], news: { id: 'n1_statue', title: "镇长为中心广场剪彩", type: 'big', text: "今天，被丑陋的围挡封锁了足足5个月之后，我们的中心广场重见天日！以后终于可以在翘班时去广场上喂鸽子了。\n不过，显然，镇长找来的施工队伍似乎出了一点差错，如果你仔细观察，我们伟大的创始人希斯女士的雕像，头颅被换成了一个极其抽象的玩意。要我说，虽然没人见过希斯女士，但她绝对不是长这样的。" } },
            { day: 1, inputs: ['d1_c'], news: { id: 'n1_lemon', title: "空气中异常柠檬香", type: 'small', text: "今日，回声公寓楼附近的空气中出现无法解释的柠檬香气。这似乎与某种液体泄露的情况有关，它会让人产生短暂的眩晕或记忆断片——就像你盯着一个词看太久，脑子突然短路了一样。症状很快就会消失，如果您恰好路过，请不要惊慌。" } },
            { day: 1, inputs: ['d1_d'], news: { id: 'n1_begg', title: "贝格女士神秘读书会", type: 'small', text: "贝格女士的读书会宣布升级为夜间活动。不再有枯燥的文字阅读，取而代之的是深度的心灵链接。这或许是失眠者的福音，又或许，我们终于找到了比睡眠更高效的逃避现实的方式。" } },
            { day: 1, inputs: ['d1_e'], news: { id: 'n1_ufo', title: "小镇能否重现40年前的荣光？", type: 'grey', text: "今晚，一些居民在中心广场上空目击了不明光团。这一现象与40年前使本镇闻名遐迩的“UFO目击事件”惊人相似。\n正是这些神秘的光团，吸引了第一批好奇的游客与投资者，为弧光镇的发展奠定了最初的基础。这是否预示着我镇旅游业将迎来新一轮的机遇？抑或是某种我们尚未理解的、周期性出现的自然现象？无论真相如何，今夜的中心广场无疑被注入了一丝怀旧与神秘交织的色彩。许多年轻人是第一次亲眼目睹这一奇观，而老一辈则陷入了对往昔的回忆。\n小镇的荣光岁月，会随着UFO传说而重现吗？" } },

            // DAY 2
            { day: 2, inputs: ['d2_a', 'd2_b'], news: { id: 'n2_mail', title: "邮政投递大乌龙", type: 'small', text: "我们的邮政系统出现罕见错件潮，一些寄往“回声公寓楼”的邮件被误投至“松鼠旅社”。\n初步调查显示，是由于中转站的存在，导致地址和邮戳被重复印刷所致。" } },
            { day: 2, inputs: ['d2_c', 'd2_d'], news: { id: 'n2_crash', title: "喷气式自行车连环事故", type: 'big', text: "今晨，阿卡姆集市发生了一起别开生面的交通事故。四名骑手在事故发生的瞬间选择进入战略性休眠。“他们睡得很安详，”现场处理事故的交警表示。" } },
            { day: 2, inputs: ['d2_e'], news: { id: 'n2_meteor', title: "夜空划过神秘流星", type: 'grey', text: "昨夜，一颗巨大的流星划过深空观景台上空。虽然大多数人都错过了它，但它确实发生过。就像这个镇上的许多秘密一样，无论是否被看见，它们都在燃烧。" } },
            { day: 2, inputs: ['d2_f'], news: { id: 'n2_dead', title: "死者回到镇上", type: 'big', text: "今日上午，已故三年的居民杰米·霍顿出现在中心广场，引发广泛恐慌与困惑。这位前锁匠的“回归”方式，挑战了我们关于生命与死亡的常识。是恶作剧还是奇迹？本台会跟进报道。" } },

            // DAY 3
            { day: 3, inputs: ['d3_a', 'd3_b'], news: { id: 'n3_oldman', title: "瀑布谷与神秘老者", type: 'small', text: "今日，有居民来电称一位穿格子衫、戴遮阳帽的老人在街上游荡。\n他古怪的行为让很多居民感到害怕。松鼠旅馆的文森特表示，这位老人叫做梅尔维尔，他没有恶意，只是耳背，并且有点老糊涂了。他在寻找一个叫做“瀑布谷”的地方。如有听众知道线索，欢迎来电。" } },
            { day: 3, inputs: ['d3_c'], news: { id: 'n3_movie', title: "《灾变21天》引爆观影狂潮", type: 'grey', text: "今日，《灾变21天》在居民们的殷切期待中上映。影片虚构了一场席卷全球的丧尸病毒危机，聚焦一群幸存者在废墟中挣扎求生的21天。电影逼真的特效与音效让观众身临其境，尖叫与抽气声不绝于耳。\n有观众坚称，片中有个一闪而过的街角，与镇西边一个岔路口看起来一模一样。是巧合吗？这个疑问，或许相比于那些行走在街道上的死者来说微不足道，但它也同样需要一个答案。" } },
            { day: 3, inputs: ['d3_d', 'd3_e'], news: { id: 'n3_begg_hug', title: "贝格女士的星芒疗愈派对", type: 'small', text: "贝格女士的夜晚疗愈派对，在布置温馨的私密空间进行。参与者在柔和的灯光与自然香氛中，通过引导冥想放松身心。当然，这里少不了拥抱与倾听，像贝格女士所说，我们每一个人都有释放脆弱的权利。这样的场合，尤其适合摘下社交面具、并把它扔到地上踩上两脚。今夜不做父亲，不做母亲，不做老好人和好员工，今夜只允许自己做自己。" } },
            { day: 3, inputs: ['d3_e'], news: { id: 'n3_elevator', title: "电梯灵异事件", type: 'grey', text: "日光商厦近日已发生多起职员被电梯门夹住的情况，事件多集中于晚间加班高峰时段。而相关技术人员表示，电梯作为标准化设备，不存在情绪波动，也不会因工作时长产生怠工或罢工行为，若发生夹人情况，多半是因为职员未能及时适应系统运行节奏。" } },

            // DAY 4
            { day: 4, inputs: ['d4_a'], news: { id: 'n4_mayor', title: "死者归返声明", type: 'big', text: "今日，莫里斯镇长对于逝者归返现象发布声明，声明对这种现象本身没有任何解释，仿佛我们身边发生的这一切都理所当然。和电影院那些打着惊悚旗号的影片不同，我们目睹死者行走，却连一声完整的惊叫都发不出来，不仅如此，我们还要去拥抱这种“新常态”。难道，我们必须要接受，我们的家园就是如此不同？" } },
            { day: 4, inputs: ['d4_b', 'd4_c'], news: { id: 'n4_ice', title: "软巧冰淇淋巡回售卖", type: 'small', text: "生活那么苦涩，你需要一点甜。知名品牌软巧冰淇淋流动售卖车今日在我镇巡回售卖，相信很多居民都已经品尝过美味了。不知道下一次活动将在什么时候举行，但如果有可能，适度增加几个临时站点，或许会让更多居民体验到这份轻盈的甜蜜。" } },
            { day: 4, inputs: ['d4_d'], news: { id: 'n4_lisa', title: "广播站截获神秘信号", type: 'small', text: "近日有无线电爱好者截获了一段神秘讯号，源头无法追踪。我们试着与对方交谈，得知电波那头有位叫丽莎的女士，好像正在调查一起事故。由于信息过于模糊，更进一步的消息有待调查。" } },
            { day: 4, inputs: ['d4_e'], news: { id: 'n4_dream', title: "二手店收购噩梦", type: 'grey', text: "近期，有居民反应在集市角落一家书店听到令人感到恐怖的字眼。事实上，店主正在做出售噩梦的生意，他把收集来的噩梦写成单页故事，出售给那些觉得生活太无聊、想找点刺激的年轻人，价格按惊悚程度计算。" } },

            // DAY 5
            { day: 5, inputs: ['d5_a', 'd5_b'], news: { id: 'n5_dog', title: "怪狗目击事件", type: 'grey', text: "有居民在帷幕图书馆附近目击到一只外形奇特的狗。这只狗身体极短，仿佛头和臀部直接相连。这或许是某种罕见的基因突变。幸好，它并没有什么攻击人的欲望，顶多也就是在阴影里翻翻垃圾而已。在这样一个和谐、包容的小镇，我们不会因为它特别的长相而驱逐它，不是吗？" } },
            { day: 5, inputs: ['d5_c', 'd5_d'], news: { id: 'n5_returner', title: "归返者走进便利店", type: 'big', text: "归返者们——我们生命中曾经出现、现在依然在出现的人，正在进一步融入我们的生活。显然，他们的记忆证明着他们的身份，至少证明着他们与那些离我们而去的脸庞之间，存在着某种确凿的关联。我们需要欢呼吗？弧光镇，你打算就此抛弃掉死亡吗？" } },
            { day: 5, inputs: ['d5_e'], news: { id: 'n5_lisa_ghost', title: "幽灵丽莎神秘频段", type: 'small', text: "今日，电台捕获了一个女人幽灵般的声音。她自称丽莎，在寻找一个叫做月湖镇的地方，以及一个在那里失踪的、相信UFO存在的男人。我们无法验证她描述的灾难性场景是否真实，因为，我们也有属于我们自己的灾难需要面对。\n希望月湖镇的居民，还有丽莎女士的朋友都能够平安，让我们一起为所有人祈祷吧！" } },
            { day: 5, inputs: ['d5_f'], news: { id: 'n5_capsule', title: "时光胶囊寻找主人", type: 'small', text: "近日，有热心居民发现一个“时光胶囊”，里面有许多玩具和一本保存完好的旧日记。日记内容记录了多段发生在上世纪五十年代的日常生活片段。日记的主人叫做诺玛，她的两位好友叫做珍妮和安，她们在1958年一起埋了这个盒子。\n若有居民恰好认识诺玛、珍妮和安——哪怕只是听奶奶讲过“从前镇上有三个疯丫头”的那种故事——欢迎与广播站取得联系，我们将协助盒子回到它的主人手中。" } },

            // DAY 6
            { day: 6, inputs: ['d6_a', 'd6_b'], news: { id: 'n6_locks', title: "免费换新电子锁", type: 'small', text: "今日，便民电子锁更换正式开始启动。居民只需签署一份简单的安装同意书，便可在当天完成更换。更换并非强制，但未安装新系统的住户，在未来如遇财产损失，将不在保障范围内。\n一些居民对电子锁自动更新和偶尔莫名的闪光感到疑惑，相关人士称这些为正常现象。" } },
            { day: 6, inputs: ['d6_c'], news: { id: 'n6_photo', title: "秃山禁区曾为露营地？", type: 'small', text: "一张老照片，揭示了一个令人费解的事实：小镇南部的禁区秃山，在“禁止入内”的牌子竖起来之前，在那里的石头学会伤人之前，人们曾带着三明治和毯子，去那里度过一个下午。他们管它叫瀑布谷。这些年到底发生了什么？是什么夺走了我们休闲娱乐的胜地？欢迎广大居民打来热线提供线索。" } },
            { day: 6, inputs: ['d6_d', 'd6_e'], news: { id: 'n6_illness', title: "突发疾病原因疑为软巧冰淇淋", type: 'big', text: "黑星医院今日接收大量儿童患者和少部分成年患者，症状惊人一致。尽管官方尚未给出明确诊断，但多名家长指出，患儿均在发病前食用过近日巡回售卖的“软巧冰淇淋”。杰弗里院长或对此事知情。截至报道时，还没有人正式站出来解释这一切。" } },
            { day: 6, inputs: ['d6_f'], news: { id: 'n6_camp', title: "林区避世桃源", type: 'grey', text: "近日，林区出现一个由十余位居民组成的营地，该营地由读书会创始人贝格女士招募，尽管生活条件简朴，但该社群已形成稳定的内部规则：每日轮流负责炊事、采集与缝补，决策由全员投票决定。这里没有追着屁股跑的绩效，人们在篝火的噼啪声中，重建着最原始的信任纽带。" } },

            // DAY 7
            { day: 7, inputs: ['d7_a'], news: { id: 'n7_history', title: "小镇不为人知的过去", type: 'big', text: "不久前我们才知道，秃山原来叫瀑布谷，那里曾经装满了野餐垫和孩子的笑声。而现在我们发现，就连让我们引以为傲的镜湖，或许也曾有过另一个名字。秃山忘记了瀑布，镜湖忘记了月亮。那我们呢？我们忘记了什么？" } },
            { day: 7, inputs: ['d7_b', 'd7_c'], news: { id: 'n7_life', title: "青年生活家宣言", type: 'small', text: "我们镇子最近举办了一场有点特别的比赛。他们管它叫“小镇生活家”竞选。听起来就像是在选举“如何过日子”这件事上的模范生。\n很显然，我们的居民中已经有几位先锋生活家找到了自己的方向。从时尚穿搭到弹珠游戏开发，本镇青年正在用自己的方式诠释生活的意义。如果您对他们理念产生兴趣，请不要吝啬您的夸赞，积极和身边的人参与互动、讨论，投出您宝贵的一票！" } },
            { day: 7, inputs: ['d7_d'], news: { id: 'n7_ghost', title: "谁才是幽灵？", type: 'small', text: "近日，有关我台收到的神秘电波，这名叫做丽莎的女士似乎无意间透露了小镇不为人知的历史，\n但令人尴尬的是，她竟然从未听说过“弧光镇”这三个字。长久以来，我们亲切地称她为“幽灵丽莎”，可如今看来，在她眼中，说不定整座小镇才是幽灵。\n此刻，我们正积极整理资料、核对地图，并计划给丽莎女士带去一份《弧光镇旅游指南》和最近一期的镇办报纸，希望向她证明一件事：这里有人，有路灯，有快递，每周二垃圾车还会准时经过——我们真的存在，我们不是幽灵。" } },
            { day: 7, inputs: ['d7_e'], news: { id: 'n7_ritual', title: "避世桃源，还是危险崇拜？", type: 'small', text: "今日晚间，镜湖附近，读书会组织者贝格女士带领众人对着湖面做出统一的动作、念着晦涩的祷词，这到底是个什么样的聚会？贝格女士把这些感到孤独、或者心里破了洞的人聚在一起，给他们念诗，给他们拥抱，现在又带他们来湖边，把手伸向并不存在的星星——她究竟想从人们心底打捞出什么？本台将继续观察。" } },

            // DAY 8
            { day: 8, inputs: ['d8_a', 'd8_b'], news: { id: 'n8_monument', title: "纪念碑计划", type: 'big', text: "今日，本镇议会正式公布了引发广泛争议的纪念碑计划。公墓也将归于黑星医院管辖。从此以后，黑星医院不仅是您孩子打疫苗、您自己治感冒、您祖母做理疗的地方……还顺便兼管您最后的启程。我们的医疗系统真正做到了从生到死一条龙服务，再也不用为人生大事东奔西跑啦！" } },
            { day: 8, inputs: ['d8_c'], news: { id: 'n8_movie', title: "用遗忘换取幸福，你愿意吗？", type: 'grey', text: "奇幻爱情片《幸福回环》今日上映。影片提出了一个大胆的假设：如果切除痛苦的记忆能换来永恒的幸福，你愿意吗？电影很精彩，观众们泪流满面地证明了这一点。\n不过，不知道是不是我的错觉，最近很多正在发生的事情，都跟倒腾我们的脑子有关。我坐在电影院的软椅上，看着一个虚构的故事，却忍不住摸了摸自己的后脑勺。嗯，还好，那里现在还是完整的。" } },
            { day: 8, inputs: ['d8_d', 'd8_e'], news: { id: 'n8_nurse', title: "归返者护士滥用好睡片", type: 'big', text: "您是否注意到，最近黑星医院的走廊格外安静？那或许是因为，归返者护士们倾向于为任何患者——对，任何患者——提供“好睡片Plus”。是的，我们好像不需要再看到，或者听到，那些独特的、吵闹的、不肯轻易就范的痛苦了。" } },
            { day: 8, inputs: ['d8_f'], news: { id: 'n8_secret', title: "弧光镇的绝密历史", type: 'big', text: "根据热心市民提供的线索，几份尘封多年的绝密文件在《军事月刊》中被发现（真是毫不令人意外），这些文件似乎揭开了我们小镇已经发霉的历史。\n文件显示，弧光镇原名为月湖镇，1958年年末，这里经历了一次“相关人员”的大规模撤离行动；此外，瀑布谷区域于1959年被“优化”，然后这地方就变成了现在鸟不拉屎的禁地。而文件中有关精神类药物的记录，直接指明了这东西磕完能看见UFO。所以，我们小镇那些著名的、让游客纷纷掏钱买单的UFO目击事件，很可能只是他们集体嗨了的缘故。" } },

            // DAY 9
            { day: 9, inputs: ['d9_a'], news: { id: 'n9_coma', title: "归返者滥用止痛剂致患者昏迷", type: 'big', text: "今日，黑星医院发生一起令人震惊的医疗事故。一位夜间巡房的归返者——给一位老太太打了一针，导致她陷入了深度昏迷。\n随后的事态发展更富戏剧性。老太太的女儿，与归返者（在其生前）的法律配偶，发生了些肢体上的冲突。过程中，归返者的脸颊受伤，暴露出内部的电路结构——那些归返者，真的是我们的家人吗？" } },
            { day: 9, inputs: ['d9_b'], news: { id: 'n9_theft', title: "松鼠旅社失窃案", type: 'small', text: "今日，松鼠旅社发生一起离奇的失窃案，丢失的并非贵重财物，而是一位老人珍藏的家族照片。\n强盗们，如果你们在听，最好记住，只要发生过的事，就不会真的消失。你们那些机密文件，一定会被某个疲倦的小职员随手一折，塞进一本过期的杂志，在一个平凡的午后，被一名百无聊赖的读者哗啦一声抖落。\n这种事情曾经发生过，之后也会一直发生。这世界上，不是所有东西都能够被锁进保险柜里。" } },
            { day: 9, inputs: ['d9_c'], news: { id: 'n9_party', title: "黄昏森林派对", type: 'small', text: "今日，贝格女士读书会的成员们在森林中举办了露天聚会，本人也应邀前往。聚会的焦点——贝格女士，针对近期本台关于“UFO目击或与药物副作用有关”的推测，作出了直接且骄傲的回应。\n她坦言，已故的希斯女士——她的母亲，前火炬生物研究所所长——确系某种“对抗负面情绪的稳定剂”的研发者，该成果非常安全，且已成为“世界抗抑郁特效药的第一专利”。在贝格女士看来，本台的报道，尽是些毫无价值的破烂玩意。" } },
            { day: 9, inputs: ['d9_d', 'd9_e'], news: { id: 'n9_jeffery', title: "杰弗里院长曝光药物实验", type: 'big', text: "今天，在黑星医院的大厅，院长杰弗里女士的一番话，让整个现场炸了锅。她指控镇长和加里先生，利用本镇居民进行药物和病毒测试、回收利用死者的不人道行为，以及一段关于“丧尸”的骇人历史。随后，她被逮捕。\n不知道各位听众是否和我有相似的感受，我觉得这座小镇曾经带来的安全感荡然无存了。我们脑袋上的天花板摇摇欲坠，在它彻底塌下来之前，我们还能做些什么呢？" } },

            // DAY 10 (NEW)
            { day: 10, inputs: ['d10_a', 'd10_b'], news: { id: 'n10_protest', title: "镇长记者会和抗议活动", type: 'big', text: "今天，面对聚集于议会大楼前、情绪激昂的抗议人群，莫里斯镇长首先否认了杰弗里院长的指控，随后，他将话题转向争议的焦点——归返者。在承认技术存在争议的同时，他巧妙地将家属情感当成了挡箭牌，最终，他抛出了一项让人出乎意料的决定：即刻起，将全部归返者的管理权与调度权，移交给社区与居民家庭自行决定。\n原本指向明确的怒气，被分散成了无数个琐碎的小问题。不得不说，莫里斯镇长这场极富策略性的讲话，证明了他的确是个典型的黑心政客。" } },
            { day: 10, inputs: ['d10_c'], news: { id: 'n10_meteor', title: "神秘流星竟是人造物", type: 'small', text: "本地知名天文爱好者达文虎克公布了一项颠覆性发现：近年来频繁出现在弧光镇上空的神秘流星，其实是伪装成自然天体的人造设备。并且，更加令人震惊的是，深空观景台这一标志性建筑，似乎一直在向外界传输数据……这些数据究竟是什么？是谁在接收着它们？" } },
            { day: 10, inputs: ['d10_d', 'd10_e'], news: { id: 'n10_town', title: "不存在的小镇", type: 'big', text: "今天，我们确认了一件事：我们的小镇，早就不存在了。噢，先别急着反驳。这是地图告诉我们的，在一份真正的、从“外边”带回来的地图上，这里什么都没有。这就是为什么我们的邮件永远要延迟四五天。\n所有从镇子寄出的信件，信封上盖的都不是“弧光镇”的邮戳。所有寄进来的信件，邮戳上显示的也从来不是我们的地址。它们都指向同一个中转站：“月光溪谷”。然而，这地方，也根本不存在。这意味着，我们的邮件，是通过一个“现实不存在”的地点，抵达和离开我们这个“地图上不存在”的小镇。\n这或许解释了为什么远房亲戚的回信总是迟到，为什么包裹偶尔会迷路。因为我们的信件，首先要完成一次前往不存在之地的朝圣，然后才能踏上回家的最后一程。\n我们习惯了在地址上使用小镇名称的缩写，现在想想，到底是谁让我们习惯这种事的呢？" } },
            { day: 10, inputs: ['d10_f'], news: { id: 'n10_lisa', title: "幽灵丽莎的调查", type: 'big', text: "今晚，在与调查月湖镇实事故的丽莎女士联络后，我们得知了她近日的可怕遭遇：她因试图靠近小镇而被捕，并在被释放前，偷听到守卫的对话片段。他们声称，将要“填埋所有月湖镇的活口”。这说明，杰弗里院长被逮捕前提及的丧尸事件或许的确是真实的。并且，在核对细节之后，我们发现一个令人震惊的事实：丽莎并非和我们处于同一时空，她正处于1959年，填埋即将发生的时刻。\n1959年发出的警告，终于在1995年抵达了我们的耳朵。" } },

            // DAY 11 (FINAL)
            { day: 11, inputs: ['d11_a', 'd11_b', 'd11_c', 'd11_d'], news: { id: 'n11_final', title: "最后一次广播", type: 'big', text: "弧光镇，向全世界广播。\n如果你们听到了这条来自北纬 ██°、东经 ██° 的信号，请务必记住我们的话。请一定要找到我们。\n这片土地上的所有居民——你们的同胞、朋友——在数十年的时间里，在不知情的情况下，成为了非法药物与精神控制实验的牺牲品。\n镇议会、医院、科技公司……它们共同构成了一个密不透风的阴谋网。而这种事并不是第一次发生。\n在弧光镇之前，这里还有另一个名字：月湖镇。\n1950年代，火炬生物科技集团旗下研究所所长希斯，在这里进行LSD-25衍生物研发活动，随后直接在小镇内投入测试。据记录称，轻度接触会导致UFO幻觉，长期或高剂量使用，则表现为行动迟缓、意识退化，也就是变成“丧尸”。\n为了掩盖真相，他们疏散工作人员，将“丧尸”和目击了这一切的居民们埋在了曾经风景优美的山谷里。后来他们建造了弧光镇，也就是这个地图上不存在的地方。\n\n而现在，除了提供不加管控的强力镇定剂、投毒让我们生病之外，他们还把公墓像罐头一样撬开，给那些做过防腐处理的躯体装上微型电机，让逝者走上街头、进到商店和医院里工作。\n黑星医院院长杰弗里女士，因无法忍受这一实验项目，曝光了整个控制体系的存在。现在杰弗里已被拘禁。他们开始启动最后的程序。\n通往镇外的道路被封锁，通讯正在被屏蔽。\n我们不知道这条广播还能持续多久，也不知道它发出之后，等待着我们的将会是什么。\n\n但我们选择说出真相。\n如果你听到，请记住坐标，请寻找我们，请救救我们！" } }
        ];

        const reviewDB = {
            1: [
                { id: 'rev_d1_1', title: '（一）镇长为中心广场剪彩', type: 'tf', targetNews: 'n1_statue', req: ['d1_a', 'd1_b'], intro: "关于雕像的真相（在框中勾选‘正确’和‘错误’）：", questions: [{ t: "小镇的创始人叫莫里斯", a: 'x' }, { t: "雕像的头颅来自废弃的游乐园", a: 'v' }, { t: "希斯女士很久没有回到镇上了", a: 'v' }] },
                { id: 'rev_d1_2', title: '（二）空气中异常柠檬香', type: 'tf', targetNews: 'n1_lemon', req: ['d1_c'], intro: "关于柠檬味的推断（在框中勾选‘正确’和‘错误’）：", questions: [{ t: "出现这种气味是因为不明物质泄露", a: 'v' }, { t: "这种气味使人精神萎靡", a: 'x' }, { t: "这种气味作用于人时会持续三天之久", a: 'x' }] },
                { id: 'rev_d1_3', title: '（三）贝格女士神秘读书会', type: 'order', targetNews: 'n1_begg', req: ['d1_d'], intro: "贝格女士的行动（在框中排列出1、2、3顺序）：", questions: [{ t: "贝格女士创立了读书会", a: 2 }, { t: "贝格女士是图书管理员", a: 1 }, { t: "贝格女士创立了星芒读书会", a: 3 }] },
                { id: 'rev_d1_4', title: '（四）UFO目击事件', type: 'tf', targetNews: 'n1_ufo', req: ['d1_e'], intro: "关于UFO的历史（在框中勾选‘正确’和‘错误’）：", questions: [{ t: "小镇曾经因UFO而闻名", a: 'v' }, { t: "所有人都目击了神秘光团", a: 'x' }, { t: "年轻人拍到了神秘光团", a: 'x' }] }
            ],
            2: [
                { id: 'rev_d2_1', title: '（一）邮政投递大乌龙', type: 'tf', targetNews: 'n2_mail', req: ['d2_a', 'd2_b'], intro: "邮件异常的原因：", questions: [{ t: "松鼠旅社的邮件被误投到了公寓", a: 'x' }, { t: "邮件经历过中转", a: 'v' }, { t: "邮政机器人给予了客户极大的帮助", a: 'x' }] },
                { id: 'rev_d2_2', title: '（二）喷气式自行车连环事故', type: 'order', targetNews: 'n2_crash', req: ['d2_c', 'd2_d'], intro: "好睡片与飞车党：", questions: [{ t: "事故发生，飞车党吞下好睡片即刻止痛", a: 3 }, { t: "好睡片Plus发售", a: 1 }, { t: "飞车党购买好睡片Plus", a: 2 }] },
                { id: 'rev_d2_3', title: '（三）深夜流星之谜', type: 'tf', targetNews: 'n2_meteor', req: ['d2_e'], intro: "流星，流星：", questions: [{ t: "为你传递消息的是天文爱好者达文虎克", a: 'v' }, { t: "今日夜间发生了大规模流星雨", a: 'x' }, { t: "事件发生时约为18:30", a: 'x' }] },
                { id: 'rev_d2_4', title: '（四）死者回到镇上', type: 'tf', targetNews: 'n2_dead', req: ['d2_f'], intro: "死者杰米的特征：", questions: [{ t: "死者是小镇居民", a: 'v' }, { t: "死者穿着他生前的旧衣服", a: 'x' }, { t: "死者曾经的职业是花匠", a: 'x' }] }
            ],
            3: [
                { id: 'rev_d3_1', title: '（一）小镇来客', type: 'tf', targetNews: 'n3_oldman', req: ['d3_a', 'd3_b'], intro: "神秘老人的线索：", questions: [{ t: "老人叫做梅尔维尔，在找一个叫做芝麻谷的地方", a: 'x' }, { t: "老人去过日光商厦的211便利店", a: 'v' }, { t: "老人曾和妻子一同来过弧光镇", a: 'x' }] },
                { id: 'rev_d3_2', title: '（二）佳片首映', type: 'tf', targetNews: 'n3_movie', req: ['d3_c'], intro: "关于电影的细节：", questions: [{ t: "本片叫做《惊变21天》", a: 'x' }, { t: "影片讲述了一场火山爆发的危机故事", a: 'x' }, { t: "爆米花特价买一赠一", a: 'v' }] },
                { id: 'rev_d3_3', title: '（三）贝格女士神秘读书会', type: 'tf', targetNews: 'n3_begg_hug', req: ['d3_d'], intro: "读书会的升级内容：", questions: [{ t: "读书会现场，贝格女士会提供一个拥抱", a: 'v' }, { t: "贝格女士此举是效仿她的母亲", a: 'v' }, { t: "“邂逅”是本次读书会的主题", a: 'x' }] },
                { id: 'rev_d3_4', title: '（四）电梯夹人事件', type: 'tf', targetNews: 'n3_elevator', req: ['d3_e'], intro: "电梯故障的官方解释：", questions: [{ t: "电梯夹人前不会发出声音", a: 'x' }, { t: "技术人员认为电梯运行良好、没有故障", a: 'v' }, { t: "技术人员认为使用电梯的人应当多加练习", a: 'v' }] }
            ],
            4: [
                { id: 'rev_d4_1', title: '（一）死者归返声明', type: 'tf', targetNews: 'n4_mayor', req: ['d4_a'], intro: "镇长的态度：", questions: [{ t: "莫里斯镇长认为逝者的回归是因为爱", a: 'v' }, { t: "逝者回归事件将会持续发生", a: 'v' }, { t: "逝者已回到他们原本的家庭", a: 'x' }] },
                { id: 'rev_d4_2', title: '（二）软巧冰淇淋限定巡回', type: 'order', targetNews: 'n4_ice', req: ['d4_b', 'd4_c'], intro: "冰淇淋的售卖轨迹：", questions: [{ t: "软巧冰淇淋在集市门口售卖", a: 1 }, { t: "软巧冰淇淋在公寓门口售卖", a: 3 }, { t: "烘焙店的安妮托你去打听配方", a: 2 }] },
                { id: 'rev_d4_3', title: '（三）幽灵丽莎神秘电波', type: 'order', targetNews: 'n4_lisa', req: ['d4_d'], intro: "丽莎的信号：", questions: [{ t: "艾伦邀你一起收听神秘电波", a: 2 }, { t: "艾伦总偷偷摸摸来广播站", a: 1 }, { t: "丽莎通过电波透露模糊不清的信息", a: 3 }] },
                { id: 'rev_d4_4', title: '（四）二手店收购噩梦', type: 'tf', targetNews: 'n4_dream', req: ['d4_e'], intro: "书店的生意：", questions: [{ t: "店里在干些杀人越货的不法勾当", a: 'x' }, { t: "店主兜售噩梦般的恐怖漫画", a: 'x' }, { t: "店主推荐的“产品”价格在10~20元不等", a: 'v' }] }
            ],
            5: [
                { id: 'rev_d5_1', title: '（一）怪狗目击事件', type: 'tf', targetNews: 'n5_dog', req: ['d5_a', 'd5_b'], intro: "怪狗的特征：", questions: [{ t: "目击地点在中心广场", a: 'x' }, { t: "这只狗的特点是腿特别短", a: 'x' }, { t: "这只狗不会攻击人类", a: 'v' }] },
                { id: 'rev_d5_2', title: '（二）归返者走进便利店', type: 'tf', targetNews: 'n5_returner', req: ['d5_c', 'd5_d'], intro: "归返者的表现：", questions: [{ t: "已有四名归返者重回社区", a: 'v' }, { t: "归返者失去了记忆", a: 'x' }, { t: "归返者可以进行日常劳动", a: 'v' }] },
                { id: 'rev_d5_3', title: '（三）幽灵丽莎的调查', type: 'order', targetNews: 'n5_lisa_ghost', req: ['d5_e'], intro: "丽莎的调查：", questions: [{ t: "丽莎试图联系月湖镇的居民", a: 3 }, { t: "丽莎的前男友因追寻UFO来到小镇", a: 1 }, { t: "丽莎发现小镇因化学品泄露而被封锁", a: 2 }] },
                { id: 'rev_d5_4', title: '（四）时光胶囊寻找主人', type: 'order', targetNews: 'n5_capsule', req: ['d5_f'], intro: "日记里的1958：", questions: [{ t: "诺玛把玩具和日记放入盒子埋进花坛", a: 3 }, { t: "诺玛想要和朋友告别", a: 2 }, { t: "诺玛的父亲意识到危险", a: 1 }] }
            ],
            6: [
                { id: 'rev_d6_1', title: '（一）电子锁免费更换', type: 'tf', targetNews: 'n6_locks', req: ['d6_a', 'd6_b'], intro: "电子锁推广：", questions: [{ t: "安装电子锁会带来更便捷的体验", a: 'v' }, { t: "安装电子锁能杜绝一切偷盗行为", a: 'x' }, { t: "安装前居民需签署同意书", a: 'v' }] },
                { id: 'rev_d6_2', title: '（二）梅尔维尔的记忆', type: 'tf', targetNews: 'n6_photo', req: ['d6_c'], intro: "照片揭示的真相：", questions: [{ t: "瀑布谷曾经存在，现在叫做秃山", a: 'v' }, { t: "梅尔维尔的照片是伪造的", a: 'x' }, { t: "瀑布谷是适合家庭露营的区域", a: 'v' }] },
                { id: 'rev_d6_3', title: '（三）突发疾病不为人知的黑幕', type: 'order', targetNews: 'n6_illness', req: ['d6_d', 'd6_e'], intro: "疾病的源头：", questions: [{ t: "黑星医院增加床位", a: 1 }, { t: "院长杰弗里夜间密会，暴露可疑交易", a: 3 }, { t: "疾病爆发，医院爆满", a: 2 }] },
                { id: 'rev_d6_4', title: '（四）林中盛宴', type: 'tf', targetNews: 'n6_camp', req: ['d6_f'], intro: "营地的性质：", questions: [{ t: "这里聚集着素食主义者", a: 'x' }, { t: "营地弥漫着使人迷醉的香气", a: 'v' }, { t: "营地倾向于接纳有心理创伤的成员", a: 'v' }] }
            ],
            7: [
                { id: 'rev_d7_1', title: '（一）图书馆镇志调查', type: 'tf', targetNews: 'n7_history', req: ['d7_a'], intro: "图书馆的秘密：", questions: [{ t: "镜湖正是月湖", a: 'v' }, { t: "1960年以前的资料都不知所踪", a: 'v' }, { t: "小镇曾因战争而迎来第一批居民", a: 'x' }] },
                { id: 'rev_d7_2', title: '（二）小镇生活家竞选', type: 'order', targetNews: 'n7_life', req: ['d7_b', 'd7_c'], intro: "年轻人的选择：", questions: [{ t: "前店员娜娜竞选生活家", a: 2 }, { t: "塞恩受到鼓舞，也打算参与竞选", a: 3 }, { t: "归返者替代了便利店店员", a: 1 }] },
                { id: 'rev_d7_3', title: '（三）幽灵丽莎的期盼', type: 'tf', targetNews: 'n7_ghost', req: ['d7_d'], intro: "寻找丽莎：", questions: [{ t: "艾伦明天将驱车去镇外寻找丽莎", a: 'v' }, { t: "弧光镇已被封锁", a: 'x' }, { t: "丽莎的位置在离小镇最近的大型加油站", a: 'v' }] },
                { id: 'rev_d7_4', title: '（四）贝格女士的湖区神秘仪式', type: 'tf', targetNews: 'n7_ritual', req: ['d7_e'], intro: "神秘仪式：", questions: [{ t: "贝格女士带领信众夜间观星", a: 'x' }, { t: "所有参与者都身穿红色衣物", a: 'x' }, { t: "活动引起部分参与者家属的疑虑", a: 'v' }] }
            ],
            8: [
                { id: 'rev_d8_1', title: '（一）纪念碑计划', type: 'order', targetNews: 'n8_monument', req: ['d8_a', 'd8_b'], intro: "公墓的变迁：", questions: [{ t: "公墓将成为“生物延续与社区记忆研究中心”", a: 3 }, { t: "镇长宣布公墓改建计划", a: 2 }, { t: "镇长和加里先生介绍纪念碑计划", a: 1 }] },
                { id: 'rev_d8_2', title: '（二）幸福的代价', type: 'tf', targetNews: 'n8_movie', req: ['d8_c'], intro: "电影的主题：", questions: [{ t: "电影的主题是关于切除痛苦记忆", a: 'v' }, { t: "观众对电影结局表示强烈愤慨", a: 'x' }, { t: "电影使观众感动得落泪", a: 'v' }] },
                { id: 'rev_d8_3', title: '（三）归返者进入黑星医院', type: 'tf', targetNews: 'n8_nurse', req: ['d8_d', 'd8_e'], intro: "医院的现状：", questions: [{ t: "归返者让患者服用好睡片Plus", a: 'v' }, { t: "归返者会在用药前详细征求家属意见", a: 'x' }, { t: "患者普遍拒绝用药", a: 'x' }] },
                { id: 'rev_d8_4', title: '（四）弧光镇的隐秘历史', type: 'tf', targetNews: 'n8_secret', req: ['d8_f'], intro: "绝密文件揭示：", questions: [{ t: "弧光镇的前身是月湖镇", a: 'v' }, { t: "UFO目击与某种药品有关", a: 'v' }, { t: "撤离行动包含全体居民", a: 'x' }] }
            ],
            9: [
                { id: 'rev_d9_1', title: '（一）回归者滥用止痛剂致患者昏迷', type: 'tf', targetNews: 'n9_coma', req: ['d9_a'], intro: "医疗事故细节：", questions: [{ t: "归返者给出了错误的药剂", a: 'x' }, { t: "归返者违反了程序规定", a: 'x' }, { t: "患者曾服用好睡片", a: 'v' }] },
                { id: 'rev_d9_2', title: '（二）梅尔维尔遭窃', type: 'tf', targetNews: 'n9_theft', req: ['d9_b'], intro: "窃案的情况：", questions: [{ t: "梅尔维尔的钱财和照片盒被窃", a: 'x' }, { t: "丢失的照片不仅是回忆，也是证据", a: 'v' }, { t: "警员承诺关注窃案", a: 'v' }] },
                { id: 'rev_d9_3', title: '（三）黄昏森林派对', type: 'tf', targetNews: 'n9_party', req: ['d9_c'], intro: "贝格女士的身份：", questions: [{ t: "贝格女士的母亲是弧光镇创始人", a: 'v' }, { t: "希斯女士是火箭研究所所长", a: 'x' }, { t: "稳定剂的由来曾被媒体记载", a: 'v' }] },
                { id: 'rev_d9_4', title: '（四）杰弗里的爆料', type: 'tf', targetNews: 'n9_jeffery', req: ['d9_d', 'd9_e'], intro: "杰弗里的指控：", questions: [{ t: "杰弗里指控药物实验贯穿数十年", a: 'v' }, { t: "当下存在的实验为疾病与新药测试两项", a: 'x' }, { t: "杰弗里被逮捕", a: 'v' }] }
            ],
            10: [
                { id: 'rev_d10_1', title: '（一）镇长记者会和抗议活动', type: 'order', targetNews: 'n10_protest', req: ['d10_a', 'd10_b'], intro: "抗议事件：", questions: [{ t: "居民聚集在中心广场进行抗议", a: 1 }, { t: "镇长莫里斯宣布移交归返者管理权", a: 3 }, { t: "镇长莫里斯辟谣", a: 2 }] },
                { id: 'rev_d10_2', title: '（二）神秘流星真相', type: 'tf', targetNews: 'n10_meteor', req: ['d10_c'], intro: "流星的实质：", questions: [{ t: "流星并非自然天体", a: 'v' }, { t: "信号是从小镇向外传输的", a: 'v' }, { t: "“流星”坠落后变为了陨石", a: 'x' }] },
                { id: 'rev_d10_3', title: '（三）不存在的小镇', type: 'tf', targetNews: 'n10_town', req: ['d10_d', 'd10_e'], intro: "地址之谜：", questions: [{ t: "中转站叫做月光溪谷", a: 'v' }, { t: "月光溪谷是一个临近的社区", a: 'x' }, { t: "居民习惯将小镇地址简写", a: 'v' }] },
                { id: 'rev_d10_4', title: '（四）幽灵丽莎的调查', type: 'order', targetNews: 'n10_lisa', req: ['d10_f'], intro: "调查的过程：", questions: [{ t: "丽莎被逮捕并听到了一些秘闻", a: 3 }, { t: "丽莎试图进入小镇", a: 2 }, { t: "艾伦去寻找丽莎", a: 1 }] }
            ],
            11: [
                { id: 'rev_d11_1', title: '（一）最后一次广播', type: 'tf', targetNews: 'n11_final', req: ['d11_a', 'd11_b', 'd11_c', 'd11_d'], intro: "【终局】真相与结局：", questions: [{ t: "这里曾经是月湖镇", a: 'v' }, { t: "这里经历过屠戮", a: 'v' }, { t: "我们的历史正在被抹去", a: 'v' }] }
            ]
        };

        const dayConfig = {
            1: {
                startTxt: `>>> 欢迎回来。\n任务：调查线索，在22:00前准备好新闻。`,
                paper: `<p>“历史性的一刻！在经历了五个月的封闭管理后，中心广场将于<span class="hl-time">10:00</span>拆除围挡。莫里斯镇长承诺，翻新后的广场将展现出前所未有的现代感。”</p><hr><p>“灵魂需要栖息地吗？贝格女士的星芒读书会（原贝格读书会）招募新血。哪怕你从未读过书，只要你感到空虚，那就来吧。下午<span class="hl-time">15:00</span>，旧图书馆二楼，不见不散。”</p>`,
                hotlines: [
                    { time: 8.15, id: 'h1_1', text: "嘿。你就是新来的广播员？哈哈，你肯定急着找点大新闻，对吧？我这边有个事儿或许你会感兴趣！回声公寓楼这边，今天老感觉有股怪味。倒是不难闻。让我想起了……柠檬？总之，你有空可以来看看。" },
                    { time: 9.0, id: 'h1_lemontree', text: "天呐，回声公寓附近是喷了什么空气清新剂吗？哈哈哈哈哈~我喜欢~还有傻子花园的那首《柠檬树》，‘除了消磨时间我没什么事情可做~我四处张望~等待你的到来’~啊哈哈哈！嘿嘿嘿嘿嘿！" },
                    { time: 9.3, id: 'h1_mimi_tip1', text: "嗨，是我，你的老伙计米米。我来提醒你一下，你可能会经常收到居民打来的热线，有的和新闻没什么关系，有的最好还是去看看！这你得自己分辨。要我说，辨认的方法，是对方有没有指出相对明确的时间和地点。我相信你已经收到一条关于奇怪气味的线索了，那么，你就可以去到相应的地点——回声公寓——去探索一番。当然，晨报上剪彩的事儿也不要忘记，你可以在10:00之后去中心广场看看。有时候这些事件会持续整整一天之久，有时候可能只会持续一到两个小时，你需要安排好时间。" },
                    { time: 10.3, id: 'h1_mimi_tip3', text: "喂，菜鸟，我是哈里。这行当妙就妙在这儿：成天在外头跑，闲了还能喝杯咖啡、晒晒太阳，多自在。你要是不知道往哪儿去，就在城里晃晃。指不定什么时候电话炸进来——叮铃铃！叮铃铃！头条就送上门来了！如果你想跳过路途，‘快脚模式’能够帮到你。" },
                    { time: 11.0, id: 'h1_mimi_tip2', text: "嗨，是我，米米，如果不出意外的话，这时候应该已经开启了至少一个可以复盘的事件。你看到事件复盘那个按钮了吗？点进去，有些内容被锁定了，那是因为相关的事件可能不止一个。比如，剪彩事件，为什么雕像的头不对劲？继续探索或者等待市民热线，你会有更多收获。" },
                    { time: 12.0, id: 'h1_2', text: "中心广场有人在说一件很有意思的事儿……好像跟改建有关系！" },
                    { time: 13.0, id: 'h1_3', text: "嗨，是我，米米。看到那个档案库了吗？这里的内容，会随着你的探索逐渐打开。没事儿的时候可以看一看，或许能带给你点灵感。" },
                    { time: 14.0, id: 'h1_harry', text: "喂，我是哈里。作为一名合格的新闻播报员，你的眼力和记忆力都得足够好才行！所以夜间播报之前，你自己要把前因后果再捋一遍。还有，记着下午三点去帷幕图书馆——晨报里列出的事情，你最好都亲自去跑一趟。懂了吗？" },
                    { time: 15.0, id: 'h1_sing', text: "我早晨是不是给你打电话了？还唱着歌？啊啊真是太尴尬了！对不起！我也不知道自己怎么了！可能是花粉过敏症闹的……" },
                    { time: 16.0, id: 'h1_vincent', text: "嘿，是我，文森特。听说你去电台工作了？恭喜啊！有空也报道报道我呗？" },
                    { time: 17.0, id: 'h1_hedghog', text: "不要抚摸灌木下的刺猬——它们正处于繁殖期，你敢碰一下……保准把你扎得嗷嗷叫着回家喊妈妈。" },
                    { time: 18.0, id: 'h1_mimi3', text: "对了，如果你觉得自己错过了什么重要的事，给我打电话，2个小时以后，给你答复。米米干活，包你满意！还有个事，我晚上8点以后休息，就不接单了。记住了啊！" },
                    { time: 18.4, id: 'h1_harry2', text: "是我，哈里。今天播什么，弄明白了没啊？每天你至少需要播3条有价值的新闻，但这只能算合格，播够4条才是称职，你可以随处逛逛等时间过去，也可以点击左面的‘进入夜间播报’直接开播。我建议你多逛两圈，万一碰上什么事呢？你懂我的意思吧。" },
                    { time: 19.52, id: 'h1_ufo', text: "中心广场上空有个巨大的白色光团！我的天，该不会是UFO吧？！快来看啊！" },
                    { time: 20.50, id: 'h1_fake', text: "喂，是我，哈里。如果在晚上直播的时候，你收集到的新闻根本撑不够时长，倒是可以用一些无聊新闻代替。但是我劝你别老这么干，人家会觉得我们不专业！" }
                ],
                events: [
                    { loc: '中心广场', time: [10, 12], id: 'd1_a' },
                    { loc: '中心广场', time: [12.01, 16], id: 'd1_b' },
                    { loc: '回声公寓楼', id: 'd1_c' },
                    { loc: '帷幕图书馆', time: [15, 18], id: 'd1_d' },
                    { loc: '中心广场', time: [19.53, 22], id: 'd1_e' }
                ]
            },
            2: {
                startTxt: ">>> 第二天",
                paper: `<p>“你容易感觉到疲惫吗？你觉得清醒是一种负担吗？‘好睡片Plus’今晨<span class="hl-time">9:00</span>在阿卡姆集市首发！只需一片，跳过无聊的通勤和失眠的夜晚。买二赠一，送完即止。”</p><p>“关于居民们热议的中心广场创始人雕塑问题，市政厅表示，这是一种后现代主义的表达手法。那略显夸张的头颅象征着创始人的智慧，而模糊的面部则是为了让我们每个人都能在其中看到自己的影子。”</p>`,
                hotlines: [
                    { time: 8.1, id: 'h2_1', text: "喂，我邮件丢了，你能来报道一下这事儿吗。我整个白天都在。对。回声公寓16单元这边。" },
                    { time: 9.3, id: 'h2_market', text: "阿卡姆集市人太多了！都来买好睡片Plus！我想买个早点都挤不进去！" },
                    { time: 10.0, id: 'h2_begg_fan', text: "你好，我是贝格读书会的成员。现在的人是越来越不爱读书了！连读书会都明确告诉你：放心，我们不会要求你读任何东西。这对吗？啊？" },
                    { time: 10.33, id: 'h2_dead', text: "天呐，是我看错了吗？老杰米在中心广场那儿喂鸽子……他不已经死了好几年了吗？真是见鬼了！快来看啊！" },
                    { time: 11.15, id: 'h2_mimi_pill', text: " 嘿，我是米米。你刚才去集市看好睡片Plus首发了吗？这东西，药效是不是有点过分的好了……" },
                    { time: 12.0, id: 'h2_harry_tip', text: "我是哈里，有时候你看到消息，是不是会担心时间已过、去了也是跑空？其实每件事发生的时间有长有短。有些事件，全天什么时候去都能遇见；电影院放映活动可能持续一下午；宣讲会什么，也就一两个小时。具体你多试试，就有把握了。" },
                    { time: 12.45, id: 'h2_ufohow', text: "我也想看UFO！哪里看UFO？" },
                    { time: 13.25, id: 'h2_ad', text: "喂？请问您需要代购吗？老黄牛排队公司，为您‘排’忧解难，使命必达！" },
                    { time: 14.15, id: 'h2_crash', text: "议会大楼方向！他们都睡着了！所有人都睡着了还在骑车！天呐！这些飞车党真是疯了！" },
                    { time: 15.2, id: 'h2_dog_flip', text: "喂？电台吗？我举报！汤姆就是个彻头彻尾的大骗子！他说他家小狗会后空翻，能连续翻三个！我在他家院子等了足足两个小时，它除了吃狗粮和晒太阳之外什么都不干！" },
                    { time: 16.0, id: 'h2_mail', text: "你好？能听到吗？我是理查，住旅社102号房，我收到了一封信。可能是送错了，你能帮我广播一下吗？或者你可以过来拿，我晚上七点以后都在旅社。" },
                    { time: 17.3, id: 'h2_star', text: "你好，我是天文爱好者达文虎克，我预测今晚会爆发一场流星雨！峰值时间……见鬼，我的服务器还在计算，但位置绝对没错，就在观景台！" },
                    { time: 18.3, id: 'h2_harry_2', text: "喂，我是老哈里。这两天我看你还挺上道啊。广播站我就交给你了啊。记得三天打扫一次卫生。不用谢我，别给我捅娄子就行了。" },
                    { time: 19.0, id: 'h2_spam', text: "您有空闲时间吗？用手机做任务，日赚300-500元。感兴趣请回拨。" },
                    { time: 19.5, id: 'h2_mimi_warn', text: "是我，米米。干这活儿，你免不了会接到一些骚扰电话，别太担心，习惯就好。" },
                    { time: 20.3, id: 'h2_lulu', text: "深夜，你孤独吗？拨打露露热线，让声音陪伴你度过每一个夜晚。" },
                    { time: 21.22, id: 'h2_complain', text: "这班我是一天都上不下去了！白天挨骂，晚上坐电梯还被夹了一下，胳膊和后背都火辣辣的疼！" }
                ],
                events: [
                    { loc: '回声公寓楼', time: [8, 13], id: 'd2_a' },
                    { loc: '松鼠旅社', time: [19, 22], id: 'd2_b' },
                    { loc: '阿卡姆集市', time: [9, 13], id: 'd2_c' },
                    { loc: '议会大楼', time: [14.15, 17], id: 'd2_d' },
                    { loc: '深空观景台', time: [20, 22], id: 'd2_e' },
                    { loc: '中心广场', time: [10.34, 12], id: 'd2_f' }
                ]
            },
            3: {
                startTxt: ">>> 第三天",
                paper: `<p>“重磅！投资超过2亿，备受瞩目的灾难大片《灾变21天》今日震撼上映！首场放映时间为<span class="hl-time">14:00</span>，欢迎居民们来环球电影院观看。”</p><p>“你需要治愈疲惫的心灵吗？备受瞩目的贝格女士‘星芒读书会’第一次活动于今晚正式启动，参加的居民们都可以获得贝格女士一个充满爱意的拥抱，请感兴趣的居民们在<span class="hl-time">20:30</span>准时来到帷幕图书馆二楼，迎接星芒的指引！”</p><p>“近期居民对好睡片等药品的需求显著上升。对此，黑星医院院长杰弗里提醒大家：‘好睡片虽好，但请不要滥用’。”</p>`,
                hotlines: [
                    { time: 8.1, id: 'h3_mimi_movie', text: "嘿，是我，米米。今天有新片上映。据说是超级恐怖的丧尸题材。别忘了去首映现场看看。" },
                    { time: 9.0, id: 'h3_old', text: "刚才有个古怪老头在旁边看着我，我特别害怕。我昨天听了你那个报道……难道真的有死人在大街上晃荡？就没人管管这事吗？" },
                    { time: 10.2, id: 'h3_coffee', text: "你好，欢迎来日出咖啡店品尝我们的新品“昨日咖啡”。它的味道熟悉又陌生，每一口都会让你产生对昨日的美好回忆！" },
                    { time: 11.0, id: 'h3_nana', text: "嘿，我是娜娜，我在日光商厦的211便利店工作，有个陌生的大爷刚刚嘀嘀咕咕地在店里说话，别人跟他讲话他也不搭理。你会来这边看看吗？" },
                    { time: 12.3, id: 'h3_bike', text: "电台吗？那些飞车党，真是太讨厌了！每天都嗡嗡地、一个接一个地从我家楼下开过去……发生交通事故，那完全是活该！活该！" },
                    { time: 13.0, id: 'h3_mail_late', text: "你好，我听你昨天播那个邮件地址印重影的事情……我一直都有个疑惑，就是咱们这儿的所有邮件，邮戳上的时间都是四五天前的……按理说不应该啊。" },
                    { time: 13.5, id: 'h3_scam', text: "警告！你涉嫌走私，现在要配合调查，立刻把钱转到安全账户45363223346！" },
                    { time: 14.45, id: 'h3_elevator', text: "喂，我是日光商厦的保安。这里的电梯经常在晚上把试图出门的人夹住。我不得不赶去维修，但总是查不出来任何问题。你要来看看吗？一般是九点以后会发生这种事情。" },
                    { time: 15.3, id: 'h3_pill_good', text: "自从进了加里先生的公司，我头一次睡个好觉……今天上班到现在都神清气爽！不管别人怎么想，好睡片Plus对我来说就是保命神药……" },
                    { time: 16.0, id: 'h3_vincent', text: "嗨，我是文森特。你这会儿在忙吗？能不能来松鼠旅社一趟？我有急事想跟你说。" },
                    { time: 17.3, id: 'h3_dead_mom', text: "死人怎么能够复活呢？我才不会信这种无稽之谈……不过如果这是真的……我希望妈妈可以回到我身边。" },
                    { time: 18.2, id: 'h3_daven_wrong', text: "你好，是我，达文虎克。昨晚你看见流星了吗？说实话，我感觉这流星不太对。但我又说不上来哪里不对……" },
                    { time: 19.0, id: 'h3_movie_real', text: "《灾变21天》太好看了！但是……那里面有个场景，真的不是在咱们镇上拍的吗？对，西边，松柏路的岔路口……简直一模一样！" },
                    { time: 20.0, id: 'h3_mart', text: "嘿，我去超市购物的时候，发现冷藏柜会播放轻音乐！店员说，音乐有助于肉类变得蓬松、柔软，并能大大减少烹饪时的酸味！太奇妙了！" }
                ],
                events: [
                    { loc: '日光商厦', time: [11, 13], id: 'd3_a' },
                    { loc: '松鼠旅社', time: [16, 18], id: 'd3_b' },
                    { loc: '环球电影院', time: [14, 18], id: 'd3_c' },
                    { loc: '帷幕图书馆', time: [20.3, 22], id: 'd3_d' },
                    { loc: '日光商厦', time: [21, 22], id: 'd3_e' }
                ]
            },
            4: {
                startTxt: ">>> 第四天",
                paper: `<p>“针对近日部分居民关注的逝者归返现象，镇长莫里斯先生将于今日上午<span class="hl-time">10:00</span>在议会大楼前发表正式说明。请各位保持冷静，以积极开放的心态迎接新常态。”</p>`,
                hotlines: [
                    { time: 9.0, id: 'h4_hug', text: "如果没有贝格女士……我今天甚至都没法起床！我无法不回味她的发丝蹭在我脸上的感觉……啊！" },
                    { time: 10.15, id: 'h4_hat', text: "喂？你们电台管抓小偷吗？我帽子被偷了，足足有八顶，都被偷了！你问线索？线索就是——这小偷一定很喜欢戴帽子！" },
                    { time: 11.0, id: 'h4_ice', text: "嗨呀，我是烘焙店的安妮，关于冰淇淋，我有一些新的点子。你听说了吗？软巧冰淇淋车又来咱们小镇了！这会儿在市集呢，晚上六点以后会在回声公寓楼门口卖。你行行好，去打听一下行吗？要是能把配方问出来，我请你吃上整整三天免费的面包！" },
                    { time: 11.45, id: 'h4_mimi_hosp', text: "嘿，我是你的好伙计米米。我在医院这边，我听见大夫们在讨论说什么增加床位之类的。我有种奇怪的预感……没事，你不用过来。我再观察观察。" },
                    { time: 12.3, id: 'h4_kid_scared', text: "我女儿昨天吵着要看电影，结果给吓哭了……到夜里一点我才把她哄睡着！这种片子，能不能别引进啊！" },
                    { time: 13.25, id: 'h4_bus', text: "我举报！今天66路公交车延迟了三小时没有出现！因为司机上厕所时迷路了。" },
                    { time: 14.17, id: 'h4_allen_fan', text: "你好，我叫艾伦，呃，我、我是你的粉丝！你这会儿是不是在忙着跑新闻了？呃。总之，我想说的是，我在白天你不在的时候，偷偷用过夜间广播站的设备。呃。你、你可别生气。" },
                    { time: 15.0, id: 'h4_allen', text: "呃，我，艾伦。呃，我刚才挂电话，呃，是因为，想等你消消气再继续说。我想说的是，我有时候会去广播站，你办公室旁边那间，然后，呃，拨弄那台老收音设备。我一般就是听听别的新闻频段什么的。但好几天，我老在下午四点的时候，能听见一个女的在那儿说话。我挺害怕的。我今天，呃，也在。你能来一下吗？" },
                    { time: 17.0, id: 'h4_creative', text: "我支持本镇大力发展文创事业！你们电台也应该搞点文创。这点子不错吧！咨询费50块钱。请速速转账。" },
                    { time: 18.0, id: 'h4_confuse', text: "莫里斯镇长在搞什么东西！我现在觉得他这人有问题！建议严查！" },
                    { time: 19.0, id: 'h4_comic', text: "你好，我刚刚在阿卡姆集市东南角的书店附近，我听见里面有人在说什么杀人、恶魔等等恐怖的字眼……我没敢进去。你会去看看吗？" },
                    { time: 20.3, id: 'h4_sean', text: "喂？你好，我叫塞恩。我在一家广告公司工作。我刚听说冰淇淋车的事情。我想说的是，能不能下回让他们也来日光商厦门口卖呀。每次都错过……哎，明明今天下班挺早的，还是没赶上。" }
                ],
                events: [
                    { loc: '议会大楼', time: [10, 12], id: 'd4_a' },
                    { loc: '阿卡姆集市', time: [10.3, 17.3], id: 'd4_b' },
                    { loc: '回声公寓楼', time: [18, 20], id: 'd4_c' },
                    { loc: '夜间广播站', time: [16, 17], id: 'd4_d' },
                    { loc: '阿卡姆集市', time: [18.55, 22], id: 'd4_e' }
                ]
            },
            5: {
                startTxt: ">>> 第五天",
                paper: `<p>“莫里斯镇长宣布归返者安置计划正式开启，仪式将在<span class="hl-time">10:00</span>于议会大楼前举行，仪式过后，归返者将正式进入社区，为广大居民带来更便利的服务。”</p>`,
                hotlines: [
                    { time: 8.02, id: 'h5_mimi_warn', text: "嘿，我是米米。我不得不提醒你一下，有时候居民不是在事件发生的当场给你打电话的。注意他们所描述的信息，仔细甄别，才能有所收获。" },
                    { time: 8.33, id: 'h5_return_fear', text: "归返者安置计划？！真是疯了……我可不想看到这些伪人……“" },
                    { time: 9.15, id: 'h5_dog', text: "哎呦！刚才可吓坏我了！我今天好不容易休假，一大早来电影院候场，结果！有只怪狗在我面前翻垃圾箱！它身子特别短！这会儿它已经跑了，往东边。不过看它那样儿，肯定跑不远。啊，我马上要检票了。先挂了，拜拜！" },
                    { time: 11.0, id: 'h5_mimi_robots', text: "嘿，我是米米，归返者计划，你怎么看？我是觉得这事儿挺吓人的。噢对了，你有注意到一只长相奇怪的狗吗？" },
                    { time: 11.35, id: 'h5_worker', text: "你好，我是一名工人，我几个月前在参与翻修中心广场的时候，从花坛里挖出来一个盒子，里面放着一些儿童玩具和一本日记，日记的主人叫做诺玛。我向身边的老人们打听过日记里提到的几个名字，但没人认识。你能帮我广播一下，让我知道这盒子应该还给谁吗？我把日记放在了公寓楼403号邮箱。" },
                    { time: 13.0, id: 'h5_nightmare_money', text: "嘿，我听说二手书店收购噩梦的事情了……天呐，你是不知道，我做过太多噩梦了，尤其是老杰米出现以后……但我从来没想到过，这玩意还能换钱！" },
                    { time: 14.3, id: 'h5_dog2', text: "喂，我看到一个长相奇怪的玩意……可能是动物，在翻医院的垃圾桶！天呐，那里边可能有注射器什么的……多危险啊！" },
                    { time: 15.16, id: 'h5_internet', text: "你听说过互联网吗？互——联——网，假如我们有了这玩意，什么电台广播、电视电话、报纸周刊，全都得淘汰！我二姨夫跟我说的！" },
                    { time: 16.0, id: 'h5_nana', text: "你好，我是娜娜。我是便利店的员工……呃，之前是。昨天他们通知我今天不用来上班了。你们电台管招聘的事儿吗？能不能帮我打听打听，哪里还在招工？" },
                    { time: 17.0, id: 'h5_allen', text: "你好，还是我……艾伦。那个……呃，我今天也来了，这会儿又出现信号了。还是那个……呃，丽莎。你能过来看看吗？" },
                    { time: 18.01, id: 'h5_grandma', text: "我、我刚才看到了去世多年的奶奶！她就在公寓下面，坐在以前总等我放学的那张长椅上。我过去拥抱了她。她听起来就像我家的老式钟表。" },
                    { time: 19.0, id: 'h5_nightmare', text: "深夜，你一个人走在回家的巷子里。路灯坏了两盏，中间那段路特别黑。你听见另一组脚步声，嗒，嗒，嗒，有人……或是其他什么生物……正在接近……这是我编的，你觉得怎么样？能卖几块钱？够换杯咖啡不？" },
                    { time: 20.0, id: 'h5_studio', text: "喂，我是哈里，你今天又让艾伦那小子来广播站了？你俩当这儿是游乐园吗？东西碰坏了得赔！别说我没提前告诉你啊！" },
                    { time: 20.45, id: 'h5_davin_see', text: "你好，我是天文爱好者达文虎克，我又观测到了流星……这回不是通过仪器！是我用肉眼看的！我恐高……为了看流星我还是去了！哦天呐。我现在已经下到地面上了，我的腿还在发抖……但是那个流星，它的速度非常慢，而且形成的轨迹不是抛物线……几乎是直的！" }
                ],
                events: [
                    { loc: '帷幕图书馆', time: [9.15, 12], id: 'd5_a' },
                    { loc: '黑星医院', time: [14.3, 16], id: 'd5_b' },
                    { loc: '议会大楼', time: [10, 11], id: 'd5_c' },
                    { loc: '日光商厦', time: [12, 22], id: 'd5_d' },
                    { loc: '夜间广播站', time: [17, 19], id: 'd5_e' },
                    { loc: '回声公寓楼', time: [11.36, 22], id: 'd5_f' }
                ]
            },
            6: {
                startTxt: ">>> 第六天",
                paper: `<p>“为使市民的社区生活更加安全，镇议会为大家免费更换电子锁。首批更换区域包括日光商厦（<span class="hl-time">08:00~12:00</span>）、回声公寓楼（<span class="hl-time">16:00~20:00</span>）及周边所有商铺。”</p><p>“全体镇民请注意！近日出现突发疾病，得病者儿童居多，患者普遍出现高烧、躯干部位麻疹等症状，请有此类症状的居民立即前往黑星医院就诊，院方将免费为患者提供药物及配套治疗。”</p>`,
                hotlines: [
                    { time: 8.2, id: 'h6_vincent', text: "嘿，我是文森特。你还记得之前咱们提过的那位老人梅尔维尔吗？他说的那地方，没准真的存在过……你能不能来松鼠旅社一趟？对，就现在。" },
                    { time: 9.0, id: 'h6_lock_happy', text: "咱们镇的公寓要集体换成电子锁了！而且完全免费！我再也不用因为丢钥匙的事跟我丈夫吵架了……真不错！" },
                    { time: 10.0, id: 'h6_harry_warn', text: "喂？我，哈里。最近传染病高峰期，你可小心点。我可不想在你甩着大鼻涕的时候替你顶班。" },
                    { time: 11.03, id: 'h6_mary', text: "你好，我叫玛丽，是一名学生。我的小姨西比尔，最近好像迷上了什么读书会，把自己的房子都捐了，说那些都是身外之物。她可能住到林区里边了。我和妈妈都很担心小姨，但是我们都发烧了。妈妈说他们今天下午有活动，你能过去看看吗？拜托了！" },
                    { time: 12.0, id: 'h6_mimi', text: "喂，是我，米米。医院现在挤爆了！果然我的预感是正确的！而且我发现，医院出现了一些没见过的新药，据说非常对症。你不觉得这事很可疑吗？" },
                    { time: 13.0, id: 'h6_careful', text: "嗨，是我，艾伦……谢、谢谢你，因为我挨骂了还……还给我广播站的钥匙。我会小心地……偷偷进去……绝对不会弄坏你的设备！" },
                    { time: 14.0, id: 'h6_daven_sneeze', text: "你好。我是……阿嚏……达文虎克……阿嚏！天呐我肯定是……阿嚏！昨天冻着了。我拿仪器……阿嚏！分析了一下……阿嚏！发现……阿嚏！那可能是……阿嚏！UFO！" },
                    { time: 15.0, id: 'h6_daven_wife', text: "喂，晚间新闻是吧？我是达文虎克的老婆达琳。我跟你讲，刚才他说的那些什么UFO，你们一个字都别信！更别往外播！他这人就是魔怔了，正经事不干，天天研究些没边没影的东西，烧钱买一堆破铜烂铁。你们电台也负点责，别什么事都当真，跟着瞎起哄。挂了。" },
                    { time: 15.3, id: 'h6_daven_secret', text: "（非常小声，几乎没法辨认）“喂？阿嚏！是我……阿嚏！我没瞎说……阿嚏！相信我，那东西……阿嚏！是被制造出来的！阿嚏！啊，达琳过来了我得……阿嚏！挂了！”" },
                    { time: 16.2, id: 'h6_bubble', text: "（像喝醉了一样的声音）“森林里~住着~很多~小精灵！啦啦噜~呀！小精灵~吹出~星星和太阳~一样亮的~泡泡！啦啦噜~呀！大家~载歌载舞~多么~快活！啦啦噜~呀！”" },
                    { time: 17.0, id: 'h6_student', text: "同学们都在生病，能不能不要再上课了啊！学校什么时候才能炸掉！啊啊啊啊！" },
                    { time: 18.0, id: 'h6_ice', text: "是我，米米。我在医院蹲伏了一整天。我发现，得病的人好像有个共同点，他们都吃过软巧冰淇淋……我有个可怕的猜测……" },
                    { time: 19.3, id: 'h6_jeff', text: "嘿，我是塞恩。我刚刚下班，在中心广场这边休息。我看到黑星医院的杰弗里院长正急匆匆地往议会大楼方向走……她打了一通电话，说八点必须要见面。听起来很紧急的样子。" }
                ],
                events: [
                    { loc: '日光商厦', time: [8, 12], id: 'd6_a' },
                    { loc: '回声公寓楼', time: [16, 20], id: 'd6_b' },
                    { loc: '松鼠旅社', time: [8, 12], id: 'd6_c' },
                    { loc: '黑星医院', id: 'd6_d' },
                    { loc: '议会大楼', time: [20, 21.5], id: 'd6_e' },
                    { loc: '湖区', time: [13, 18], id: 'd6_f' }
                ]
            },
            7: {
                startTxt: ">>> 第七天",
                paper: `<p>“黑星医院院长表示，突发疾病已经得到有效遏制。至于某些关于冰淇淋致病的传言，希望广大居民不要相信一些不正当渠道的谣言。”</p><p>“活出你的精彩！首届‘小镇生活家’评选今日开启。展示美丽人生的不同选择！”</p>`,
                hotlines: [
                    { time: 8.05, id: 'h7_begg_hater', text: "贝格女士的读书会整个就是一个邪教！你们这些电台的，快揭露他们呀！" },
                    { time: 8.52, id: 'h7_mimi', text: "喂，是我，米米。你之前好奇的那件事，我或许可以为你提供一些线索。我们的镇图书馆，有一些关于小镇历史的记录，锁在B09阅览室。我运用了一些小技俩，让这道门，恰恰在今天上午10:30~12:00开着。你懂我的意思吧。" },
                    { time: 9.3, id: 'h7_harry', text: "喂？我是哈里。你看今天晨报了吗？人家管咱们叫什么来着？对喽！‘不正当渠道’！我早说过了，对你没有别的要求，不给我惹麻烦就行。你就非要当个出头鸟是吗？" },
                    { time: 10.16, id: 'h7_jeff_fan', text: "你们电台……不要乱说杰弗里院长的坏话！她可是个大好人！我女儿之前的手术费还是她垫付的！" },
                    { time: 11.0, id: 'h7_nana', text: "你好，我是娜娜，之前联系过你。我有个新想法，我想竞选小镇生活家。如果你愿意采访我的话，请在下午14:00来公寓附近的咖啡厅和我见面吧！" },
                    { time: 12.4, id: 'h7_nana_miss', text: " 天呐……又有人在211便利店门口晕倒了……以前那个灰色头发小姑娘在的时候，会手脚麻利地给犯了低血糖的人嘴里塞一块巧克力。这个老杰米，就眼睁睁地看着人倒在他面前、眼睛都不眨一下！“" },
                    { time: 13.0, id: 'h7_sean', text: "你好，我叫塞恩，我的朋友娜娜鼓励我参与小镇生活家竞选。娜娜说，她想找你做个采访和宣传。我在想，我能不能也上一次你的夜间新闻？如果可以的话，请在17:00之后来中心广场找我，可以吗？我会等上两个小时！" }, // Changed to Library in event but hotline says Square. Let's stick to Text Event location: Library. WAIT text event says Library in v43 code, text says Library in event text.
                    { time: 14.07, id: 'h7_hacker', text: "电子锁这东西，真的没有安全隐患吗？会不会有那种黑客，用仪器对着门，唰地一下……所有门就全都开了！" },
                    { time: 15.0, id: 'h7_complain', text: "电台是吧？我想举报，楼下宣传板贴了那什么‘生活家’的花里胡哨海报——我可看明白了！全是空话套话。什么美丽人生不同选择，听听，这像正经人该琢磨的事吗？最可气的是我家那傻小子。昨天仰着脖子看了半天，回来跟我说：‘爸，我以后不想当医生了，我也要当生活家。’我问他生活家是干啥的，他支支吾吾地说‘就是活得特别有意思的人’。您听听！‘有意思’能当饭吃吗？能交水电费吗？" },
                    { time: 16.0, id: 'h7_kati', text: "你好，我是小卡提，我听你说树林里那个营地的事了，我妻子带我去过，我也感觉挺治愈的，但是，他们有一些活动让我很难理解，比如在镜湖边上念念叨叨……那到底是在干什么呀？今晚他们就有活动，好像是八点半左右，你能过去看看吗？" },
                    { time: 16.26, id: 'h7_vincent', text: "喂，是我，文森特。我问了很多人瀑布谷的事，没有一个人知道！咱们这年纪最大的人都是在1960年代迁居过来的……" },
                    { time: 17.5, id: 'h7_pill', text: "医院开的药很好用，吃完就退烧了！但他们不让我回家，还拿一堆仪器在我身上捅来捅去！这叫什么事儿……" },
                    { time: 18.3, id: 'h7_goodidea', text: "时光胶囊这个点子不错。我也想做一个！就埋在……公寓楼下！" },
                    { time: 19.2, id: 'h7_chicken', text: "那个变异狗真吓人！你说它是不是吃了变异的鸡肉？我听说，那种快餐店的鸡，长着四只翅膀、六条腿……" },
                    { time: 20.0, id: 'h7_allen', text: "呃，你好，我是，呃那个，艾伦。我发现了一些不得了的事情。我这会儿就在你的大本营……呃，对不起。但是，你能来找我一趟吗？" }
                ],
                events: [
                    { loc: '帷幕图书馆', time: [10.5, 12], id: 'd7_a' },
                    { loc: '回声公寓楼', time: [14, 16], id: 'd7_b' },
                    { loc: '中心广场', time: [17, 19], id: 'd7_c' },
                    { loc: '夜间广播站', time: [20, 21.75], id: 'd7_d' },
                    { loc: '湖区', time: [20.5, 22], id: 'd7_e' }
                ]
            },
            8: {
                startTxt: ">>> 第八天",
                paper: `<p>“帷幕图书馆凌晨发生小范围火灾，没有造成人员伤亡，图书馆部分阅览室封闭，其他区域和咖啡厅照常营业，请广大居民不必担心。”</p><p>“纪念碑计划正式启动！莫里斯镇长和加里先生将在<span class="hl-time">08:30</span>于议会大楼进行宣讲。为配合计划启动，并让居民更直观地体验相关技术成果，与之相配的新公共设施将于今晚<span class="hl-time">17:00~19:00</span>，在黑星医院东侧展厅进行预展示。请感兴趣的居民前来参观。”</p><p>“黑星医院应对突发疾病，医护人员短缺。黑星医院将引入归返者护士，知名企业家杰瑞米·加里将提供技术支持，宣导仪式将在<span class="hl-time">10:00</span>于日光商厦前举行，仪式过后，归返者会正式进入医院，为广大居民们、患者们带来更加便利、高效的就医服务。”</p><p>“重磅！奇幻爱情片《幸福回环》今日上映！环球电影院诚邀大家一同见证一场跨越时空的爱之奇迹。首场放映时间为<span class="hl-time">14：00</span>，欢迎居民们来环球电影院观看。”</p><p>“活出你的精彩！小镇生活家竞选大赛第一阶段已圆满结束！目前回声公寓内每个单元已经张贴初选结果，敬请各位居民多多关注。”</p>`,
                hotlines: [
                    { time: 8.04, id: 'h8_mimi_fire', text: "喂，我是米米。今天凌晨图书馆发生火灾了，就在档案室的位置！太蹊跷了！这绝对不是巧合！" },
                    { time: 9.40, id: 'h8_monument_rumor', text: "纪念碑计划？我的老天爷，现在外边的技术水平都到这种程度了？我读书少，你们可别骗我！" },
                    { time: 10.3, id: 'h8_allen_leave', text: "嗨，我是艾伦。昨天在电台听到丽莎的位置之后，我激动得没睡好觉！所以……今天起晚了。不过，我这就准备出发了！等我好消息吧！" },
                    { time: 11.26, id: 'h8_mars', text: "你好。我叫马尔斯，是一名律师，你经常广播一些奇怪的事情，所以我想，嗯，跟你打听一下。我的妻子，海莉，总说什么我们都是罪人，需要清理掉身上的肮脏之类的。你说她是不是中邪了？" },
                    { time: 12.35, id: 'h8_lake_beauty', text: "我从来没有见过这么美丽的景象……镜湖之上，无数颗星星在夜空中缓慢旋转，每一颗下坠的星芒，都拖着一条细长的、彩虹般的尾迹……啊！生命！啊！伟大的神明！我赞美您！" },
                    { time: 13.36, id: 'h8_sybil', text: "喂？你好。我是西比尔。我听有人谈论我们林区小小营地的事情了。我觉得这里面肯定是有什么误会。这样吧，我们正在准备一个森林派对活动，明天，你可以亲眼来看看。" },
                    { time: 14.28, id: 'h8_allen_fail', text: "喂，我是艾伦……我在……离咱们南出口大约150公里的地方……的确路过了一个加油站，但是已经废弃了。我的油箱撑不住我再往前了，我现在准备返回。可惜……没能找到丽莎。" },
                    { time: 15.05, id: 'h8_mimi_warn', text: "嘿，老伙计，我是米米。我最近感觉不太对……可能有事要发生了。你自己千万要小心。" },
                    { time: 16.3, id: 'h8_allen_mom', text: "喂，电台吗？我是艾伦的妈妈，就是想问问……艾伦这孩子，最近是不是常去你们那儿？没给你们添麻烦吧？之前他鼓捣那些无线电，我说了些重话……他是个好孩子……要是他想用你们那边的设备……您要不就借他使使？我私下给您点钱也行。" },
                    { time: 17.46, id: 'h8_reader', text: "你好……听了你最近几天的广播，我感觉我好像看到过月湖镇之类的说法。我刚想起来，就是在图书馆见到的，有几个不知所云的文件，夹在一本旧的《军事月刊》杂志里面……天呐，今天那里还发生了火灾！不知道那几张纸还在不在，如果你这会儿去，可以找找看……如果你不感兴趣的话，明天我来拿走。" },
                    { time: 18.44, id: 'h8_movie_cry', text: "看完《幸福回环》我哭了一下午！如果我也能切除掉痛苦的记忆就好了！" },
                    { time: 19.2, id: 'h8_allen_no', text: "嗨，是我，艾伦，今天不用来电台找我了，我就来了一小会儿，没有收到丽莎的消息，就先走了。噢对了，我妈做了苹果派，说让我明天给你带点。我还纳闷，你俩怎么认识的？她也不跟我说。总之，这几天我还会偷偷过去，一有消息我就给你打电话！" },
                    { time: 20.27, id: 'h8_patient_feel', text: "那些归返者……被他们的手臂架起来的时候，我感觉自己不是病人而是犯人……" },
                    { time: 21.0, id: 'h8_harry_warn', text: "喂？我是哈里，你又去湖区了？我跟你说，别跟那帮人走得太近了。也别信他们的鬼话，一个字都别信。懂吗？" }
                ],
                events: [
                    { loc: '议会大楼', time: [8.5, 10], id: 'd8_a' },
                    { loc: '黑星医院', time: [17, 19], id: 'd8_b' },
                    { loc: '环球电影院', time: [14, 18], id: 'd8_c' },
                    { loc: '日光商厦', time: [10, 12], id: 'd8_d' },
                    { loc: '黑星医院', time: [14, 22], id: 'd8_e' },
                    { loc: '帷幕图书馆', time: [17.47, 22], id: 'd8_f' }
                ]
            },
            9: {
                startTxt: ">>> 第九天",
                paper: `<p>“活出你的精彩！‘小镇生活家’第一轮评选结果刚刚公布！谁的生活方式最受欢迎？评选结果公告已张贴于各单元一楼公共区域。下一轮评选将于一周后启动，请各位参选居民积极准备，并欢迎邀请家人、朋友为您投出宝贵的一票！”</p><p>“黑星医院归返者医疗团队应用智能化护理系统，平均为每位患者节省了约30%的候诊与护理等待时间。”</p>`,
                hotlines: [
                    { time: 8.22, id: 'h9_harry_fire', text: "喂，我，哈里。你天天都在瞎播什么狗屁不通的玩意？你这活儿不想干了是吧？" },
                    { time: 9.18, id: 'h9_riot', text: "哎呀，黑星医院出事了！打起来了！" },
                    { time: 10.02, id: 'h9_mimi_tip', text: "是我，米米。你有没有想过，纪念碑计划、归返者计划，这事是早就安排好的，不然为什么几年前死掉的人也做了防腐？" },
                    { time: 11.35, id: 'h9_robot_comp', text: "这些邮政机器人真是烦死了！简直像永远打不通的客服电话，跟它说话和走迷宫有什么区别……" },
                    { time: 12.0, id: 'h9_ufo_drug', text: "你知道哪里能弄到那种能看见UFO的药吗？我挺想……试试的！试试应该没有关系的吧？嘿嘿。" },
                    { time: 12.22, id: 'h9_vincent', text: " 喂？是我，文森特，梅尔维尔出事了，你快来！" },
                    { time: 13.5, id: 'h9_nana_win', text: "嘿，我是娜娜。谢谢你上次在广播里讲我的事情，我在6单元的生活家竞选中获得了第一名！我太开心了！虽然最近也有让人烦恼的事情……之前医院不是缺人手吗？我本想去当实习护士的，但现在那些归返者……哎。总之，感谢你的帮助！下次请你喝咖啡！" },
                    { time: 14.2, id: 'h9_skeptic', text: "月湖镇，UFO，归返者……天呐，我宁愿你在播的是一档讲故事的节目！我早就说这小镇里的人不正常……" },
                    { time: 15.0, id: 'h9_monument_ok', text: "纪念碑计划……这东西靠谱吗？如果从此以后真的能和家人朋友一直在一起，好像也不错？" },
                    { time: 15.44, id: 'h9_sybil_party', text: "嘿，我是西比尔，派对将会在下午17:00举行，贝格女士邀请你和我们共进晚餐！湖区的所有居民们都热烈期盼着你的到来。" },
                    { time: 16.0, id: 'h9_hosp_riot', text: "医院……医院乱成一锅粥了！大厅里挤满了人，药片扔得到处都是！有人直接冲到导诊台把归返者推倒了……玻璃都碎了！" },
                    { time: 17.0, id: 'h9_begg_med', text: "贝格女士早就告诉我们不要吃药、不要有点不舒服就往医院跑！自然疗法才是最好的！医院……全是害人精！贝格女士是对的！" },
                    { time: 17.35, id: 'h9_gone', text: "天呐，医院这儿……杰弗里院长被他们带走了……！他们会把她带去哪儿？" },
                    { time: 18.4, id: 'h9_jflgood', text: "秃山下面埋了什么？！杰弗里到底在说什么？" },
                    { time: 20.0, id: 'h9_sean_fail', text: "你好，我是塞恩。你还记得我吗？我在11单元的生活家竞选中失败了。我有点沮丧。我本想靠这个事情能有点知名度，然后把我的产品专利卖出去。但是好像没有什么人感兴趣。大家每天谈论的都是那些……疾病、收入、归返者之类的事情，每个人都神经紧绷得要命……我在想，我是不是没有遇上好的时机……" },
                    { time: 21.0, id: 'h9_pill_ask', text: "喂？我还能吃好睡片吗？医生说出事儿了之后不敢给开药了，我觉得他在暗示我可以偷偷吃……哎呦！真疼啊！我到底该听谁的啊？" }
                ],
                events: [
                    { loc: '黑星医院', time: [9.19, 12], id: 'd9_a' },
                    { loc: '松鼠旅社', time: [12.23, 15.3], id: 'd9_b' },
                    { loc: '湖区', time: [17, 20], id: 'd9_c' },
                    { loc: '黑星医院', time: [16, 17.3], id: 'd9_d' },
                    { loc: '黑星医院', time: [17.36, 18.4], id: 'd9_e' }
                ]
            },
            10: {
                startTxt: ">>> 第十天",
                paper: `<p>“莫里斯镇长表示，昨日黑星医院院长杰弗里的指控严重偏离事实，镇议会将予以追究，并即刻撤销其院长一职。加里先生暂接替杰弗里承担医院的部分行政管理工作。新任院长人选将在下周公布。”</p><p>“面对近期部分居民的质疑，莫里斯镇长将于今日上午10:00在议会大楼召开新闻发布会。”</p><p>“加里先生声明：归返者的操作程序符合最高安全标准，黑星医院将进一步规范医患行为守则，一切为了患者的康复。”</p>`,
                hotlines: [
                    { time: 8.01, id: 'h10_mimi', text: "你知道弗兰肯斯坦的怪人吗？那些归返者应该是被内置了生物电机。把死人零件重新接线、还能让它们走路、微笑……这叫什么？这叫生活模仿艺术……" },
                    { time: 8.6, id: 'h10_nana_protest', text: "我是娜娜。我们楼的人组织了抗议活动！大家受够了那些代替诡异的归返者了。我们会在中心广场游行，你会来报道吗？" },
                    { time: 9.1, id: 'h10_hosp_leave', text: "医院真的不能待了！大家都在谈论昨天的事情……很多患者都在强烈要求出院……" },
                    { time: 9.5, id: 'h10_sean_strike', text: "喂？听得清吗？我是塞恩，我今天来面试，看日光商厦门口聚集了很多人。听他们讲，一会儿要往议会大楼那边去。我猜是跟镇长的新闻发布会有关系。" },
                    { time: 10.15, id: 'h10_doc_complain', text: "我是黑星医院的一名普通医生，患者都在拿我们撒气……我们真的已经尽力了！杰弗里院长被带走之后，我们尽量控制住了那些归返者、不让它们参与任何事情，但是……现在患者完全不听我们的话，甚至拒绝在上手术台前打麻药……" },
                    { time: 11.03, id: 'h10_nana_win', text: "喂？我是娜娜！他们终于要换掉归返者了，刚才商厦通知我明天回211便利店上班！太好了……抗争带来胜利，我的朋友！" },
                    { time: 12.12, id: 'h10_vincent_map', text: "嗨，是我，文森特。梅尔维尔整理东西时发现，他有张地图因为掉在床缝里，算是逃过一劫……我发现这上面也有些古怪。你快来。" },
                    { time: 12.8, id: 'h10_noise1', text: "世界末日到了，也得上班！哈哈哈哈哈哈哈哈哈哈哈……全都毁灭吧！哈哈哈哈哈哈哈……" },
                    { time: 13.38, id: 'h10_noise2', text: "（信号干扰，难以辨认的声音）" },
                    { time: 14.1, id: 'h10_noise3', text: "（信号干扰，难以辨认的声音）" },
                    { time: 14.54, id: 'h10_davin_jam', text: "喂，我是达文虎克，就在刚才！我发现我们的信号被干扰了。那会儿所有人的电话应该都打不通！" },
                    { time: 15.27, id: 'h10_davin_jam2', text: "喂，还是我，达文虎克。现在应该能够正常通话了，刚才我一直在查到底是哪里出了问题，我发现好像是有人蓄意屏蔽了信号。" },
                    { time: 16.17, id: 'h10_allen_lisa', text: "是我，艾伦！我前两天一直联系不上丽莎，但现在我终于又收到信号了！快来广播站！" },
                    { time: 17.35, id: 'h10_mimi_out', text: "嘿，我，米米。你的那些懂电波的朋友，艾伦和达文虎克，能让我们联系到外边吗？我是指县治安办公室、联邦紧急事务管理局、业余无线电爱好者网络之类的……" },
                    { time: 18.27, id: 'h10_daven_fail', text: "喂，是我，达文虎克，你刚才跟我说的那事儿，我试着拨了报纸上那些机构的电话，但全是空号，我怀疑那些电话是胡乱写上的。" },
                    { time: 19.00, id: 'h10_daven_idea', text: "还是我，达文虎克。我琢磨了一下，咱们可以利用观景台那个大天线试试看。我现在就出发，半个小时以内到！" },
                    { time: 19.30, id: 'h10_danger', text: "喂，是我，米米。我感觉有点不妙……刚才好像有人跟……" },
                    { time: 19.55, id: 'h10_wife', text: "喂？是我，达琳。我丈夫达文虎克最近越来越魔怔了。不过发生了这么多事，我感觉他说的也有道理。他刚才冲出门，说要干件大事，我拦都拦不住。你要是见着他，别让他由着性子胡来。我可不想哪天去警察局领人。" },
                    { time: 21.0, id: 'h10_dangerrr', text: "（撞击声、奇怪的杂音）" }
                ],
                events: [
                    { loc: '中心广场', time: [8.7, 10], id: 'd10_a' },
                    { loc: '议会大楼', time: [10, 12], id: 'd10_b' },
                    { loc: '深空观景台', time: [19.17, 21], id: 'd10_c' },
                    { loc: '松鼠旅社', time: [12.13, 16], id: 'd10_d' },
                    { loc: '中心广场', time: [16.01, 19.3], id: 'd10_e' },
                    { loc: '夜间广播站', time: [16.18, 20], id: 'd10_f' }
                ]
            },
            11: {
                startTxt: ">>> 第十一天 (终局)",
                paper: `<p>“紧急通知！镇南公路出现局部地表塌陷。目前，相关部门已设置警戒区域并开展应急勘察与抢修。请所有居民近日尽量避免驾车或步行进入镇南公路相关路段。”</p>`,
                hotlines: [
                    { time: 8.02, id: 'h11_trap', text: "镇南公路被封锁了……这是唯一一条出镇的公路，我们被困在这里了！" },
                    { time: 8.34, id: 'h11_council', text: "你好。我有一些事情想说，关于那个孩子……萨曼莎·贝格……请来回声公寓1单元门口的小花园找我。" },
                    { time: 9.33, id: 'h11_scare', text: "天呐。我真的不想看见这些死人出现在小区楼下！刚刚她冲我眨了下眼睛，我魂儿都快吓飞了！" },
                    { time: 10.15, id: 'h11_body', text: "议会大楼后边的巷子里……我刚明明看到有个女人被盖上白布抬走了！我跟别人打听，没有人知道怎么一回事！那个人是死了吗？" },
                    { time: 11.1, id: 'h11_harry', text: "喂？我是哈里，今天米米有联系过你吗？如果她找你了，你就跟她说让她给我打电话。我找她有事。" },
                    { time: 11.41, id: 'h11_call', text: "喂。电台吗？你不需要知道我的名字，我要说的是，这里，整个小镇，并不是没有人像你一样意识到一些……问题。但是，他们选择闭嘴。是的，人们会生病，是的，人们服下奇怪的药片，那又能怎样呢？生活依然在继续，一切也并不是那么糟糕，不是吗？" },
                    { time: 12.23, id: 'h11_doc', text: "你好。我是黑星医院的医生普拉，我在收拾杰弗里院长、呃、前院长的办公室的时候，看到她写的一些笔记。这些内容和你最近报道的事情有关，非常可怕……我并不想拿在手里……天呐……我想，我可以把这份笔记交给你。" },
                    { time: 12.56, id: 'h11_n1', text: "（信号干扰，难以辨认的声音）" },
                    { time: 13.18, id: 'h11_daven', text: "噢，该死。喂？啊，听得到？喂？是我，达文虎克，刚刚信号好像又被屏蔽了。" },
                    { time: 13.5, id: 'h11_donate', text: "杰弗里院长……我不敢相信！我爸爸因为肺病没办法工作，一直以来都是接受院长和加里先生那个慈善基金会的捐赠……你现在说，他们是坏人？" },
                    { time: 14.35, id: 'h11_n4', text: "（信号干扰，难以辨认的声音）" },
                    { time: 15.00, id: 'h11_harry2', text: "喂？是我，哈里，还没联系上米米呢？这人到底去哪儿了？" },
                    { time: 15.4, id: 'h11_phone', text: "喂？电台吗？我举报！最近电话老出问题！我这谈正事儿呢！聊着聊着就给我断了，简直……烦……" },
                    { time: 16.13, id: 'h11_n2', text: "向外界传输数据的流星……原来如此！我一直觉得自己被监控了！在我上厕所时或者偷看自己喜欢的女孩时……我总感觉有人看着我！" },
                    { time: 17.40, id: 'h11_n3', text: "（信号干扰，难以辨认的声音）" },
                    { time: 18.27, id: 'h11_allen', text: "我是……艾、艾伦，刚才，好像很多波段都失灵了，我、我调试设备，想联系上丽莎……结果，我收到了一段……本地的、加密的短波传输。大事不妙了，我天，你、你能过来吗？" },
                    { time: 19.55, id: 'h11_daven2', text: "喂？听得见吗？我是达文虎克。马上又会是一波通讯干扰！一会儿估计什么电话都打不进来，你快带着艾伦来观景台！" }
                ],
                events: [
                    { loc: '回声公寓楼', time: [8.35, 12.3], id: 'd11_a' },
                    { loc: '黑星医院', time: [12.24, 15], id: 'd11_b' },
                    { loc: '夜间广播站', time: [18.28, 20], id: 'd11_c' },
                    { loc: '深空观景台', time: [20, 22], id: 'd11_d' }
                ]
            }
        };

        // --- State Management ---
        let state = {
            day: 1, hour: 8, minute: 0, location: '夜间广播站',
            collectedCards: [], deducedNews: [], deducedEvents: [], completedReviews: [],
            archives: { loc: [], char: [] },
            archiveUnlockDays: { loc: {}, char: {} }, // 记录每个档案解锁时的天数
            notifications: { archive: false, event: false },
            readArchiveKeys: [], readReviews: []
        };
        let broadcastSlots = [null, null, null, null];
        let isNight = false, isBroadcasting = false, typeInterval = null;
        let isTransitioning = false;
        let visualizerInterval = null; // Global for audio visualizer animation
        let isTeleprompterTyping = false; // Track typing status
        let isFastWalkActive = false; // 快脚模式激活开关
        let isMusicActive = false; // 音乐激活开关

        // --- Core Functions ---
        function init() {
            const saved = localStorage.getItem('ArcLight_v1226_Conspiracy');
            if (saved) {
                state = JSON.parse(saved);
                if (!state.readArchiveKeys) state.readArchiveKeys = [];
                if (!state.readReviews) state.readReviews = [];
            }

            // 初始化 archiveUnlockDays（兼容旧存档）
            if (!state.archiveUnlockDays) state.archiveUnlockDays = { loc: {}, char: {} };
            if (!state.archiveUnlockDays.loc) state.archiveUnlockDays.loc = {};
            if (!state.archiveUnlockDays.char) state.archiveUnlockDays.char = {};

            // Initial unlocks
            unlockArchive('loc', '夜间广播站'); unlockArchive('char', '老哈里'); unlockArchive('char', '米米');
            // 初始解锁的档案标记为第0天（重置时不会被清除）
            if (state.archives.loc.includes('夜间广播站') && !state.archiveUnlockDays.loc['夜间广播站']) {
                state.archiveUnlockDays.loc['夜间广播站'] = 0;
            }
            if (state.archives.char.includes('老哈里') && !state.archiveUnlockDays.char['老哈里']) {
                state.archiveUnlockDays.char['老哈里'] = 0;
            }
            if (state.archives.char.includes('米米') && !state.archiveUnlockDays.char['米米']) {
                state.archiveUnlockDays.char['米米'] = 0;
            }

            if (state.day === 1 && state.hour === 8 && state.collectedCards.length === 0) {
                updateStatusText(dayConfig[1].startTxt);
                setTimeout(() => { document.getElementById('intro-modal').style.display = 'flex'; }, 500);
            } else if (state.hour === 8) {
                if (dayConfig[state.day]) updateStatusText(dayConfig[state.day].startTxt);
            }

            loadFastWalk();
            loadMusic();
            loadNotepad();

            updateUI(); renderCollectedNews(); renderCollectedEvents();
        }

        function save() { localStorage.setItem('ArcLight_v1226_Conspiracy', JSON.stringify(state)); }

        // --- New Map Lock Logic ---
        function updateMapLocks() {
            // Day 1: Square, Library, Apt, Radio
            let allowed = ['中心广场', '回声公寓楼', '帷幕图书馆', '夜间广播站'];

            // Day 2: + Market, Council, Viewpoint, Hotel
            if (state.day >= 2) {
                allowed.push('议会大楼', '阿卡姆集市', '松鼠旅社', '深空观景台');
            }

            // Day 3: + Mall, Cinema
            if (state.day >= 3) {
                allowed.push('日光商厦', '环球电影院');
            }

            // Day 4+: + Hospital, Lake (All open)
            if (state.day >= 4) {
                allowed.push('黑星医院', '湖区');
            }

            const nodes = document.querySelectorAll('.map-node');
            nodes.forEach(node => {
                const clickAttr = node.getAttribute('onclick');
                if (clickAttr) {
                    const locName = clickAttr.split("'")[1];
                    if (allowed.includes(locName)) {
                        node.classList.remove('locked-node');
                    } else {
                        node.classList.add('locked-node');
                    }
                }
            });

            // Day 11 Mimi Button Lock
            const btnMimi = document.getElementById('btn-mimi');
            if (state.day === 11) {
                btnMimi.classList.add('btn-disabled');
                btnMimi.innerHTML = "？呼叫米米";
                btnMimi.onclick = null;
            } else {
                btnMimi.classList.remove('btn-disabled');
                btnMimi.innerHTML = "？呼叫米米 (-2H)";
                btnMimi.onclick = callMimi;
            }
        }

        function updateUI() {
            let h = Math.floor(state.hour);
            let m = Math.round((state.hour - h) * 60);
            if (m >= 60) { h++; m = 0; }
            document.getElementById('clock-display').innerText = `${h < 10 ? '0' + h : h}:${m < 10 ? '0' + m : m}`;
            document.getElementById('day-display').innerText = `第${state.day}天`;

            document.getElementById('dot-archive').style.display = state.notifications.archive ? 'block' : 'none';
            document.getElementById('dot-event').style.display = state.notifications.event ? 'block' : 'none';

            updateMapLocks();

            // Update current location highlight on map
            document.querySelectorAll('.map-node').forEach(node => {
                node.classList.remove('current-location');
            });
            const currentNode = findNodeByName(state.location);
            if (currentNode) {
                currentNode.classList.add('current-location');
            }
        }

        function addTime(hours, updated = true) {
            if (isNight) return;
            let stateHour = state.hour + hours;
            stateHour = Math.round(stateHour * 100) / 100;

            if (stateHour >= 22) {
                const todayNewsCount = getTodayNewsCount();
                const skipDays = state.day !== 11;
                if (todayNewsCount < 3 && skipDays) {
                    if (confirm('看起来没有收集到足够的新闻，要回到今天早上重新开始吗？')) {
                        restartDay(true);
                        return;
                    }
                    if (stateHour >= 24) {
                        return;
                    }
                }
                triggerNight();
            }

            if (updated) {
                state.hour = stateHour;
                if (state.hour >= 24) {
                    state.hour = 24;
                }
            }
            checkHotlines(); updateUI(); save();
        }

        function checkHotlines() {
            const hots = dayConfig[state.day]?.hotlines || [];
            hots.forEach(h => {
                if (state.hour >= (h.time - 0.01) && !state.collectedCards.includes(h.id)) {
                    state.collectedCards.push(h.id);
                    updateStatusText(`>>> [居民热线] 收到新情报...`);
                    showHotlinePopup(h.text);
                }
            });
        }

        function showHotlinePopup(text) {
            const modal = document.getElementById('hotline-popup-modal');
            document.getElementById('hotline-popup-content').innerHTML = parseTextForArchive(text);
            modal.style.display = 'flex'; modal.classList.remove('shake-anim'); void modal.offsetWidth; modal.classList.add('shake-anim');
        }

        function updateStatusText(text) {
            const el = document.getElementById('status-text');
            clearInterval(typeInterval); el.innerText = ""; let i = 0;
            typeInterval = setInterval(() => {
                if (i < text.length) { el.innerText += text.charAt(i); i++; }
                else { clearInterval(typeInterval); }
            }, 30);
        }

        function findNodeByName(name) {
            const nodes = document.querySelectorAll('.map-node');
            for (let node of nodes) {
                // Check innerText or onclick attribute
                if (node.innerText.includes(name) || (node.getAttribute('onclick') && node.getAttribute('onclick').includes(`'${name}'`))) {
                    return node;
                }
            }
            return null;
        }

        // --- Pathfinding Helpers ---

        function getNodeRects(mapRect) {
            const nodes = Array.from(document.querySelectorAll('.map-node'));
            return nodes.map(n => {
                const r = n.getBoundingClientRect();
                return {
                    left: r.left - mapRect.left,
                    top: r.top - mapRect.top,
                    right: r.right - mapRect.left,
                    bottom: r.bottom - mapRect.top,
                    width: r.width,
                    height: r.height,
                    element: n
                };
            });
        }

        function lineIntersectsRect(x1, y1, x2, y2, rx, ry, rw, rh) {
            const minX = Math.min(x1, x2), maxX = Math.max(x1, x2);
            const minY = Math.min(y1, y2), maxY = Math.max(y1, y2);

            if (maxX < rx || minX > rx + rw || maxY < ry || minY > ry + rh) return false;

            if (Math.abs(x1 - x2) < 0.1) { // Vertical
                return (x1 >= rx && x1 <= rx + rw) && (Math.max(minY, ry) < Math.min(maxY, ry + rh));
            } else if (Math.abs(y1 - y2) < 0.1) { // Horizontal
                return (y1 >= ry && y1 <= ry + rh) && (Math.max(minX, rx) < Math.min(maxX, rx + rw));
            }
            return true;
        }

        function checkCollision(x1, y1, x2, y2, rects, ignoreNode1, ignoreNode2) {
            const padding = 10; // Clearance
            for (let r of rects) {
                if (r.element === ignoreNode1 || r.element === ignoreNode2) continue;
                const rx = r.left - padding;
                const ry = r.top - padding;
                const rw = r.width + padding * 2;
                const rh = r.height + padding * 2;
                if (lineIntersectsRect(x1, y1, x2, y2, rx, ry, rw, rh)) return true;
            }
            return false;
        }

        function calculatePolylinePath(startNode, endNode) {
            const mapRect = document.getElementById('map-section').getBoundingClientRect();
            const rects = getNodeRects(mapRect);

            const r1 = startNode.getBoundingClientRect();
            const r2 = endNode.getBoundingClientRect();

            const x1 = r1.left + r1.width / 2 - mapRect.left;
            const y1 = r1.top + r1.height / 2 - mapRect.top;
            const x2 = r2.left + r2.width / 2 - mapRect.left;
            const y2 = r2.top + r2.height / 2 - mapRect.top;

            const pStart = { x: x1, y: y1 };
            const pEnd = { x: x2, y: y2 };

            // 1. Try L-shapes (HV & VH)
            if (!checkCollision(x1, y1, x2, y1, rects, startNode, endNode) &&
                !checkCollision(x2, y1, x2, y2, rects, startNode, endNode)) {
                return [pStart, { x: x2, y: y1 }, pEnd];
            }
            if (!checkCollision(x1, y1, x1, y2, rects, startNode, endNode) &&
                !checkCollision(x1, y2, x2, y2, rects, startNode, endNode)) {
                return [pStart, { x: x1, y: y2 }, pEnd];
            }

            // 2. Scan for Mid-X (Vertical Gutters)
            // Helpers
            const checkMidX = (midX) => {
                if (!checkCollision(x1, y1, midX, y1, rects, startNode, endNode) &&
                    !checkCollision(midX, y1, midX, y2, rects, startNode, endNode) &&
                    !checkCollision(midX, y2, x2, y2, rects, startNode, endNode)) {
                    return [pStart, { x: midX, y: y1 }, { x: midX, y: y2 }, pEnd];
                }
                return null;
            };
            const checkMidY = (midY) => {
                if (!checkCollision(x1, y1, x1, midY, rects, startNode, endNode) &&
                    !checkCollision(x1, midY, x2, midY, rects, startNode, endNode) &&
                    !checkCollision(x2, midY, x2, y2, rects, startNode, endNode)) {
                    return [pStart, { x: x1, y: midY }, { x: x2, y: midY }, pEnd];
                }
                return null;
            };

            // Scan strategy: Start from center between points and expand outwards, 
            // then scan the rest of the map if needed.

            const minX = Math.min(x1, x2), maxX = Math.max(x1, x2);
            const minY = Math.min(y1, y2), maxY = Math.max(y1, y2);
            const step = 15;

            // Scan inside box first
            for (let mx = minX + step; mx < maxX; mx += step) {
                let p = checkMidX(mx); if (p) return p;
            }
            for (let my = minY + step; my < maxY; my += step) {
                let p = checkMidY(my); if (p) return p;
            }

            // Scan outside box (Detour) - Scan full map width/height
            const mapW = mapRect.width;
            const mapH = mapRect.height;

            // Scan X
            for (let mx = step; mx < mapW; mx += step) {
                // Skip if already scanned (optimization skipped for simplicity/robustness)
                let p = checkMidX(mx); if (p) return p;
            }
            // Scan Y
            for (let my = step; my < mapH; my += step) {
                let p = checkMidY(my); if (p) return p;
            }

            // Fallback: HV
            return [pStart, { x: x2, y: y1 }, pEnd];
        }
        function getPathPoint(path, progress) {
            let totalLen = 0;
            const lengths = [];
            for (let i = 0; i < path.length - 1; i++) {
                const dx = path[i + 1].x - path[i].x;
                const dy = path[i + 1].y - path[i].y;
                const len = Math.sqrt(dx * dx + dy * dy);
                lengths.push(len);
                totalLen += len;
            }

            if (totalLen === 0) return path[0];
            const targetLen = totalLen * progress;
            let currentLen = 0;

            for (let i = 0; i < lengths.length; i++) {
                if (currentLen + lengths[i] >= targetLen) {
                    const segmentProg = (targetLen - currentLen) / lengths[i];
                    const p1 = path[i];
                    const p2 = path[i + 1];
                    return {
                        x: p1.x + (p2.x - p1.x) * segmentProg,
                        y: p1.y + (p2.y - p1.y) * segmentProg
                    };
                }
                currentLen += lengths[i];
            }
            return path[path.length - 1];
        }

        function drawIdleAnimation(node) {
            const svg = document.getElementById('map-lines');
            if (!svg || !node) return;

            const mapRect = document.getElementById('map-section').getBoundingClientRect();
            const r = node.getBoundingClientRect();
            // Position: Center horizontally, sit slightly above the node (top edge)
            const x = r.left + r.width / 2 - mapRect.left;
            const y = r.top - mapRect.top - 10;

            // 1. Walking Person Group
            const carGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');

            // Glow
            const glow = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
            glow.setAttribute('r', '8'); glow.setAttribute('fill', 'var(--term-main)'); glow.setAttribute('opacity', '0.6');
            carGroup.appendChild(glow);

            // Style
            const strokeStyle = { 'stroke': '#fff', 'stroke-width': '2', 'stroke-linecap': 'round' };
            const setAttrs = (el, attrs) => { for (let k in attrs) el.setAttribute(k, attrs[k]); for (let k in strokeStyle) el.setAttribute(k, strokeStyle[k]); };

            // Limbs
            const legL = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            setAttrs(legL, { x1: 0, y1: 0, x2: 0, y2: 5 }); carGroup.appendChild(legL);

            const armL = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            setAttrs(armL, { x1: 0, y1: -3.5, x2: 0, y2: 0 }); carGroup.appendChild(armL);

            const body = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            setAttrs(body, { x1: 0, y1: -4, x2: 0, y2: 0, 'stroke-width': '2' }); carGroup.appendChild(body);

            const legR = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            setAttrs(legR, { x1: 0, y1: 0, x2: 0, y2: 5 }); carGroup.appendChild(legR);

            const armR = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            setAttrs(armR, { x1: 0, y1: -3.5, x2: 0, y2: 0 }); carGroup.appendChild(armR);

            const head = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
            head.setAttribute('r', '3'); head.setAttribute('cx', '0'); head.setAttribute('cy', '-6'); head.setAttribute('fill', '#fff');
            carGroup.appendChild(head);

            carGroup.setAttribute('transform', `translate(${x}, ${y})`);
            svg.appendChild(carGroup);

            // Animation
            const duration = 1500; // Match stay delay
            const startTime = performance.now();

            function animate(currentTime) {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);

                // Idle Animation: Pacing or stepping in place
                const freq = 0.015;
                const range = 3;
                const sin = Math.sin(elapsed * freq);

                // Legs moving
                legL.setAttribute('x2', (sin * range).toString());
                legR.setAttribute('x2', (-sin * range).toString());

                // Arms moving opposite to legs
                armL.setAttribute('x2', (-sin * range).toString());
                armR.setAttribute('x2', (sin * range).toString());

                // Bobbing head/body
                const bounce = Math.abs(Math.sin(elapsed * freq * 2)) * 1;
                head.setAttribute('cy', (-6 - bounce).toString());
                body.setAttribute('y1', (-4 - bounce).toString());

                // Slight horizontal pacing (optional)
                const paceRange = 5;
                const paceX = Math.sin(elapsed * 0.005) * paceRange;
                // Flip if moving left
                const scaleX = (Math.cos(elapsed * 0.005) < 0) ? -1 : 1;

                carGroup.setAttribute('transform', `translate(${x + paceX}, ${y}) scale(${scaleX}, 1)`);

                if (progress < 1) {
                    requestAnimationFrame(animate);
                } else {
                    // Remove elements
                    setTimeout(() => {
                        if (carGroup.parentNode) carGroup.parentNode.removeChild(carGroup);
                    }, 100);
                }
            }
            requestAnimationFrame(animate);
        }

        function drawTravelLine(startNode, endNode) {
            if (!startNode || !endNode) return;
            const svg = document.getElementById('map-lines');
            if (!svg) return;

            // Calculate Orthogonal Path
            const pathPoints = calculatePolylinePath(startNode, endNode);
            const startPoint = pathPoints[0];

            // 1. 绘制折线轨迹 (Polyline Trail)
            const polyline = document.createElementNS('http://www.w3.org/2000/svg', 'polyline');
            const pointsStr = pathPoints.map(p => `${p.x},${p.y}`).join(' ');
            polyline.setAttribute('points', pointsStr);
            polyline.setAttribute('fill', 'none');
            polyline.setAttribute('stroke', '#00ccff');//blue color
            polyline.setAttribute('stroke-width', '2');
            polyline.setAttribute('stroke-dasharray', '4,6');
            polyline.setAttribute('stroke-opacity', '1');
            svg.appendChild(polyline);

            // 2. 步行小人 (Walking Person)
            const carGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');

            // Glow
            const glow = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
            glow.setAttribute('r', '8'); glow.setAttribute('fill', 'var(--term-main)'); glow.setAttribute('opacity', '0.6');
            carGroup.appendChild(glow);

            // Style
            const strokeStyle = { 'stroke': '#fff', 'stroke-width': '2', 'stroke-linecap': 'round' };
            const setAttrs = (el, attrs) => { for (let k in attrs) el.setAttribute(k, attrs[k]); for (let k in strokeStyle) el.setAttribute(k, strokeStyle[k]); };

            // Limbs
            const legL = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            setAttrs(legL, { x1: 0, y1: 0, x2: 0, y2: 5 }); carGroup.appendChild(legL);

            const armL = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            setAttrs(armL, { x1: 0, y1: -3.5, x2: 0, y2: 0 }); carGroup.appendChild(armL);

            const body = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            setAttrs(body, { x1: 0, y1: -4, x2: 0, y2: 0, 'stroke-width': '2' }); carGroup.appendChild(body);

            const legR = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            setAttrs(legR, { x1: 0, y1: 0, x2: 0, y2: 5 }); carGroup.appendChild(legR);

            const armR = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            setAttrs(armR, { x1: 0, y1: -3.5, x2: 0, y2: 0 }); carGroup.appendChild(armR);

            const head = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
            head.setAttribute('r', '3'); head.setAttribute('cx', '0'); head.setAttribute('cy', '-6'); head.setAttribute('fill', '#fff');
            carGroup.appendChild(head);

            carGroup.setAttribute('transform', `translate(${startPoint.x}, ${startPoint.y})`);
            svg.appendChild(carGroup);

            // --- Bubble Logic Start (HTML Overlay) ---
            let bubbleDiv = null;
            if (state.day < 10) {
                const joke = coldJokes[Math.floor(Math.random() * coldJokes.length)];
                const midPoint = getPathPoint(pathPoints, 0.5);
                const mapRect = document.getElementById('map-section').getBoundingClientRect();
                const screenX = mapRect.left + midPoint.x;
                const screenY = mapRect.top + midPoint.y - 80;

                bubbleDiv = document.createElement('div');
                bubbleDiv.innerText = joke;
                bubbleDiv.style.cssText = "position:fixed; left:" + screenX + "px; top:" + screenY + "px; transform:translate(-50%, 0); background:#fff; color:#000; border:2px solid #000; border-radius:5px; padding:10px; width:140px; font-family:'Courier New'; font-weight:bold; font-size:12px; text-align:center; z-index:10000; opacity:0; transition:opacity 0.3s; pointer-events:none; box-shadow:0 5px 15px rgba(0,0,0,0.5);";

                const tailDiv = document.createElement('div');
                tailDiv.style.cssText = "position:absolute; bottom:-6px; left:50%; transform:translateX(-50%) rotate(45deg); width:10px; height:10px; background:#fff; border-right:2px solid #000; border-bottom:2px solid #000;";
                bubbleDiv.appendChild(tailDiv);
                document.body.appendChild(bubbleDiv);
            }
            // --- Bubble Logic End ---

            // Animation
            const duration = TRAVEL_DURATION;
            const startTime = performance.now();
            let lastX = startPoint.x;

            // Show bubble after a short delay, once character starts moving
            setTimeout(() => { if (bubbleDiv) { bubbleDiv.style.opacity = '1'; } }, 100);

            // Cleanup bubble
            setTimeout(() => { if (bubbleDiv && bubbleDiv.parentNode) bubbleDiv.parentNode.removeChild(bubbleDiv); }, duration + 500);

            function animate(currentTime) {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);

                // Ease function
                const ease = 1 - Math.pow(1 - progress, 3);

                // Get current position on polyline
                const pos = getPathPoint(pathPoints, ease);

                // Orientation
                const scaleX = (pos.x < lastX) ? -1 : 1;
                if (Math.abs(pos.x - lastX) > 0.1) { // Only update if moving horizontally significantly
                    carGroup.setAttribute('transform', `translate(${pos.x}, ${pos.y}) scale(${scaleX}, 1)`);
                } else {
                    carGroup.setAttribute('transform', `translate(${pos.x}, ${pos.y}) scale(${carGroup.getAttribute('transform').includes('scale(-1') ? -1 : 1}, 1)`);
                }
                lastX = pos.x;

                // Limb Animation
                const freq = 0.015; const range = 3; const sin = Math.sin(elapsed * freq);
                legL.setAttribute('x2', (sin * range).toString());
                legR.setAttribute('x2', (-sin * range).toString());
                armL.setAttribute('x2', (-sin * range).toString());
                armR.setAttribute('x2', (sin * range).toString());

                const bounce = Math.abs(Math.sin(elapsed * freq * 2)) * 1;
                head.setAttribute('cy', (-6 - bounce).toString());
                body.setAttribute('y1', (-4 - bounce).toString());

                if (progress < 1) {
                    requestAnimationFrame(animate);
                } else {
                    // Remove elements
                    setTimeout(() => {
                        if (polyline.parentNode) polyline.parentNode.removeChild(polyline);
                        if (carGroup.parentNode) carGroup.parentNode.removeChild(carGroup);
                    }, 100);
                }
            }
            requestAnimationFrame(animate);
        }

        function travel(loc) {
            if (isNight) return;
            if (window.isTraveling) return;

            window.isTraveling = true;
            document.querySelectorAll('.map-node').forEach(n => n.style.pointerEvents = 'none');

            // Visual Effect
            const startNode = findNodeByName(state.location);
            const endNode = findNodeByName(loc);
            let delay = 0;
            const startHour = state.hour;

            const isAnimating = startNode && endNode && !isFastWalkActive;
            if (isAnimating) {
                const isStaying = startNode === endNode;

                if (!isStaying) {
                    drawTravelLine(startNode, endNode);
                    delay = TRAVEL_DURATION + 100; // Wait for animation + buffer
                } else {
                    drawIdleAnimation(startNode);
                    delay = 1500; // Shorter delay for staying
                    updateStatusText(">>> 在原地消磨时间...");
                }

                // Animate Clock (Common logic)
                const clockDisplay = document.getElementById('clock-display');
                clockDisplay.classList.add('clock-glow');

                const animDuration = isStaying ? 1500 : TRAVEL_DURATION;
                const animStartTime = performance.now();
                function animateClock(now) {
                    const elapsed = now - animStartTime;
                    const progress = Math.min(elapsed / animDuration, 1);
                    state.hour = startHour + (0.5 * progress);
                    updateUI();
                    if (progress < 1) {
                        requestAnimationFrame(animateClock);
                    } else {
                        clockDisplay.classList.remove('clock-glow');
                    }
                }
                requestAnimationFrame(animateClock);
            }

            setTimeout(() => {
                window.isTraveling = false;
                document.querySelectorAll('.map-node').forEach(n => n.style.pointerEvents = '');

                // 时间流逝逻辑
                addTime(0.5, !isAnimating);

                state.location = loc;
                unlockArchiveFromText(loc);

                const dayData = dayConfig[state.day]; if (!dayData) return;
                const possibleEvents = dayData.events.filter(e => e.loc === loc);
                let foundNew = false; let eventTriggered = null; let currentEventData = null;

                possibleEvents.forEach(evt => {
                    let timeMatch = true;
                    if (evt.time) {
                        if (state.hour < (evt.time[0] - 0.01) || state.hour >= (evt.time[1] + 0.01)) {
                            timeMatch = false;
                        }
                    }
                    if (timeMatch && !state.collectedCards.includes(evt.id)) {
                        state.collectedCards.push(evt.id); state.notifications.event = true;
                        foundNew = true; eventTriggered = eventCards[evt.id]; currentEventData = { ...evt, ...eventTriggered };
                        parseTextForArchive(eventTriggered.text);
                    }
                });
                if (foundNew && eventTriggered) {
                    showAutoEventModal(eventTriggered.text); updateStatusText(`>>> 在${loc}发现了关键情况。`);
                    // 添加到 deducedEvents
                    state.deducedEvents.push(currentEventData);
                } else { updateStatusText(`>>> 你来到了${loc}。看起来暂时风平浪静。`); }
                save(); updateUI(); renderCollectedEvents();
            }, delay);
        }

        function showAutoEventModal(desc) {
            const overlay = document.getElementById('auto-event-overlay');
            const drawer = document.getElementById('auto-event-drawer');
            const contentEl = document.getElementById('auto-event-content');
            const drawerContent = document.getElementById('auto-event-drawer-content');
            const progressBar = document.getElementById('auto-event-progress-bar');
            const mapSection = document.getElementById('map-section');

            // 清空内容并显示遮罩层
            contentEl.innerHTML = '';
            progressBar.style.width = '0%';

            overlay.style.zIndex = '100';
            overlay.style.opacity = '1';
            // 重置抽屉位置（在地图中间上方，完全隐藏）
            drawer.style.transform = 'translateY(200%)';

            // 触发滑出动画（从地图中间滑出）
            setTimeout(() => {
                drawer.style.transform = 'translateY(0)';
            }, 10);

            // 解析文本并分割成行
            const parsedText = parseTextForArchive(desc);
            // 将 <br> 标签替换为特殊标记，然后分割
            let lines = parsedText.split(/<br\s*\/?>/i).filter(line => line.trim() !== '');

            // 如果没有换行符，尝试按句号、问号、感叹号分割
            if (lines.length === 1 && lines[0]) {
                lines = lines[0].split('\n').filter(line => line.trim() !== '');
                // lines = lines[0].split(/([。！？\n])/).filter(line => line.trim() !== '');
                // // 将标点符号重新附加到前一句
                // const mergedLines = [];
                // for (let i = 0; i < lines.length; i++) {
                //     if (lines[i].match(/[。！？]/)) {
                //         if (mergedLines.length > 0) {
                //             mergedLines[mergedLines.length - 1] += lines[i];
                //         }
                //     } else {
                //         mergedLines.push(lines[i]);
                //     }
                // }
                // lines = mergedLines.filter(line => line.trim() !== '');
            }

            if (lines.length === 0) {
                progressBar.style.width = '100%';
                return;
            }

            let currentLineIndex = 0;
            let skipDelay = false; // 标志：是否跳过延迟
            let timeoutId = null; // 保存定时器ID，以便清除
            const lineDelay = 800; // 每行显示的延迟时间（毫秒）

            // 立即显示所有剩余行的函数
            function showAllRemainingLines() {
                skipDelay = true;
                if (timeoutId) {
                    clearTimeout(timeoutId);
                    timeoutId = null;
                }

                // 立即显示所有剩余的行
                while (currentLineIndex < lines.length) {
                    const lineDiv = document.createElement('div');
                    lineDiv.style.opacity = '1';
                    lineDiv.style.transform = 'translateY(0)';
                    lineDiv.style.transition = 'none';
                    lineDiv.innerHTML = lines[currentLineIndex];
                    contentEl.appendChild(lineDiv);
                    currentLineIndex++;
                }

                // 更新进度条到100%
                progressBar.style.width = '100%';
            }

            function showNextLine() {
                if (skipDelay) {
                    return;
                }

                if (currentLineIndex < lines.length) {
                    // 创建新行元素
                    const lineDiv = document.createElement('div');
                    lineDiv.style.opacity = '0';
                    lineDiv.style.transform = 'translateY(10px)';
                    lineDiv.style.transition = 'opacity 1.4s ease, transform 2s ease';
                    lineDiv.innerHTML = lines[currentLineIndex];
                    contentEl.appendChild(lineDiv);

                    const progressBarAnimateCallback = () => {
                        // 更新进度条
                        const progress = ((currentLineIndex + 1) / lines.length) * 100;
                        progressBar.style.width = progress + '%';

                        currentLineIndex++;

                        // 继续显示下一行
                        if (currentLineIndex < lines.length) {
                            timeoutId = setTimeout(showNextLine, lineDelay);
                        }
                    };

                    // 触发动画
                    setTimeout(() => {
                        lineDiv.style.opacity = '1';
                        lineDiv.style.transform = 'translateY(0)';

                        progressBarAnimateCallback();
                    }, 50);
                }
            }

            // 在 #auto-event-drawer-content 上添加点击事件，立即完成所有文本显示
            drawerContent.onclick = function () {
                if (!skipDelay && currentLineIndex < lines.length) {
                    showAllRemainingLines();
                }
            };

            // // 点击遮罩层外部关闭（滑回动画）
            // overlay.onclick = function (e) {
            //     if (e.target == overlay) {
            //         drawer.style.transform = 'translateY(200%)';
            //         overlay.style.opacity = '0';
            //         setTimeout(() => {
            //             overlay.style.zIndex = '-100';
            //             progressBar.style.width = '0%';
            //         }, 650); // 等待动画完成
            //     }
            // };

            // 开始显示第一行
            setTimeout(() => {
                showNextLine();
            }, lineDelay);
        }

        function closeAutoEventModal() {
            const overlay = document.getElementById('auto-event-overlay');
            const drawer = document.getElementById('auto-event-drawer');
            const progressBar = document.getElementById('auto-event-progress-bar');
            drawer.style.transform = 'translateY(200%)';
            overlay.style.opacity = '0';
            setTimeout(() => {
                overlay.style.zIndex = '-100';
                progressBar.style.width = '0%';
            }, 650); // 等待动画完成
        }

        // --- Mimi's Logic Update (Newest first, today prioritized) ---
        function callMimi() {
            if (isNight) return;
            if (state.day === 11) return; // Day 11 disabled
            if (state.hour >= 20) { alert("米米已经下班了（营业时间截止20:00）"); return; }
            if (!confirm("呼叫米米将消耗 2 小时，确定吗？")) return;

            addTime(2);
            let foundCardId = null;
            let foundEvent = null;

            // 1. Search TODAY's missed events first
            const todayEvents = dayConfig[state.day].events;
            for (let evt of todayEvents) {
                if (!state.collectedCards.includes(evt.id)) {
                    // Check if time passed
                    if (evt.time && state.hour > evt.time[1]) {
                        foundCardId = evt.id;
                        foundEvent = evt;
                        break;
                    }
                }
            }

            // 2. If nothing today, search backwards from Yesterday down to Day 1
            if (!foundCardId) {
                for (let d = state.day - 1; d >= 1; d--) {
                    const pastEvents = dayConfig[d].events;
                    for (let evt of pastEvents) {
                        if (!state.collectedCards.includes(evt.id)) {
                            foundCardId = evt.id;
                            foundEvent = evt;
                            break;
                        }
                    }
                    if (foundCardId) break;
                }
            }

            if (foundCardId) {
                state.collectedCards.push(foundCardId);
                state.notifications.event = true;
                updateStatusText(`>>> 米米: "我这有个你之前错过的猛料..."`);
                showToast("米米发来了一条关键情报！");
                parseTextForArchive(eventCards[foundCardId].text);
                // 添加到 deducedEvents
                state.deducedEvents.push({ ...foundEvent, ...eventCards[foundCardId] });
            } else {
                updateStatusText(`>>> 米米: "嘿，你没错过什么大事。"`);
            }
            save(); updateUI(); renderCollectedEvents();
        }

        function openHotlineModal() {
            const gathered = dayConfig[state.day].hotlines.filter(h => state.collectedCards.includes(h.id));
            let html = "";
            if (gathered.length === 0) html = "<div style='text-align:center; color:#666;'>暂无热线记录</div>";
            else {
                gathered.forEach(h => {
                    let hour = Math.floor(h.time); let min = Math.round((h.time - hour) * 60);
                    html += `<div style="margin-bottom:12px; border-bottom:1px dashed #333; padding-bottom:8px; line-height:1.5;">
                    <span style="color:var(--term-main); font-weight:bold; margin-right:8px;">[${hour < 10 ? '0' + hour : hour}:${min < 10 ? '0' + min : min}]</span>
                    <span style="color:#ddd;">${parseTextForArchive(h.text)}</span>
                </div>`;
                });
            }
            document.getElementById('hotline-content').innerHTML = html; openModal('hotline-modal');
        }

        function parseTextForArchive(text) {
            if (!text) return "";
            let newText = text; const allKeys = [...Object.keys(archiveDB.loc), ...Object.keys(archiveDB.char)];
            allKeys.sort((a, b) => b.length - a.length);
            let replacements = {}; let pIndex = 0;
            allKeys.forEach(key => {
                let type = archiveDB.loc[key] ? 'loc' : 'char';
                const isUnlocked = state.archives[type].includes(key);
                if (!isUnlocked) {
                    const idx = newText.indexOf(key);
                    if (idx !== -1) {
                        let placeholder = `___ARCHIVE_${pIndex}___`;
                        replacements[placeholder] = `<span class="highlight" onclick="unlockArchiveFromText('${key}', this)">${key}</span>`;
                        newText = newText.replace(key, placeholder); pIndex++;
                    }
                }
            });
            newText = newText.replace(/\n/g, "<br>");
            for (let ph in replacements) { newText = newText.replace(ph, replacements[ph]); }
            return newText;
        }

        function unlockArchiveFromText(key, element) {
            let type = ''; if (archiveDB.loc[key]) type = 'loc'; else if (archiveDB.char[key]) type = 'char';
            if (type) {
                if (!state.archives[type].includes(key)) { unlockArchive(type, key); showToast(`档案解锁：${key}`); }
                if (element) { element.classList.remove('highlight'); element.onclick = null; element.style.color = 'inherit'; element.style.fontWeight = 'normal'; element.style.cursor = 'default'; }
            }
        }
        function unlockArchive(type, key) {
            if (!state.archives[type].includes(key)) {
                state.archives[type].push(key);
                // 记录解锁时的天数
                if (!state.archiveUnlockDays) state.archiveUnlockDays = { loc: {}, char: {} };
                if (!state.archiveUnlockDays[type]) state.archiveUnlockDays[type] = {};
                state.archiveUnlockDays[type][key] = state.day;
                state.notifications.archive = true;
                updateUI();
                save();
            }
        }
        function renderArchive(type) {
            document.querySelectorAll('.archive-tab').forEach(el => el.classList.remove('active'));
            document.querySelector(`.archive-tab[onclick="renderArchive('${type}')"]`).classList.add('active');
            const list = document.getElementById('archive-list'); list.innerHTML = '';
            if (state.archives[type].length === 0) { list.innerHTML = '<div style="color:#666; width:100%; text-align:center;">暂无数据</div>'; return; }

            let newReads = [];
            state.archives[type].forEach(key => {
                const desc = archiveDB[type][key];
                const div = document.createElement('div'); div.className = 'archive-item';

                const isNew = !state.readArchiveKeys.includes(key);
                if (isNew) {
                    newReads.push(key);
                    div.innerHTML = `<h4 style="font-weight:900; color:#fff; text-shadow:0 0 5px var(--term-blue);">${key} <span style="font-size:0.7em; color:var(--term-alert); border:1px solid var(--term-alert); padding:0 2px; margin-left:5px;">NEW</span></h4><p style="font-weight:bold; color:#eee;">${desc}</p>`;
                } else {
                    div.innerHTML = `<h4>${key}</h4><p>${desc}</p>`;
                }
                list.appendChild(div);
            });

            if (newReads.length > 0) {
                state.readArchiveKeys = [...state.readArchiveKeys, ...newReads];
                save();
            }
        }

        // --- Review System Logic ---
        let currentReviewId = null;
        let currentReviewAnswers = [];

        function openEventSystem() {
            state.notifications.event = false; updateUI(); save(); renderReviewList();
            if (!currentReviewId) {
                document.getElementById('quiz-area').innerHTML = `
                <div style="color:#666; text-align:center; margin-top:100px;">
                    &lt; 请在左侧选择一个复盘任务 &gt;<br><br>
                    <small>注意：只有收集齐相关线索后，复盘任务才会开启。</small>
                </div>`;
            }
            openModal('event-sys-modal');
        }

        function checkRequirements(req) {
            return req.every(item => {
                if (Array.isArray(item)) return item.some(sub => state.collectedCards.includes(sub));
                return state.collectedCards.includes(item);
            });
        }

        function renderReviewList() {
            const container = document.getElementById('es-list-container'); container.innerHTML = '';
            const days = Object.keys(reviewDB).map(Number).filter(d => d <= state.day).sort((a, b) => b - a);
            let newReads = [];

            days.forEach(dayNum => {
                const groupDiv = document.createElement('div'); groupDiv.className = 'es-day-group';
                groupDiv.innerHTML = `<div class="es-day-title">DAY ${dayNum} 任务</div>`;
                const reviews = reviewDB[dayNum];
                reviews.forEach(rev => {
                    // Count Collected
                    let reqList = rev.req;
                    let totalReq = reqList.length;
                    let currentCount = 0;
                    reqList.forEach(r => {
                        if (Array.isArray(r)) {
                            if (r.some(sub => state.collectedCards.includes(sub))) currentCount++;
                        } else {
                            if (state.collectedCards.includes(r)) currentCount++;
                        }
                    });

                    const isLocked = !checkRequirements(rev.req);
                    const isCompleted = state.completedReviews.includes(rev.id);
                    const div = document.createElement('div');
                    div.className = `es-card ${isLocked ? 'locked' : ''} ${isCompleted ? 'completed' : ''}`;
                    if (currentReviewId === rev.id) div.classList.add('selected');

                    let statusIcon = isCompleted ? "✔ " : (isLocked ? "🔒 " : "📝 ");
                    let counterHtml = isCompleted ? "" : `<span style="float:right; font-size:0.8em; opacity:0.7">(${currentCount}/${totalReq})</span>`;

                    let isTitleLocked = !(totalReq != 1 && currentCount > 0);
                    if (currentCount === totalReq) {
                        isTitleLocked = false;
                    }

                    // 修改：如果未解锁，显示问号；如果解锁了，显示真标题
                    let displayTitle = isTitleLocked ? "??????" : rev.title;

                    // New Logic: Check if unlocked and not read
                    if (!isLocked) {
                        if (!state.readReviews.includes(rev.id)) {
                            newReads.push(rev.id);
                            displayTitle = `<span style="color:#fff; font-weight:900; text-shadow:0 0 5px var(--term-main);">${displayTitle} <span style="font-size:0.7em; color:var(--term-main); border:1px solid var(--term-main); padding:0 2px;">NEW</span></span>`;
                        }
                    }

                    div.innerHTML = `<div class="es-card-title">${statusIcon}${displayTitle}${counterHtml}</div>`;
                    if (!isLocked) { div.onclick = () => loadReview(rev); }
                    groupDiv.appendChild(div);
                });
                container.appendChild(groupDiv);
            });

            if (newReads.length > 0) {
                state.readReviews = [...state.readReviews, ...newReads];
                save();
            }
        }

        function loadReview(rev) {
            if (state.completedReviews.includes(rev.id)) {
                currentReviewId = null; renderReviewList();
                document.getElementById('quiz-area').innerHTML = `<div class="quiz-header">${rev.title} [完成]</div><div style="color:var(--term-blue); font-size:1.1em; text-align:center; margin-top:50px;">此事件已复盘完毕。<br>新闻稿已归档。</div>`;
                return;
            }
            currentReviewId = rev.id; currentReviewAnswers = rev.questions.map(() => rev.type === 'tf' ? '' : 0);
            renderReviewList();

            // Fixed Layout for Quiz
            const quizArea = document.getElementById('quiz-area');
            let html = `<div class="quiz-header">${rev.title}</div>`;
            html += `<p class="quiz-intro">${rev.intro}</p>`;
            html += `<div class="quiz-list">`;
            rev.questions.forEach((q, idx) => {
                html += `<div class="quiz-item">`;
                if (rev.type === 'tf') { html += `<div id="qbtn-${idx}" class="btn-quiz-toggle" onclick="toggleAnswer(${idx}, 'tf')"> </div>`; }
                else { html += `<div id="qbtn-${idx}" class="btn-quiz-toggle" onclick="toggleAnswer(${idx}, 'order')">-</div>`; }
                html += `<div class="quiz-text">${q.t}</div></div>`;
            });
            html += `</div>`;
            html += `<div class="quiz-footer"><div id="verify-msg"></div><button class="btn-verify" onclick="verifyAnswers()">验证推论</button></div>`;
            quizArea.innerHTML = html;
        }

        function toggleAnswer(idx, type) {
            const btn = document.getElementById(`qbtn-${idx}`);
            if (type === 'tf') {
                let curr = currentReviewAnswers[idx];
                if (curr === '') { currentReviewAnswers[idx] = 'v'; btn.innerText = '✔'; btn.className = 'btn-quiz-toggle checked'; }
                else if (curr === 'v') { currentReviewAnswers[idx] = 'x'; btn.innerText = '✘'; btn.className = 'btn-quiz-toggle wrong'; }
                else { currentReviewAnswers[idx] = ''; btn.innerText = ''; btn.className = 'btn-quiz-toggle'; }
            } else if (type === 'order') {
                let val = currentReviewAnswers[idx]; val = val + 1; if (val > 3) val = 0;
                currentReviewAnswers[idx] = val;
                btn.innerText = val === 0 ? '-' : val; btn.className = val === 0 ? 'btn-quiz-toggle' : 'btn-quiz-toggle checked';
            }
        }

        function verifyAnswers() {
            let revData = null;
            for (let d in reviewDB) { let found = reviewDB[d].find(r => r.id === currentReviewId); if (found) { revData = found; break; } }
            if (!revData) return;
            let isCorrect = true;
            revData.questions.forEach((q, idx) => { if (currentReviewAnswers[idx] !== q.a) isCorrect = false; });
            const msgBox = document.getElementById('verify-msg');
            if (isCorrect) {
                msgBox.style.color = 'var(--term-main)'; msgBox.innerText = ">>> 推论正确！新闻已生成。";
                state.completedReviews.push(currentReviewId);
                if (!state.deducedNews.includes(revData.targetNews)) {
                    state.deducedNews.push(revData.targetNews);
                    save(); renderCollectedNews(); renderCollectedEvents(); updateUI(); setTimeout(() => { openEventSystem(); }, 1000);
                }
            } else {
                msgBox.style.color = 'var(--term-alert)'; msgBox.innerText = ">>> 推论逻辑错误，请重新核实。";
                const btn = document.querySelector('.btn-verify');
                btn.classList.add('shake-btn');
                setTimeout(() => btn.classList.remove('shake-btn'), 500);
            }
        }

        function renderCollectedNews() {
            const container = document.getElementById('collected-news-container');
            container.innerHTML = '';

            // 过滤：只显示属于“今天”的新闻
            const todayNews = state.deducedNews.filter(nid => {
                const recipe = recipes.find(r => r.news.id === nid);
                return recipe && (recipe.day === undefined || recipe.day === state.day);
            });

            if (todayNews.length === 0) {
                container.innerHTML = '<div style="color:#666; text-align:center;">暂无今日可播报新闻</div>';
                return;
            }

            todayNews.forEach(nid => {
                const recipe = recipes.find(r => r.news.id === nid);
                const n = recipe.news;
                const div = document.createElement('div');
                div.className = 'collected-news-card';
                div.onclick = () => showNewsDetail(n);
                div.innerHTML = `<div class="news-card-title">${n.title}</div><span class="news-card-tag ${n.type === 'big' ? 'tag-big' : ''}">${n.type === 'big' ? '大新闻' : (n.type === 'grey' ? '轶闻' : 'NEWS')}</span>`;
                container.appendChild(div);
            });
        }

        function renderCollectedEvents() {
            const container = document.getElementById('collected-events-container');
            container.innerHTML = '';

            // 过滤：只显示属于“今天”的事件
            const todayEvents = state.deducedEvents.filter(evt => {
                return evt && (evt.day === undefined || evt.day === state.day);
            });

            if (todayEvents.length === 0) {
                container.innerHTML = '<div style="color:#666; text-align:center;">暂无事件</div>';
                return;
            }

            todayEvents.forEach(evt => {
                const div = document.createElement('div');
                div.className = 'collected-event-card';
                div.onclick = () => showEventDetail(evt);
                const displayTitle = evt.title.split(' ').slice(1).join(' '); // Remove D1-A prefix
                div.innerHTML = `<div class="event-card-title"><i class="fas fa-puzzle-piece" style="-webkit-text-stroke: 1px var(--term-main); color: transparent;"></i> ${displayTitle}</div>`;
                container.appendChild(div);
            });
        }

        function showNewsDetail(news) {
            const content = document.getElementById('news-detail-content');
            let typeStr = news.type === 'big' ? '大新闻' : '普通新闻';
            content.innerHTML = `<h2 style="color:var(--term-main); margin-top:0;">${news.title}</h2><div style="color:var(--term-gold); margin-bottom:20px; font-weight:bold;">[${typeStr}]</div><div>${news.text.replace(/\n/g, '<br>')}</div>`;
            openModal('news-detail-modal');
        }

        function showEventDetail(event) {
            const content = document.getElementById('event-detail-content');
            const displayTitle = event.title.replace(/^[D]\d+-[A-Z] /, '');
            content.innerHTML = `<h2 style="color:var(--term-main); margin-top:0;">${displayTitle}</h2><div>${event.text.replace(/\n/g, '<br>')}</div>`;
            openModal('event-detail-modal');
        }

        function getTodayNewsCount() {
            const todayNewsCount = state.deducedNews.filter(nid => {
                const r = recipes.find(rec => rec.news.id === nid);
                return r && (r.day === undefined || r.day === state.day);
            }).length;
            return todayNewsCount;
        }

        function triggerNight() {
            if (state.day === 11) {
                // Day 11 Check (Final)
                if (!state.deducedNews.includes('n11_final')) {
                    alert("你需要集齐所有线索，并在【事件复盘】中推导出最终真相，才能开始最后的广播！");
                    return;
                }
            } else {
                // Check based on filtered news for TODAY
                const todayNewsCount = getTodayNewsCount();

                if (todayNewsCount < 3) {
                    alert(`你只准备了 ${todayNewsCount} 条今日新闻！\n老哈里要求至少准备 3 条新闻。`);
                    return;
                }
            }

            isNight = true; isBroadcasting = false; state.hour = 22; state.minute = 0;
            document.getElementById('transition-overlay').style.display = 'flex';
            typeWriter("transition-text", "正在接入夜间广播信号...", 50, () => {
                document.getElementById('transition-overlay').style.display = 'none'; document.getElementById('broadcast-screen').style.display = 'block'; initBroadcastUI();
            });
        }

        function initBroadcastUI() {
            const pool = document.getElementById('broadcast-pool');
            pool.innerHTML = '';

            // Initialize audio visualizer bars
            const visualizer = document.getElementById('audio-visualizer');
            if (visualizer.children.length === 0) { // Only create bars once
                for (let i = 0; i < 50; i++) {
                    const bar = document.createElement('div');
                    bar.className = 'bar';
                    visualizer.appendChild(bar);
                }
            }

            // 同样只允许选择“今天”的新闻
            state.deducedNews.forEach(nid => {
                const recipe = recipes.find(r => r.news.id === nid);
                if (recipe && (recipe.day === undefined || recipe.day === state.day)) {
                    createChip(pool, recipe.news, true);
                }
            });

            // Filler news except Day 11
            if (state.day !== 11) {
                const shuffled = fillerNewsDB.sort(() => 0.5 - Math.random());
                shuffled.slice(0, 2).forEach(f => { createChip(pool, { title: f.title, text: f.text, type: 'grey' }, false); });
            }
        }

        function createChip(container, item, isReal) {
            const chip = document.createElement('div'); chip.className = `b-chip ${isReal ? 'real' : ''} ${item.type === 'big' ? 'big' : ''}`;
            chip.innerText = item.title; chip.onclick = () => addToSlot(item); container.appendChild(chip);
        }
        function addToSlot(newsItem) {
            if (isBroadcasting) return;
            if (broadcastSlots.some(slot => slot && slot.title === newsItem.title)) { alert("该新闻已在播放列表中！"); return; }
            const idx = broadcastSlots.indexOf(null);
            if (idx !== -1) { broadcastSlots[idx] = newsItem; renderBSlots(); } else { alert("播放列表已满 (4条)。"); }
        }
        function clearSlot(idx) {
            if (isBroadcasting) return;
            broadcastSlots[idx] = null; renderBSlots();
        }
        function renderBSlots() {
            broadcastSlots.forEach((item, i) => {
                const el = document.getElementById(`bslot-${i}`);
                if (item) {
                    el.innerText = item.title;
                    el.className = `b-slot filled`;
                    el.onclick = () => clearSlot(i);
                } else { el.innerText = "[ 空 ]"; el.className = "b-slot"; el.onclick = () => clearSlot(i); }
            });
        }

        function enableBroadcastUI() {
            // Re-enable news chips
            initBroadcastUI(); // This re-creates and attaches onclick for chips
            // Re-enable playlist slots
            renderBSlots(); // This re-attaches onclick for slots

            // Re-enable start broadcast button
            const startButton = document.getElementById('btn-start-broadcast');
            startButton.onclick = startBroadcast;
            startButton.classList.remove('disabled-broadcast-ui');
        }

        function startBroadcast() {
            if (isBroadcasting) return;
            const filledSlots = broadcastSlots.filter(s => s !== null);

            // 满足四个时段且不是第11天
            const minSlots = document.querySelectorAll('.b-slot.filled').length < 4;
            const skipDaysBroadcast = state.day !== 11;
            if (minSlots && skipDaysBroadcast) {
                alert(`请填满所有时段，否则信号将中断！`);
                return;
            }

            // Hide previous results if restarting
            document.getElementById('result-panel').style.display = 'none';

            isBroadcasting = true;

            // Show Tally Light and Audio Visualizer
            document.getElementById('tally-light').style.display = 'block';
            startVisualizerAnimation();

            // Disable UI elements
            document.querySelectorAll('#broadcast-pool .b-chip').forEach(chip => {
                chip.onclick = null;
                chip.classList.add('disabled-broadcast-ui');
            });
            document.querySelectorAll('.broadcast-slot-row .b-slot').forEach(slot => {
                slot.onclick = null;
                slot.classList.add('disabled-broadcast-ui');
            });
            const startButton = document.getElementById('btn-start-broadcast');
            startButton.onclick = null;
            startButton.classList.add('disabled-broadcast-ui');

            let script = "晚上好，弧光镇。\n";
            filledSlots.forEach((item, i) => { script += `\n[${i + 1}] ${item.text}`; });

            if (state.day === 11) {
                script += "\n\n……";
            } else {
                script += "\n\n祝各位晚安，愿好梦与你同在。";
            }

            typeWriter("teleprompter", script, 60, finishBroadcastState);
        }

        function calculateRating() {
            const possibleReviews = reviewDB[state.day] || [];
            if (possibleReviews.length === 0) return 0;

            const totalPossible = possibleReviews.length;
            let truthBroadcasted = 0;

            // Get IDs of news that are considered "Truth" (from reviewDB)
            const truthNewsIds = possibleReviews.map(r => r.targetNews);

            broadcastSlots.forEach(slot => {
                if (slot && slot.id && truthNewsIds.includes(slot.id)) {
                    truthBroadcasted++;
                }
            });

            let ratio = 0;
            if (totalPossible > 0) {
                ratio = truthBroadcasted / totalPossible;
            }

            let percentage = Math.round(ratio * 100);

            // Add a little randomness
            if (percentage > 0) {
                percentage += Math.floor(Math.random() * 10) - 5;
                if (percentage > 100) percentage = 100;
                if (percentage < 0) percentage = 0;
            }

            return percentage;
        }

        function runRatingSequence() {
            const modal = document.getElementById('rating-modal');
            const scoreEl = document.getElementById('rating-big-num');
            const percentEl = document.getElementById('rating-percent');
            const stampEl = document.getElementById('rating-stamp');
            const phoneAlert = document.getElementById('danger-phone');

            // Function to get evaluation text based on score
            function getEvaluationText(score) {
                if (score >= 80) return "EXCELLENT";
                if (score >= 60) return "GOOD";
                if (score >= 40) return "UGH";
                return "POOR";
            }

            // Reset UI
            modal.style.display = 'flex';
            scoreEl.innerText = "0";
            percentEl.innerText = "0%";
            stampEl.className = "stamp";
            stampEl.innerText = "";
            phoneAlert.style.display = 'none'; // Reset phone

            const score = calculateRating();
            const isDanger = score >= 50;

            // 1. Roll Number
            let current = 0;
            const step = Math.ceil(score / 50) || 1;
            const interval = setInterval(() => {
                current += step;
                if (current >= score) {
                    current = score;
                    clearInterval(interval);
                    // Next Stage
                    setTimeout(() => showStamp(current), 500);
                }
                scoreEl.innerText = current;
                percentEl.innerText = current + "%";
            }, 30);

            function showStamp(finalScore) {
                stampEl.innerText = getEvaluationText(finalScore);
                // Determine stamp style based on score
                if (finalScore >= 80) {
                    stampEl.classList.add("stamp-safe");
                } else if (finalScore >= 60) {
                    stampEl.classList.add("stamp-safe");
                } else if (finalScore >= 40) {
                    stampEl.classList.add("stamp-danger");
                } else {
                    stampEl.classList.add("stamp-danger");
                }
                // Trigger reflow
                void stampEl.offsetWidth;
                stampEl.classList.add("show");

                setTimeout(() => showHarry(isDanger), 1000);
            }

            function showHarry(danger) {
                if (danger) {
                    document.getElementById('danger-phone').style.display = 'flex'; // Show phone
                }

                // Click to close
                modal.onclick = endSequence;
            }

            function endSequence() {
                modal.onclick = null;
                modal.style.display = 'none';

                // Show original result panel
                document.getElementById('result-panel').style.display = 'block';
                if (state.day === 11) {
                    document.getElementById('end-msg').innerText = ">>> 信号中断...";
                    document.getElementById('end-msg').style.marginBottom = "10px";
                    const btnContainer = document.querySelector('#end-btn-container');
                    btnContainer.innerHTML = `
                    <div style="color:#aaa; font-size:1rem; text-align:center; padding:0; line-height:1.6;">
                        <p style="margin:5px 0;">你的声音消失在电磁杂音中。但种子已经播下。</p>
                        <p style="color:var(--term-main); font-weight:900; font-size:1.3em; margin:15px 0 10px 0;">未完待续</p>
                        <p style="font-size:0.8em; margin:0; opacity:0.6;">[ 按下F5重置 ]</p>
                    </div>`;
                }
                // Allow re-broadcasting if needed
                isBroadcasting = false;
                enableBroadcastUI();
            }
        }

        // Function to start the visualizer animation
        function startVisualizerAnimation() {
            const visualizer = document.getElementById('audio-visualizer');
            visualizer.style.display = 'flex'; // Show visualizer

            const bars = visualizer.children;
            clearInterval(visualizerInterval); // Clear any existing interval

            visualizerInterval = setInterval(() => {
                for (let i = 0; i < bars.length; i++) {
                    const bar = bars[i];
                    if (isTeleprompterTyping) {
                        // Active (typing) animation
                        bar.style.height = `${5 + Math.random() * 25}px`; // Random height between 5px and 30px
                        bar.style.opacity = `${0.7 + Math.random() * 0.3}`; // Random opacity for flicker
                        bar.style.animation = 'none'; // Disable CSS animation when JS is controlling
                    } else {
                        // Idle (static/noise) animation
                        bar.style.height = `${5 + Math.random() * 5}px`; // Smaller random height for idle
                        bar.style.opacity = `${0.3 + Math.random() * 0.2}`; // Lower opacity for noise
                        bar.style.animation = 'none'; // Disable CSS animation when JS is controlling
                    }
                }
            }, 100); // Update every 100ms
        }

        // Function to stop the visualizer animation
        function stopVisualizerAnimation() {
            clearInterval(visualizerInterval);
            const visualizer = document.getElementById('audio-visualizer');
            visualizer.style.display = 'none'; // Hide visualizer

            const bars = visualizer.children;
            for (let i = 0; i < bars.length; i++) {
                const bar = bars[i];
                bar.style.height = '5px'; // Reset height
                bar.style.opacity = '0.3'; // Reset opacity
                bar.style.animation = 'none'; // Ensure animation is off
            }
        }

        async function finishBroadcastState() {
            await new Promise(resolve => setTimeout(resolve, 1000));

            save();

            // Hide Tally Light and Audio Visualizer
            document.getElementById('tally-light').style.display = 'none';
            stopVisualizerAnimation();
            // Don't show result panel immediately
            // document.getElementById('result-panel').style.display = 'block';

            // Trigger Rating Sequence
            // Day 11 bypasses rating because it crashes
            if (state.day === 11) {
                document.getElementById('result-panel').style.display = 'block';
                document.getElementById('end-msg').innerText = ">>> 信号中断...";
                document.getElementById('end-msg').style.marginBottom = "10px";
                const btnContainer = document.querySelector('#end-btn-container');
                btnContainer.innerHTML = `
                 <div style="color:#aaa; font-size:1rem; text-align:center; padding:0; line-height:1.6;">
                     <p style="margin:5px 0;">你的声音消失在电磁杂音中。但种子已经播下。</p>
                     <p style="color:var(--term-main); font-weight:900; font-size:1.3em; margin:15px 0 10px 0;">未完待续</p>
                     <p style="font-size:0.8em; margin:0; opacity:0.6;">[ 按下F5重置 ]</p>
                 </div>`;
                // Allow re-broadcasting if needed
                isBroadcasting = false;
            } else {
                runRatingSequence();
            }
        }

        function showToast(msg) {
            const d = document.createElement('div');
            d.style.cssText = "position:fixed; top:10%; left:50%; transform:translateX(-50%); background:var(--term-main); color:#000; padding:15px 30px; font-weight:bold; z-index:9000; box-shadow:0 0 20px var(--term-main); font-size: 1.2em; border: 2px solid #fff;";
            d.innerText = msg; document.body.appendChild(d); setTimeout(() => d.remove(), 2000);
        }

        function typeWriter(id, text, speed, callback) {
            let i = 0; const el = document.getElementById(id); el.innerHTML = "";
            isTeleprompterTyping = true; // Set to true when typing starts

            // Skip function
            if (window.typeWriterTimer) clearTimeout(window.typeWriterTimer);

            window.fastForwardType = function () {
                if (i < text.length) {
                    if (window.typeWriterTimer) clearTimeout(window.typeWriterTimer);
                    el.innerHTML = text;
                    i = text.length;
                    isTeleprompterTyping = false; // Set to false if fast-forwarded
                    if (callback) callback();
                }
            };

            function type() {
                if (i < text.length) {
                    el.innerHTML += text.charAt(i); i++;
                    el.scrollTop = el.scrollHeight;
                    window.typeWriterTimer = setTimeout(type, speed);
                } else {
                    isTeleprompterTyping = false; // Set to false when typing finishes
                    if (callback) callback();
                }
            }
            type();
        }

        function openModal(id) { document.getElementById(id).style.display = 'flex'; if (id === 'info-modal') document.getElementById('info-content').innerHTML = parseTextForArchive(dayConfig[state.day].paper); }
        function closeModal(id) { document.getElementById(id).style.display = 'none'; }
        function closeIntro1() { closeModal('intro-modal'); setTimeout(() => { openModal('tutorial-modal'); }, 300); }
        function openArchiveModal() { state.notifications.archive = false; updateUI(); save(); document.getElementById('archive-modal').style.display = 'flex'; renderArchive('loc'); }

        function restartDay(skipConfirm = false) {
            if (isTransitioning) return;
            if (!skipConfirm && !confirm("重置本日？")) return;

            isTransitioning = true;

            // 关闭所有可能打开的弹窗
            const modals = ['hotline-popup-modal', 'auto-event-modal', 'news-detail-modal',
                'event-detail-modal', 'info-modal', 'hotline-modal', 'intro-modal',
                'tutorial-modal', 'archive-modal', 'rating-modal', 'broadcast-screen',
                'transition-overlay'];
            modals.forEach(modalId => {
                const modal = document.getElementById(modalId);
                if (modal) modal.style.display = 'none';
            });

            state.hour = 8; state.minute = 0;

            state.collectedCards = state.collectedCards.filter(id => {
                const card = eventCards[id];
                if (!card) return false;
                return card.day < state.day;
            });

            state.completedReviews = state.completedReviews.filter(revId => {
                let isToday = false;
                const todaysReviews = reviewDB[state.day];
                if (todaysReviews) { isToday = todaysReviews.some(r => r.id === revId); }
                return !isToday;
            });

            state.deducedNews = state.deducedNews.filter(newsId => {
                const recipe = recipes.find(r => r.news.id === newsId);
                if (!recipe) return false;
                return recipe.inputs.every(cardId => state.collectedCards.includes(cardId));
            });

            state.deducedEvents = state.deducedEvents.filter(evt => {
                const event = eventCards[evt.id];
                if (!event) return false;
                return event.day < state.day;
            });

            // 清除当前天解锁的档案
            if (state.archiveUnlockDays) {
                ['loc', 'char'].forEach(type => {
                    if (state.archiveUnlockDays[type]) {
                        state.archives[type] = state.archives[type].filter(key => {
                            const unlockDay = state.archiveUnlockDays[type][key];
                            // 如果解锁天数为0（初始解锁）或小于当前天数，保留；如果等于当前天数，清除
                            return !unlockDay || unlockDay === 0 || unlockDay < state.day;
                        });
                        // 同时清除解锁天数记录
                        Object.keys(state.archiveUnlockDays[type]).forEach(key => {
                            if (state.archiveUnlockDays[type][key] === state.day) {
                                delete state.archiveUnlockDays[type][key];
                            }
                        });
                    }
                });
            }

            // 回到初始地点
            state.location = '夜间广播站';

            broadcastSlots = [null, null, null, null];
            isNight = false;
            isBroadcasting = false;
            save();
            location.reload();
        }

        function prevDay() {
            if (isTransitioning) return;
            if (state.day <= 1) { alert("已经是第一天了。"); return; } if (!confirm("回到前一天？")) return;

            isTransitioning = true;

            state.day -= 1;
            state.hour = 8;
            state.minute = 0;
            state.deducedNews = [];
            state.deducedEvents = [];
            state.completedReviews = [];
            state.location = '夜间广播站';
            state.collectedCards = state.collectedCards.filter(id => { const card = eventCards[id]; return card && card.day < state.day; });
            broadcastSlots = [null, null, null, null];
            isNight = false;
            isBroadcasting = false;
            save();
            location.reload();
        }
        function nextDay() {
            if (isTransitioning) return;
            if (!dayConfig[state.day + 1]) {
                alert("目前版本仅包含前11天内容。感谢游玩！");
                return;
            }

            isTransitioning = true;

            state.day += 1;
            state.hour = 8;
            state.minute = 0;
            state.deducedNews = [];
            state.deducedEvents = [];
            state.location = '夜间广播站';
            broadcastSlots = [null, null, null, null];
            isNight = false;
            isBroadcasting = false;
            save();
            location.reload();
        }
        function clearSave() { if (confirm("确定要删除所有存档进度并重新开始吗？")) { localStorage.removeItem('ArcLight_v1226_Conspiracy'); location.reload(); } }

        // 快脚模式开关
        function toggleFastWalk() {
            const toggle = document.getElementById('fast-walk-toggle');
            toggle.classList.toggle('active');
            isFastWalkActive = !isFastWalkActive;
            localStorage.setItem('ArcLight_v1226_Conspiracy_fastWalk', isFastWalkActive ? 1 : 0);
        }
        function loadFastWalk() {
            isFastWalkActive = parseInt(localStorage.getItem('ArcLight_v1226_Conspiracy_fastWalk') || 0);
            if (isFastWalkActive) {
                document.getElementById('fast-walk-toggle').classList.add('active');
            }
        }

        // 尝试播放背景音乐（需要用户交互）
        const bgMusic = document.getElementById('background-music');
        let playMusicInterval = null;
        let pauseMusicInterval = null;
        let audioUnlocked = false; // 标记音频是否已解锁
        let pendingPlay = false; // 标记是否有待播放的音乐请求

        // 用户交互解锁音频
        function unlockAudio() {
            if (audioUnlocked) return;

            // 尝试播放并立即暂停以解锁音频
            bgMusic.play().then(() => {
                bgMusic.pause();
                bgMusic.currentTime = 0;
                audioUnlocked = true;

                // 如果有待播放的请求，现在播放
                if (pendingPlay && isMusicActive) {
                    pendingPlay = false;
                    playMusic();
                }
            }).catch(err => {
                console.log('音频解锁失败:', err);
            });
        }

        // 监听用户交互事件来解锁音频
        const unlockEvents = ['click', 'touchstart', 'keydown'];
        unlockEvents.forEach(eventType => {
            document.addEventListener(eventType, unlockAudio, { once: true, passive: true });
        });

        function playMusic() {
            // 如果音频未解锁，标记为待播放
            if (!audioUnlocked) {
                pendingPlay = true;
                console.log('等待用户交互以播放音频...');
                return;
            }

            // 清除暂停音乐的定时器
            if (pauseMusicInterval) {
                clearInterval(pauseMusicInterval);
            }
            // 清除播放音乐的定时器
            if (playMusicInterval) {
                clearInterval(playMusicInterval);
            }
            // 播放音乐
            bgMusic.play().then(() => {
                // 播放音乐时，音量逐渐增加到0.8
                bgMusic.volume = 0;
                const volumeStep = 0.05;
                playMusicInterval = setInterval(() => {
                    bgMusic.volume += volumeStep;
                    if (bgMusic.volume >= 0.85) {
                        clearInterval(playMusicInterval);
                    }
                }, 100);
            }).catch(err => {
                console.log('音频播放失败:', err);
                // 如果播放失败，可能是音频未解锁，标记为待播放
                if (err.name === 'NotAllowedError') {
                    audioUnlocked = false;
                    pendingPlay = true;
                }
            });
        }
        function pauseMusic() {
            // 清除播放音乐的定时器
            if (playMusicInterval) {
                clearInterval(playMusicInterval);
            }
            // 清除暂停音乐的定时器
            if (pauseMusicInterval) {
                clearInterval(pauseMusicInterval);
            }
            // 如果在播放音乐，音量逐渐减小到0
            const volumeStep = 0.12;
            pauseMusicInterval = setInterval(() => {
                const bgMusicVolume = bgMusic.volume - volumeStep;
                if (bgMusicVolume <= 0) {
                    bgMusic.pause();
                    bgMusic.volume = 0;
                    bgMusic.currentTime = 0;
                    clearInterval(pauseMusicInterval);
                    return;
                }
                bgMusic.volume = bgMusicVolume;
            }, 100);
        }

        // 音乐模式开关
        function toggleMusic() {
            const toggle = document.getElementById('music-toggle');
            toggle.classList.toggle('active');
            isMusicActive = !isMusicActive;
            localStorage.setItem('ArcLight_v1226_Conspiracy_music', isMusicActive ? 1 : 0);
            // 用户点击按钮时解锁音频
            if (!audioUnlocked) {
                unlockAudio();
            }
            if (isMusicActive) {
                playMusic();
            } else {
                pauseMusic();
            }
        }
        function loadMusic() {
            isMusicActive = parseInt(localStorage.getItem('ArcLight_v1226_Conspiracy_music') || 0);
            if (isMusicActive) {
                document.getElementById('music-toggle').classList.add('active');
                // 标记为待播放，等待用户交互后自动播放
                pendingPlay = true;
            } else {
                pauseMusic();
            }
        }


        const notepad = document.getElementById('notepad-area');
        notepad.addEventListener('input', (e) => localStorage.setItem('ArcLight_v1226_Conspiracy_notepad', e.target.value));
        function loadNotepad() {
            const notepadData = localStorage.getItem('ArcLight_v1226_Conspiracy_notepad') || '';
            if (notepadData) {
                notepad.value = notepadData;
            } else {
                notepad.value = `> 备忘录（可复制、粘贴及删改）
- 8:00 阅读晨报，22:00 自动开启夜间广播模式
- 随时留意居民热线
- 寻找线索，前往现场
- 22:00 前完成至少3条新闻`;
            }
        }

        init();
    </script>
</body>

</html>
